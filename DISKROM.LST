                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.0.0, LST:Full:4
                                ;   Tablacus DISK ROM Lite for MSX
                                ;   Programmed by
                                ;   Gaku (Lovers/Tablacus)
                                ;
                                
                                    INCLUDE "DEF.ASM"
                                
                                ;   LSX-Dodgers DEF
                                ;   MSX
                                
       4000                     RUN EQU 04000H
                                
       000C                     _RDSLT  EQU 0000CH
       0014                     _WRSLT  EQU 00014H
       001C                     _CALSLT EQU 0001CH
       0024                     _ENASLT EQU 00024H
       0030                     _CALLF  EQU 00030H
                                
       009F                     CHGET   EQU 0009FH
       00A2                     CHPUT   EQU 000A2H
       0138                     RSLREG  EQU 00138H
                                
       F331                     H_BDOS  EQU 0F331H
       F37D                     BDOS    EQU 0F37DH
                                
       F348                     MASTERS EQU 0F348H
       F38C                     CLPRIM  EQU 0F38CH
       F3B0                     LINLEN  EQU 0F3B0H
       F3B9                     TXTATR  EQU 0F3B9H
       F3BB                     TXTPAT  EQU 0F3BBH
       F3D3                     MLTCOL  EQU 0F3D3H
       F3DD                     CSRX    EQU 0F3DDH
       F3F8                     PUTPNT  EQU 0F3F8H
       F3FA                     GETPNT  EQU 0F3FAH
       F3FC                     CS120   EQU 0F3FCH
                                
       F41F                     KBUF    EQU 0F41FH
                                
       F676                     TXTTAB  EQU 0F676H
       F6C2                     VARTAB  EQU 0F6C2H
       F6C4                     ARYTAB  EQU 0F6C4H
       F6C6                     STREND  EQU 0F6C6H
                                
       F7C5                     FBUFFR  EQU 0F7C5H
                                
       F864                     PTRFIL  EQU 0F864H
       F866                     RUNFLG  EQU 0F866H
       F866                     FILNAM  EQU 0F866H
       F871                     FILNM2  EQU 0F871H
                                
       FB03                     RSTMP   EQU 0FB03H
       FB21                     DRVTBL  EQU 0FB21H
       FBF0                     KEYBUF  EQU 0FBF0H
                                
       FC4A                     HIMEM   EQU 0FC4AH
       FCC1                     EXPTBL  EQU 0FCC1H
       FCBE                     RUNBNF  EQU 0FCBEH
       FCBF                     SAVENT  EQU 0FCBFH
                                
       FD99                     DEVICE  EQU 0FD99H
       FE71                     H_BINS  EQU 0FE71H
       FE76                     H_BINL  EQU 0FE76H
       FE7B                     H_FILE  EQU 0FE7BH
       FEDA                     H_STKE  EQU 0FEDAH
                                
       FF43                     H_GONE  EQU 0FF43H
                                            ;ASCII-8K
       6000                     BANK0_SEL EQU   06000H  ;6000-67FF
       6800                     BANK1_SEL EQU   06800H  ;6800-6FFF
       7000                     BANK2_SEL EQU   07000H  ;7000-77FF
       7800                     BANK3_SEL EQU   07800H  ;7800-7FFF
                                            ;ASCII-16K
                                ;BANK0_SEL EQU 06000H
                                ;BANK1_SEL EQU 07000H
                                            ;KONAMI-8K
       6000                     KONAMI_BANK1_SEL EQU    06000H  ;6000-7FFF
       8000                     KONAMI_BANK2_SEL EQU    08000H  ;8000-9FFF
       A000                     KONAMI_BANK3_SEL EQU    0A000H  ;A000-BFFF
                                
       FB03                     ISC EQU RSTMP
                                
       FF46                     _DTA    EQU H_GONE+3
                                
       F7C5                     _RESULT EQU FBUFFR
       F7C6                     RR_LOW  EQU FBUFFR+1
       F7C8                     RR_HIGH EQU FBUFFR+3
       F7CA                     _CLPS   EQU FBUFFR+5
       F7CC                     _LEFT   EQU FBUFFR+7
       F7CE                     LEFTX   EQU FBUFFR+9
       F7D0                     DTAX    EQU FBUFFR+11
       F7D2                     _DTPS   EQU FBUFFR+13
       F7D4                     _BANK   EQU FBUFFR+15
       F7D5                     _BUF    EQU FBUFFR+16
       F7D6                     _BUF_ST EQU FBUFFR+17
       F7D8                     _BUF_EN EQU FBUFFR+19
       F7DA                     _BUF_EX EQU FBUFFR+21
                                
       0001                     DISK_BANK   EQU 1       ;ドライブAが始まるバンク#
       6000                     BANK1_ADR   EQU 06000H      ;バンク1の開始アドレス
                                
       6200                     _FATBF  EQU BANK1_ADR+512       ;FATの先頭
       6E00                     _DIRBF  EQU BANK1_ADR+(1+3*2)*512   ;ディレクトリの先頭
[EOF:DEF.ASM:UTF_8]
                                
000000 4000                         ORG RUN
                                
                                ; MSX ROM header
000000 4000 4142                    DB  "AB"   ; ID for auto-executable ROM
000002 4002 0041                    DW  INIT_ROM   ; Main program execution address.
000004 4004 0000                    DW  0      ; STATEMENT
000006 4006 0000                    DW  0      ; DEVICE
000008 4008 0000                    DW  0      ; TEXT
00000A 400A 000000000000            DW  0,0,0  ; Reserved
                                
000010 4010 C38746          10      JP  DISKIO
000013 4013 C3B646          10      JP  DSKCHG
000016 4016 C30C47          10      JP  GETDPB
000019 4019 C3F447          10      JP  CHOICE
00001C 401C C3F847          10      JP  DSKFMT
00001F 401F C3FA47          10      JP  DSKSTP
                                ;   JP  BASENT
                                ;   SCF
                                ;   JP  DSKFMT
                                ;   JP  DSKSTP
                                ;   NOP
                                ;   JP  GETSLT
                                ;   LD  HL,(0F34BH)
                                ;   RET
                                
00007F 407F                         ORG 0407FH
00007F 407F C9              10      RET
                                ; Version
000080 4080 5461626C61637573        DB  "Tablacus DISK ROM Lite v0.0.0.1",0
            204449534B20524F    
            4D204C6974652076    
            302E302E302E3100    
                                
0000FF 40FF                         ORG 040FFH
0000FF 40FF C9              10      RET
                                
                                    INCLUDE "INIT.ASM"
                                
                                ;   Tablacus DISK ROM - INIT
                                ;
                                
       4100                     INIT_ROM:
000100 4100 3EFF             7      LD  A,0FFH
000102 4102 3299FD          13      LD  (DEVICE),A
                                
000105 4105 21B741          10      LD  HL,AT_ISC
000108 4108 1103FB          10      LD  DE,ISC
00010B 410B 011A00          10      LD  BC,ISC_E-ISC
00010E 410E EDB0                    LDIR
                                
000110 4110 3EC3             7      LD  A,0C3H      ;JP
000112 4112 3243FF          13      LD  (H_GONE),A
000115 4115 327DF3          13      LD  (BDOS),A
000118 4118 2103FB          10      LD  HL,ISC
00011B 411B 2244FF          16      LD  (H_GONE+1),HL
00011E 411E 2131F3          10      LD  HL,H_BDOS
000121 4121 227EF3          16      LD  (BDOS+1),HL
                                
000124 4124 3E                      DB  03EH
000125 4125 F7              12      RST 30H
000126 4126 3271FE          13      LD  (H_BINS),A
000129 4129 3276FE          13      LD  (H_BINL),A
00012C 412C 327BFE          13      LD  (H_FILE),A
00012F 412F 3231F3          13      LD  (H_BDOS),A
000132 4132 32DAFE          13      LD  (H_STKE),A
                                
000135 4135 CD9B41          17      CALL    GTSL1_
000138 4138 3216FB          13      LD  (ROM_SLT),A
00013B 413B 3272FE          13      LD  (H_BINS+1),A
00013E 413E 3277FE          13      LD  (H_BINL+1),A
000141 4141 327CFE          13      LD  (H_FILE+1),A
000144 4144 3232F3          13      LD  (H_BDOS+1),A
000147 4147 32DBFE          13      LD  (H_STKE+1),A
                                
00014A 414A 217742          10      LD  HL,ROM_LOAD
00014D 414D 2273FE          16      LD  (H_BINS+2),HL
000150 4150 21C442          10      LD  HL,ROM_BLOAD
000153 4153 2278FE          16      LD  (H_BINL+2),HL
000156 4156 211443          10      LD  HL,ROM_FILES
000159 4159 227DFE          16      LD  (H_FILE+2),HL
00015C 415C 216843          10      LD  HL,ROM_BDOS
00015F 415F 2233F3          16      LD  (H_BDOS+2),HL
000162 4162 210C42          10      LD  HL,ROM_STKE
000165 4165 22DCFE          16      LD  (H_STKE+2),HL
                                
000168 4168 3E                      DB  03EH
000169 4169 C9              10      RET
00016A 416A 327FFE          13      LD  (H_FILE+4),A
00016D 416D 3275FE          13      LD  (H_BINS+4),A
000170 4170 327AFE          13      LD  (H_BINL+4),A
000173 4173 3235F3          13      LD  (H_BDOS+4),A
000176 4176 32DEFE          13      LD  (H_STKE+4),A
                                
000179 4179 AF               4      XOR A
00017A 417A 320068          13      LD  (BANK1_SEL),A
00017D 417D 3A0060          13      LD  A,(BANK1_ADR)
000180 4180 FE41             7      CP  'A'
000182 4182 2006            12      JR  NZ,NOT_8K_BANK
000184 4184 3E01             7      LD  A,DISK_BANK
000186 4186 320068          13      LD  (BANK1_SEL),A
                                
000189 4189 C9              10      RET
       418A                     NOT_8K_BANK:
                                                ;ASCII-8K/Konami-8Kではない(ASCII-16K等)
00018A 418A 213B42          10      LD  HL,MSG_ERROR_ROM_MODE
00018D 418D CDD441          17      CALL    MSX
000190 4190 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000194 4194 DD219F00        14      LD  IX,CHGET
000198 4198 C31C00          10      JP  _CALSLT
                                
       419B                     GTSL1_:             ;自分のいるスロットを知る
00019B 419B CD3801          17      CALL    RSLREG      ;read primary slot #
00019E 419E 0F               4      RRCA
00019F 419F 0F               4      RRCA
0001A0 41A0 E603             7      AND 3       ;[A]=000000PP
0001A2 41A2 5F               4      LD  E,A     ;[E]=000000PP
0001A3 41A3 21C1FC          10      LD  HL,EXPTBL
0001A6 41A6 85               4      ADD A,L     ;桁上りは無い
0001A7 41A7 6F               4      LD  L,A     ;[HL]=EXPTBL+000000PP
0001A8 41A8 7B               4      LD  A,E     ;[A]=000000PP
0001A9 41A9 CB7E            13      BIT 7,(HL)
0001AB 41AB C8              11      RET Z
0001AC 41AC 7D               4      LD  A,L     ;point to SLTTBL entry
0001AD 41AD C604             7      ADD A,4     ;桁上りは無い
0001AF 41AF 6F               4      LD  L,A
0001B0 41B0 7E               7      LD  A,(HL)      ;get currently expansion slot register
0001B1 41B1 E60C             7      AND 00CH        ;[A] = 0000SS00
0001B3 41B3 B3               4      OR  E       ;[A] = 0000SSPP
0001B4 41B4 F680             7      OR  080H        ;[A] = 1000SSPP
0001B6 41B6 C9              10      RET
                                
       41B7                     AT_ISC:
0001B7 FB03                         ORG ISC,AT_ISC-RUN
0001B7 FB03 FEB5             7      CP  0B5H            ;LOAD
0001B9 FB05 CA71FE          10      JP  Z,H_BINS
0001BC FB08 FECF             7      CP  0CFH            ;BLOAD
0001BE FB0A CA76FE          10      JP  Z,H_BINL
0001C1 FB0D FEB7             7      CP  0B7H            ;FILES
0001C3 FB0F CA7BFE          10      JP  Z,H_FILE
0001C6 FB12 FE8A             7      CP  08AH            ;RUN
0001C8 FB14 C0              11      RET NZ
       FB15                     FIX_RUN:
0001C9 FB15 F7              12      RST 30H
       FB16                     ROM_SLT:
0001CA FB16 00                      DB  0
0001CB FB17 0143                    DW  ROM_RUN
0001CD FB19 C9              10      RET
       FB1A                     LOAD_LDIR:
0001CE FB1A C37442          10      JP  ROM_LDIR
       FB1B                     SWC_LDIR    EQU $-2
                                
       FB1D                     ISC_E:
0001D1 41D1                         ORG $$+RUN          ;$DEPHASE
                                
       41D1                     MSX1:
0001D1 41D1 CDE641          17      CALL    MSGA1
       41D4                     MSX:
0001D4 41D4 7E               7      LD  A,(HL)
0001D5 41D5 23               6      INC HL
0001D6 41D6 B7               4      OR  A
0001D7 41D7 20F8            12      JR  NZ,MSX1
0001D9 41D9 C9              10      RET
                                
       41DA                     PRTHX:
0001DA 41DA F5              11      PUSH    AF
0001DB 41DB 07               4      RLCA
0001DC 41DC 07               4      RLCA
0001DD 41DD 07               4      RLCA
0001DE 41DE 07               4      RLCA
0001DF 41DF CDE341          17      CALL    PRTA2
0001E2 41E2 F1              10      POP AF
       41E3                     PRTA2:
0001E3 41E3 CDFA41          17      CALL    ASC
       41E6                     MSG_A:
       41E6                     MSGA1:
0001E6 41E6 F5              11      PUSH    AF
0001E7 41E7 C5              11      PUSH    BC
0001E8 41E8 D5              11      PUSH    DE
0001E9 41E9 E5              11      PUSH    HL
0001EA 41EA FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
0001EE 41EE DD21A200        14      LD  IX,CHPUT
0001F2 41F2 CD1C00          17      CALL    _CALSLT
0001F5 41F5 E1              10      POP HL
0001F6 41F6 D1              10      POP DE
0001F7 41F7 C1              10      POP BC
       41F8                     MSGA2:
0001F8 41F8 F1              10      POP AF
0001F9 41F9 C9              10      RET
       41FA                     ASC:
0001FA 41FA E60F             7      AND $0F
0001FC 41FC F630             7      OR  $30
0001FE 41FE FE3A             7      CP  $3A
000200 4200 D8              11      RET C
000201 4201 C607             7      ADD A,7
000203 4203 C9              10      RET
                                
       4204                     MSN:
000204 4204 7E               7      LD  A,(HL)
000205 4205 23               6      INC HL
000206 4206 CDE641          17      CALL    MSG_A
000209 4209 10F9            13      DJNZ    MSN
00020B 420B C9              10      RET
                                
       420C                     ROM_STKE:
00020C 420C 3E                      DB  03EH
00020D 420D C9              10      RET
00020E 420E 32DAFE          13      LD  (H_STKE),A
000211 4211 E5              11      PUSH    HL
000212 4212 D5              11      PUSH    DE
000213 4213 C5              11      PUSH    BC
000214 4214 215642          10      LD  HL,AUTOEXEC
000217 4217 1166F8          10      LD  DE,FILNAM
00021A 421A 010B00          10      LD  BC,8+3
00021D 421D EDB0                    LDIR
00021F 421F CDE944          17      CALL    ROM_OPEN_0F
000222 4222 3813            12      JR  C,RSTKEE
000224 4224 216142          10      LD  HL,RUN_AUTOEXEC
000227 4227 11F0FB          10      LD  DE,KEYBUF
00022A 422A ED53FAF3        20      LD  (GETPNT),DE
00022E 422E 011300          10      LD  BC,RUN_AUTOEXEC_E-RUN_AUTOEXEC
000231 4231 EDB0                    LDIR
000233 4233 ED53F8F3        20      LD  (PUTPNT),DE
       4237                     RSTKEE:
000237 4237 C1              10      POP BC
000238 4238 D1              10      POP DE
000239 4239 E1              10      POP HL
00023A 423A C9              10      RET
                                
       423B                     MSG_ERROR_ROM_MODE:
00023B 423B 41534349492D384B        DB  "ASCII-8K/Konami-8K only!",13,10,0
            2F4B6F6E616D692D    
            384B206F6E6C7921    
            0D0A00              
                                
       4256                     AUTOEXEC:
000256 4256 4155544F45584543        DB  "AUTOEXECBAS"
            424153              
       4261                     RUN_AUTOEXEC:
000261 4261 52554E2022415554        DB  'RUN "AUTOEXEC.BAS"',00DH
            4F455845432E4241    
            53220D              
       4274                     RUN_AUTOEXEC_E:
[EOF:INIT.ASM:UTF_8]
                                    INCLUDE "FILE.ASM"
       4274                     ROM_LDIR:
000274 4274 EDB0                    LDIR
000276 4276 C9              10      RET
                                
       4277                     ROM_LOAD:
000277 4277 E5              11      PUSH    HL
000278 4278 CD6B43          17      CALL    INIT_PARAM
00027B 427B CDDD44          17      CALL    ROM_OPEN
00027E 427E 3837            12      JR  C,ERROR_FILE_NOT_FOUND
       4280                     ROM_LOAD_BAS:
000280 4280 21D5F7          10      LD  HL,_BUF
000283 4283 2246FF          16      LD  (_DTA),HL
000286 4286 210100          10      LD  HL,1            ;ヘッダを1バイト読み込む
000289 4289 CD8643          17      CALL    ROM_READ
00028C 428C 3AD5F7          13      LD  A,(_BUF)
00028F 428F 3C               4      INC A
000290 4290 2022            12      JR  NZ,ERROR_FILE_NOT_OPEN
000292 4292 2A76F6          16      LD  HL,(TXTTAB)
000295 4295 2246FF          16      LD  (_DTA),HL
000298 4298 EB               4      EX  DE,HL
000299 4299 2100FF          10      LD  HL,-256
00029C 429C 39              11      ADD HL,SP
00029D 429D ED52            15      SBC HL,DE
00029F 429F CD8643          17      CALL    ROM_READ
0002A2 42A2 ED5B46FF        20      LD  DE,(_DTA)
0002A6 42A6 19              11      ADD HL,DE
0002A7 42A7 22C2F6          16      LD  (VARTAB),HL
0002AA 42AA 22C4F6          16      LD  (ARYTAB),HL
0002AD 42AD 22C6F6          16      LD  (STREND),HL
0002B0 42B0 E1              10      POP HL
0002B1 42B1 3E8F             7      LD  A,08FH          ;REM
0002B3 42B3 C9              10      RET
                                
       42B4                     ERROR_FILE_NOT_OPEN:
0002B4 42B4 1E3B             7      LD  E,59            ;File not OPEN
0002B6 42B6 01                      DB  1           ;LD BC,
       42B7                     ERROR_FILE_NOT_FOUND:
0002B7 42B7 1E35             7      LD  E,53            ;File not found
       42B9                     ERROR:
0002B9 42B9 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
0002BD 42BD DD216F40        14      LD  IX,0406FH
0002C1 42C1 C31C00          10      JP  _CALSLT
                                
       42C4                     ROM_BLOAD:
0002C4 42C4 E5              11      PUSH    HL
0002C5 42C5 CD6B43          17      CALL    INIT_PARAM
0002C8 42C8 CDDD44          17      CALL    ROM_OPEN
0002CB 42CB 38EA            12      JR  C,ERROR_FILE_NOT_FOUND
0002CD 42CD 21D5F7          10      LD  HL,_BUF
0002D0 42D0 2246FF          16      LD  (_DTA),HL
0002D3 42D3 210800          10      LD  HL,8            ;ヘッダを8バイト読み込む
0002D6 42D6 CD8643          17      CALL    ROM_READ
0002D9 42D9 3AD5F7          13      LD  A,(_BUF)
0002DC 42DC FEFE             7      CP  0FEH
0002DE 42DE 20D4            12      JR  NZ,ERROR_FILE_NOT_OPEN
0002E0 42E0 2AD6F7          16      LD  HL,(_BUF_ST)
0002E3 42E3 2246FF          16      LD  (_DTA),HL
0002E6 42E6 EB               4      EX  DE,HL
0002E7 42E7 2AD8F7          16      LD  HL,(_BUF_EN)
0002EA 42EA A7               4      AND A
0002EB 42EB ED52            15      SBC HL,DE
0002ED 42ED CD8643          17      CALL    ROM_READ
0002F0 42F0 3ABEFC          13      LD  A,(RUNBNF)
0002F3 42F3 FE52             7      CP  'R'
0002F5 42F5 2006            12      JR  NZ,RBREAD1
0002F7 42F7 2ADAF7          16      LD  HL,(_BUF_EX)
0002FA 42FA CD7846          17      CALL    JP_HL
       42FD                     RBREAD1:
0002FD 42FD E1              10      POP HL
0002FE 42FE 3E8F             7      LD  A,08FH          ;REM
000300 4300 C9              10      RET
                                
       4301                     ROM_RUN:
000301 4301 23               6      INC HL
000302 4302 7E               7      LD  A,(HL)
000303 4303 2B               6      DEC HL
000304 4304 B7               4      OR  A
000305 4305 280A            12      JR  Z,ROM_RUN1
000307 4307 CD7742          17      CALL    ROM_LOAD
00030A 430A AF               4      XOR A
00030B 430B 21D6F7          10      LD  HL,_BUF+1
00030E 430E 77               7      LD  (HL),A
00030F 430F 2B               6      DEC HL
000310 4310 77               7      LD  (HL),A
       4311                     ROM_RUN1:
000311 4311 3E8A             7      LD  A,08AH          ;RUN
000313 4313 C9              10      RET
                                
       4314                     ROM_FILES:
000314 4314 E5              11      PUSH    HL
000315 4315 CD6B43          17      CALL    INIT_PARAM
000318 4318 CD1B44          17      CALL    FILED
00031B 431B 3A66F8          13      LD  A,(FILNAM)
00031E 431E FE21             7      CP  021H
000320 4320 3005            12      JR  NC,RFILES0
000322 4322 060B             7      LD  B,11
000324 4324 CD5E44          17      CALL    FILE10
       4327                     RFILES0:
000327 4327 21006E          10      LD  HL,_DIRBF   ;ディレクトリの先頭
00032A 432A 0E70             7      LD  C,112       ;RootEntCnt
       432C                     RFILES1:
00032C 432C 7E               7      LD  A,(HL)
00032D 432D B7               4      OR  A
00032E 432E 2834            12      JR  Z,RFILES_END
000330 4330 FEE5             7      CP  0E5H
000332 4332 282B            12      JR  Z,RFILES_NEXT
000334 4334 E5              11      PUSH    HL
000335 4335 0608             7      LD  B,8
000337 4337 CD0442          17      CALL    MSN
00033A 433A 3E2E             7      LD  A,'.'
00033C 433C CDE641          17      CALL    MSG_A
00033F 433F 0603             7      LD  B,3
000341 4341 CD0442          17      CALL    MSN
000344 4344 3ADDF3          13      LD  A,(CSRX)
000347 4347 47               4      LD  B,A
000348 4348 3AB0F3          13      LD  A,(LINLEN)
00034B 434B 90               4      SUB B
00034C 434C FE0C             7      CP  12
00034E 434E 3009            12      JR  NC,RFILES2
000350 4350 3E0D             7      LD  A,00DH      ;改行
000352 4352 CDE641          17      CALL    MSG_A
000355 4355 3E0A             7      LD  A,00AH
000357 4357 1802            12      JR  RFILES3
       4359                     RFILES2:
000359 4359 3E20             7      LD  A,020H
       435B                     RFILES3:
00035B 435B CDE641          17      CALL    MSG_A
00035E 435E E1              10      POP HL
       435F                     RFILES_NEXT:
00035F 435F CD1C45          17      CALL    FNEXT
000362 4362 20C8            12      JR  NZ,RFILES1
       4364                     RFILES_END:
000364 4364 E1              10      POP HL
000365 4365 3E8F             7      LD  A,08FH          ;REM
000367 4367 C9              10      RET
                                
       4368                     ROM_BDOS:
000368 4368 37               4      SCF
000369 4369 9F               4      SBC A,A
00036A 436A C9              10      RET
                                
       436B                     INIT_PARAM:
00036B 436B E5              11      PUSH    HL
00036C 436C 217442          10      LD  HL,ROM_LDIR
00036F 436F 221BFB          16      LD  (SWC_LDIR),HL
000372 4372 E1              10      POP HL
000373 4373 EB               4      EX  DE,HL
000374 4374 AF               4      XOR A
000375 4375 32BEFC          13      LD  (RUNBNF),A
000378 4378 3E01             7      LD  A,DISK_BANK
00037A 437A 320068          13      LD  (BANK1_SEL),A
00037D 437D 13               6      INC DE
00037E 437E CD9844          17      CALL    SPCUT
000381 4381 FE22             7      CP  '"'
000383 4383 C0              11      RET NZ
000384 4384 13               6      INC DE
000385 4385 C9              10      RET
                                
       4386                     ROM_READ:
000386 4386 E5              11      PUSH    HL
000387 4387 D5              11      PUSH    DE
000388 4388 C5              11      PUSH    BC
000389 4389 FDE5            15      PUSH    IY
00038B 438B 22CEF7          16      LD  (LEFTX),HL
00038E 438E 2A46FF          16      LD  HL,(_DTA)
000391 4391 22D0F7          16      LD  (DTAX),HL
000394 4394 2ACEF7          16      LD  HL,(LEFTX)
                                
000397 4397 CD4845          17      CALL    RBX1
00039A 439A 386F            12      JR  C,RBRERR1
00039C 439C 79               4      LD  A,C
00039D 439D EB               4      EX  DE,HL
00039E 439E ED52            15      SBC HL,DE       ;CP 0HL,CDE
0003A0 43A0 19              11      ADD HL,DE
0003A1 43A1 DE00             7      SBC A,000H
0003A3 43A3 3801            12      JR  C,RBR1
0003A5 43A5 EB               4      EX  DE,HL
       43A6                     RBR1:
0003A6 43A6 9F               4      SBC A,A
0003A7 43A7 E601             7      AND 1
0003A9 43A9 32C5F7          13      LD  (_RESULT),A
0003AC 43AC 7C               4      LD  A,H
0003AD 43AD B5               4      OR  L
0003AE 43AE CA0144          10      JP  Z,RBREND0
                                
0003B1 43B1 22CCF7          16      LD  (_LEFT),HL  ;Read record byte
0003B4 43B4 22CEF7          16      LD  (LEFTX),HL
                                
0003B7 43B7 CD7045          17      CALL    RBX2
0003BA 43BA 281A            12      JR  Z,RBRB
                                                ;先頭の端数
0003BC 43BC CD8145          17      CALL    RBXA
0003BF 43BF DA1744          10      JP  C,RBRERR
0003C2 43C2 C5              11      PUSH    BC
0003C3 43C3 CD1AFB          17      CALL    LOAD_LDIR
0003C6 43C6 ED53D0F7        20      LD  (DTAX),DE
0003CA 43CA 2ACEF7          16      LD  HL,(LEFTX)
0003CD 43CD D1              10      POP DE
0003CE 43CE A7               4      AND A
0003CF 43CF ED52            15      SBC HL,DE
0003D1 43D1 22CEF7          16      LD  (LEFTX),HL
0003D4 43D4 2828            12      JR  Z,RBREND
                                
       43D6                     RBRB:
0003D6 43D6 CDBA45          17      CALL    RBXB
0003D9 43D9 2817            12      JR  Z,RBRC
       43DB                     RBRB1:
0003DB 43DB C5              11      PUSH    BC
0003DC 43DC D5              11      PUSH    DE
0003DD 43DD CD4D46          17      CALL    CLUST
0003E0 43E0 EB               4      EX  DE,HL
0003E1 43E1 010004          10      LD  BC,1024     ;1クラスタのサイズ
0003E4 43E4 CD1AFB          17      CALL    LOAD_LDIR
0003E7 43E7 EB               4      EX  DE,HL
0003E8 43E8 D1              10      POP DE
0003E9 43E9 C1              10      POP BC
0003EA 43EA CD2A46          17      CALL    GNCL
0003ED 43ED DA1744          10      JP  C,RBRERR
0003F0 43F0 10E9            13      DJNZ    RBRB1
       43F2                     RBRC:
0003F2 43F2 CDCA45          17      CALL    RBXC
0003F5 43F5 2807            12      JR  Z,RBREND
                                
0003F7 43F7 CD4D46          17      CALL    CLUST
0003FA 43FA EB               4      EX  DE,HL
0003FB 43FB CD1AFB          17      CALL    LOAD_LDIR
       43FE                     RBREND:
0003FE 43FE CDD445          17      CALL    RBXEND
       4401                     RBREND0:
000401 4401 FDE1            14      POP IY
000403 4403 C1              10      POP BC
000404 4404 D1              10      POP DE
000405 4405 F1              10      POP AF  ;(HL)
000406 4406 AF               4      XOR A
000407 4407 3AC5F7          13      LD  A,(_RESULT)
00040A 440A C9              10      RET
                                
       440B                     RBRERR1:
00040B 440B 3E01             7      LD  A,001H
       440D                     RBRERR2:
00040D 440D FDE1            14      POP IY
00040F 440F C1              10      POP BC
000410 4410 D1              10      POP DE
000411 4411 E1              10      POP HL
000412 4412 37               4      SCF
000413 4413 210000          10      LD  HL,0
000416 4416 C9              10      RET
       4417                     RBRERR:
000417 4417 3EFF             7      LD  A,0FFH
000419 4419 18F2            12      JR  RBRERR2
                                
       441B                     FILED:
00041B 441B CD6244          17      CALL    FILEI
00041E 441E 2166F8          10      LD  HL,FILNAM
                                
000421 4421 0608             7      LD  B,8
       4423                     FILE2:
000423 4423 CD6F44          17      CALL    CCHKF
000426 4426 C8              11      RET Z
000427 4427 FE2A             7      CP  '*'
000429 4429 282E            12      JR  Z,FILE9
00042B 442B FE2E             7      CP  '.'
00042D 442D 280C            12      JR  Z,FILE4
00042F 442F 77               7      LD  (HL),A
000430 4430 23               6      INC HL
000431 4431 10F0            13      DJNZ    FILE2
                                
       4433                     FILE3:
000433 4433 CD6F44          17      CALL    CCHKF
000436 4436 C8              11      RET Z
000437 4437 FE2E             7      CP  '.'
000439 4439 20F8            12      JR  NZ,FILE3
                                
       443B                     FILE4:
00043B 443B 216EF8          10      LD  HL,FILNAM+8
00043E 443E 0603             7      LD  B,3
                                
       4440                     FILE4L:
000440 4440 CD6F44          17      CALL    CCHKF
000443 4443 C8              11      RET Z
000444 4444 FE2E             7      CP  '.'
000446 4446 2008            12      JR  NZ,FILE12
000448 4448 3266F8          13      LD  (FILNAM),A  ;Parent directory(..)
00044B 444B 3267F8          13      LD  (FILNAM+1),A
00044E 444E 3E20             7      LD  A,020H
       4450                     FILE12:
000450 4450 FE2A             7      CP  '*'
000452 4452 280A            12      JR  Z,FILE10
000454 4454 77               7      LD  (HL),A
000455 4455 23               6      INC HL
000456 4456 10E8            13      DJNZ    FILE4L
000458 4458 C9              10      RET
                                
       4459                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000459 4459 CD5E44          17      CALL    FILE10
00045C 445C 18D5            12      JR  FILE3
                                
       445E                     FILE10:
00045E 445E 3E3F             7      LD  A,'?'
000460 4460 1808            12      JR  FILL_MEMORY
       4462                     FILEI:              ;名前＋拡張子をスペースで初期化
000462 4462 3E20             7      LD  A,020H
000464 4464 01000B          10      LD  BC,11*256   ;C=0にしておく
000467 4467 2166F8          10      LD  HL,FILNAM
       446A                     FILL_MEMORY:            ;HLからBバイトAで埋める
00046A 446A 77               7      LD  (HL),A
00046B 446B 23               6      INC HL
00046C 446C 10FC            13      DJNZ    FILL_MEMORY
00046E 446E C9              10      RET
                                
       446F                     CCHKF:
00046F 446F 1A               7      LD  A,(DE)
000470 4470 CD7744          17      CALL    CCHK2
000473 4473 C8              11      RET Z
000474 4474 C3B444          10      JP  FKAN
                                
       4477                     CCHK2:
000477 4477 0C               4      INC C
000478 4478 0D               4      DEC C
000479 4479 C0              11      RET NZ
       447A                     CCHK3:              ;ZF=1 で使えない文字
00047A 447A FE22             7      CP  '"'
00047C 447C C8              11      RET Z
00047D 447D FE2B             7      CP  '+'
00047F 447F C8              11      RET Z
000480 4480 FE2C             7      CP  ','
000482 4482 C8              11      RET Z
000483 4483 FE2F             7      CP  '/'
000485 4485 C8              11      RET Z
000486 4486 FE3A             7      CP  ':'
000488 4488 C8              11      RET Z
000489 4489 FE3B             7      CP  ';'
00048B 448B C8              11      RET Z
00048C 448C FE3D             7      CP  '='
00048E 448E C8              11      RET Z
00048F 448F FE5C             7      CP  05CH    ;\
000491 4491 C8              11      RET Z
000492 4492 FE20             7      CP  020H
000494 4494 D0              11      RET NC
000495 4495 BF               4      CP  A       ;Z=1
000496 4496 C9              10      RET
                                
       4497                     SS1:
000497 4497 13               6      INC DE
       4498                     SPCUT:              ;スペースをカット
000498 4498 1A               7      LD  A,(DE)
000499 4499 FE20             7      CP  020H
00049B 449B 28FA            12      JR  Z,SS1
00049D 449D C9              10      RET
       449E                     OPCUT1:
00049E 449E 13               6      INC DE
       449F                     OPCUT:
00049F 449F 1A               7      LD  A,(DE)
0004A0 44A0 FE20             7      CP  020H
0004A2 44A2 28FA            12      JR  Z,OPCUT1
0004A4 44A4 FE22             7      CP  '"'
0004A6 44A6 28F6            12      JR  Z,OPCUT1
0004A8 44A8 FE2C             7      CP  ','
0004AA 44AA 28F2            12      JR  Z,OPCUT1
0004AC 44AC C9              10      RET
                                
       44AD                     FKANC:
0004AD 44AD CB41             8      BIT 0,C
0004AF 44AF CCD044          17      CALL    Z,CAP2
0004B2 44B2 1801            12      JR  FKANX
       44B4                     FKAN:           ;漢字チェック
0004B4 44B4 13               6      INC DE
       44B5                     FKANX:
0004B5 44B5 CB41             8      BIT 0,C
0004B7 44B7 CB81             8      RES 0,C
0004B9 44B9 C0              11      RET NZ
0004BA 44BA FE80             7      CP  080H
0004BC 44BC D8              11      RET C
0004BD 44BD FEA0             7      CP  0A0H
0004BF 44BF 3803            12      JR  C,FKAN1
0004C1 44C1 FEE0             7      CP  0E0H
0004C3 44C3 D8              11      RET C
       44C4                     FKAN1:
0004C4 44C4 0C               4      INC C
0004C5 44C5 A7               4      AND A
0004C6 44C6 C9              10      RET
                                
       44C7                     CAP:
0004C7 44C7 FE61             7      CP  'a'
0004C9 44C9 D8              11      RET C
0004CA 44CA FE7B             7      CP  'z'+1
0004CC 44CC D0              11      RET NC
0004CD 44CD D620             7      SUB 020H
0004CF 44CF C9              10      RET
       44D0                     CAP2:
0004D0 44D0 CDC744          17      CALL    CAP
       44D3                     CAP3:               ;
0004D3 44D3 FE05             7      CP  5
0004D5 44D5 2803            12      JR  Z,CAP4
0004D7 44D7 FE21             7      CP  021H
0004D9 44D9 C9              10      RET
       44DA                     CAP4:
0004DA 44DA 3EE5             7      LD  A,0E5H
0004DC 44DC C9              10      RET
                                
       44DD                     ROM_OPEN:
0004DD 44DD CD1B44          17      CALL    FILED
0004E0 44E0 CD9F44          17      CALL    OPCUT
0004E3 44E3 CDC744          17      CALL    CAP
0004E6 44E6 32BEFC          13      LD  (RUNBNF),A
       44E9                     ROM_OPEN_0F:
0004E9 44E9 21006E          10      LD  HL,_DIRBF   ;ディレクトリの先頭
0004EC 44EC 0E70             7      LD  C,112       ;RootEntCnt
0004EE 44EE CD0045          17      CALL    FILESE
0004F1 44F1 3F               4      CCF
0004F2 44F2 D8              11      RET C
0004F3 44F3 2264F8          16      LD  (PTRFIL),HL
0004F6 44F6 210000          10      LD  HL,0
0004F9 44F9 22C6F7          16      LD  (RR_LOW),HL
0004FC 44FC 22C8F7          16      LD  (RR_HIGH),HL
0004FF 44FF C9              10      RET
                                
       4500                     FILESE:
000500 4500 7E               7      LD  A,(HL)
000501 4501 B7               4      OR  A
000502 4502 C8              11      RET Z       ;END:ZF=1 CF=0
000503 4503 FEE5             7      CP  0E5H
000505 4505 280D            12      JR  Z,FILESE1
000507 4507 1166F8          10      LD  DE,FILNAM
00050A 450A E5              11      PUSH    HL
00050B 450B CD2245          17      CALL    CPFILE
00050E 450E CC4345          17      CALL    Z,CPFILE2
000511 4511 E1              10      POP HL
000512 4512 37               4      SCF
000513 4513 C8              11      RET Z       ;!!!:(ZF=1) CF=1
       4514                     FILESE1:
000514 4514 CD1C45          17      CALL    FNEXT
000517 4517 20E7            12      JR  NZ,FILESE
       4519                     ZF0_CF0_AFF_RET:
000519 4519 F6FF             7      OR  0FFH        ;ZF=0 CF=0
00051B 451B C9              10      RET
                                
       451C                     FNEXT:
                                ;   PUSH    HL
                                ;   LD  HL,_FILEN
                                ;   INC (HL)
                                ;   POP HL
00051C 451C 112000          10      LD  DE,020H
00051F 451F 19              11      ADD HL,DE
000520 4520 0D               4      DEC C
000521 4521 C9              10      RET
                                
       4522                     CPFILE:
000522 4522 C5              11      PUSH    BC
000523 4523 01000B          10      LD  BC,00B00H
       4526                     CPSTR1:
000526 4526 1A               7      LD  A,(DE)
000527 4527 FE3F             7      CP  '?'     ;Wild card
000529 4529 2812            12      JR  Z,CPSTR2
00052B 452B 7E               7      LD  A,(HL)
00052C 452C CDAD44          17      CALL    FKANC
00052F 452F E5              11      PUSH    HL
000530 4530 67               4      LD  H,A
000531 4531 1A               7      LD  A,(DE)
000532 4532 CB01             4      RLC C
000534 4534 CDAD44          17      CALL    FKANC
000537 4537 CB09             4      RRC C
000539 4539 BC               4      CP  H       ;CP (HL),(DE)
00053A 453A E1              10      POP HL
00053B 453B 2004            12      JR  NZ,CPSTR3
       453D                     CPSTR2:
00053D 453D 13               6      INC DE
00053E 453E 23               6      INC HL
00053F 453F 10E5            13      DJNZ    CPSTR1
       4541                     CPSTR3:
000541 4541 C1              10      POP BC
000542 4542 C9              10      RET
                                
       4543                     CPFILE2:
                                ;   LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
                                ;   OR  0E1H
000543 4543 3EE1             7      LD  A,0E1H
000545 4545 2F               4      CPL
000546 4546 A6               7      AND (HL)
000547 4547 C9              10      RET
                                
       4548                     RBX1:
000548 4548 E5              11      PUSH    HL      ;Record byte
                                
000549 4549 ED5BC6F7        20      LD  DE,(RR_LOW) ;CDE=Random record
00054D 454D 3AC9F7          13      LD  A,(RR_HIGH+1)
000550 4550 4F               4      LD  C,A
                                
000551 4551 3E01             7      LD  A,DISK_BANK
000553 4553 320068          13      LD  (BANK1_SEL),A
                                
000556 4556 FD2A64F8        20      LD  IY,(PTRFIL)
00055A 455A FD6E1C          19      LD  L,(IY+01CH) ;AHL=File size
00055D 455D FD661D          19      LD  H,(IY+01DH)
000560 4560 FD7E1E          19      LD  A,(IY+01EH)
                                
000563 4563 A7               4      AND A
000564 4564 ED52            15      SBC HL,DE
000566 4566 99               4      SBC A,C
000567 4567 D1              10      POP DE
                                
000568 4568 D8              11      RET C
000569 4569 4F               4      LD  C,A
00056A 456A EB               4      EX  DE,HL   ;CDE=File byte  HL=Record byte
00056B 456B B2               4      OR  D
00056C 456C B3               4      OR  E
00056D 456D C0              11      RET NZ
00056E 456E 37               4      SCF
00056F 456F C9              10      RET
                                
       4570                     RBX2:
000570 4570 ED4BC7F7        20      LD  BC,(RR_LOW+1)
000574 4574 CDE945          17      CALL    RWXR
000577 4577 3E03             7      LD  A,3     ;ooo 1
000579 4579 E5              11      PUSH    HL
00057A 457A 2AC6F7          16      LD  HL,(RR_LOW)
00057D 457D A4               4      AND H
00057E 457E B5               4      OR  L
00057F 457F E1              10      POP HL
000580 4580 C9              10      RET
                                
       4581                     RBXA:
000581 4581 D5              11      PUSH    DE
000582 4582 CD4D46          17      CALL    CLUST
000585 4585 ED53D2F7        20      LD  (_DTPS),DE
000589 4589 D1              10      POP DE
00058A 458A CD2A46          17      CALL    GNCL
00058D 458D D8              11      RET C
00058E 458E ED53CAF7        20      LD  (_CLPS),DE
                                
000592 4592 ED4BC6F7        20      LD  BC,(RR_LOW)
000596 4596 3E03             7      LD  A,3     ;ooo 1
000598 4598 A0               4      AND B
000599 4599 47               4      LD  B,A
00059A 459A 210004          10  IBM7:   LD  HL,1024     ;ooo 512
00059D 459D ED42            15      SBC HL,BC       ;remaining cluster
                                
00059F 459F ED5BCEF7        20      LD  DE,(LEFTX)
0005A3 45A3 ED52            15      SBC HL,DE       ;CP HL,DE
0005A5 45A5 19              11      ADD HL,DE
0005A6 45A6 3801            12      JR  C,RBXA1
0005A8 45A8 EB               4      EX  DE,HL
       45A9                     RBXA1:
0005A9 45A9 3AD4F7          13      LD  A,(_BANK)   ;GNCLでバンクを切り替えたのでデータのあるバンク
0005AC 45AC 320068          13      LD  (BANK1_SEL),A   ;ASCII-8K/Konami-8K共通で使える
0005AF 45AF E5              11      PUSH    HL
0005B0 45B0 2AD2F7          16      LD  HL,(_DTPS)
0005B3 45B3 09              11      ADD HL,BC
0005B4 45B4 ED5BD0F7        20      LD  DE,(DTAX)
0005B8 45B8 C1              10      POP BC
0005B9 45B9 C9              10      RET
                                
       45BA                     RBXB:
0005BA 45BA 2AD0F7          16      LD  HL,(DTAX)
0005BD 45BD ED5BCAF7        20      LD  DE,(_CLPS)
0005C1 45C1 3ACFF7          13      LD  A,(LEFTX+1)
0005C4 45C4 CB3F             8      SRL A
0005C6 45C6 CB3F             8  IBM8:   SRL A       ;ooo
0005C8 45C8 47               4      LD  B,A
0005C9 45C9 C9              10      RET
                                
       45CA                     RBXC:
0005CA 45CA ED4BCEF7        20      LD  BC,(LEFTX)
0005CE 45CE 3E03             7      LD  A,3     ;ooo 1
0005D0 45D0 A0               4      AND B
0005D1 45D1 47               4      LD  B,A
0005D2 45D2 B1               4      OR  C
0005D3 45D3 C9              10      RET
                                
       45D4                     RBXEND:
0005D4 45D4 ED5BCCF7        20      LD  DE,(_LEFT)
0005D8 45D8 2AC6F7          16      LD  HL,(RR_LOW)
0005DB 45DB 3AC9F7          13      LD  A,(RR_HIGH+1)
0005DE 45DE 19              11      ADD HL,DE
0005DF 45DF CE00             7      ADC A,0
0005E1 45E1 22C6F7          16      LD  (RR_LOW),HL
0005E4 45E4 32C9F7          13      LD  (RR_HIGH+1),A
0005E7 45E7 EB               4      EX  DE,HL       ;HL=Read byte
0005E8 45E8 C9              10      RET 
                                
       45E9                     RWXR:
0005E9 45E9 CB38             8      SRL B
0005EB 45EB CB19             8      RR  C
0005ED 45ED CB38             8  IBM4:   SRL B   ;ooo
0005EF 45EF CB19             8      RR  C
                                
0005F1 45F1 3E01             7      LD  A,DISK_BANK
0005F3 45F3 320068          13      LD  (BANK1_SEL),A
                                
0005F6 45F6 FD2A64F8        20      LD  IY,(PTRFIL)
0005FA 45FA FD5E1A          19      LD  E,(IY+01AH) ;ファイルの先頭クラスタ
0005FD 45FD FD561B          19      LD  D,(IY+01BH)
       4600                     RWX1:
000600 4600 ED53CAF7        20      LD  (_CLPS),DE
000604 4604 7A               4      LD  A,D
000605 4605 B3               4      OR  E
000606 4606 37               4      SCF
000607 4607 C8              11      RET Z
                                
000608 4608 78               4      LD  A,B
000609 4609 B1               4      OR  C
00060A 460A C8              11      RET Z
                                
00060B 460B CD2A46          17      CALL    GNCL
00060E 460E D8              11      RET C
00060F 460F 0B               6      DEC BC
000610 4610 CD6F46          17      CALL    ENDCL
000613 4613 38EB            12      JR  C,RWX1
000615 4615 37               4      SCF
000616 4616 C9              10      RET
                                
       4617                     NCL3:
000617 4617 3E01             7      LD  A,DISK_BANK
000619 4619 320068          13      LD  (BANK1_SEL),A
00061C 461C 6B               4      LD  L,E
00061D 461D 62               4      LD  H,D
00061E 461E CB3C             8      SRL H
000620 4620 CB1D             8      RR  L
000622 4622 1F               4      RRA
000623 4623 010062          10      LD  BC,_FATBF
000626 4626 19              11      ADD HL,DE
000627 4627 09              11      ADD HL,BC
000628 4628 17               4      RLA
000629 4629 C9              10      RET
                                
       462A                     GNCL:
00062A 462A 7A               4      LD  A,D
00062B 462B B3               4      OR  E
00062C 462C 37               4      SCF
00062D 462D C8              11      RET Z
00062E 462E C5              11      PUSH    BC
00062F 462F E5              11      PUSH    HL
000630 4630 CD1746          17      CALL    NCL3
000633 4633 3809            12      JR  C,GNC1
000635 4635 5E               7      LD  E,(HL)
000636 4636 23               6      INC HL
000637 4637 7E               7      LD  A,(HL)
000638 4638 E60F             7      AND 00FH
00063A 463A 57               4      LD  D,A
00063B 463B E1              10      POP HL
00063C 463C C1              10      POP BC
00063D 463D C9              10      RET
       463E                     GNC1:
00063E 463E 7E               7      LD  A,(HL)
00063F 463F 23               6      INC HL
000640 4640 56               7      LD  D,(HL)
000641 4641 0604             7      LD  B,4
       4643                     GNC1L:
000643 4643 CB3A             8      SRL D
000645 4645 1F               4      RRA
000646 4646 10FB            13      DJNZ    GNC1L
                                
000648 4648 5F               4      LD  E,A
000649 4649 E1              10      POP HL
00064A 464A C1              10      POP BC
00064B 464B A7               4      AND A
00064C 464C C9              10      RET
                                
       464D                     CLUST:
00064D 464D EB               4      EX  DE,HL
00064E 464E 3E14             7      LD  A,20
000650 4650 29              11      ADD HL,HL   ;*2
000651 4651 29              11      ADD HL,HL   ;*4
000652 4652 85               4      ADD A,L
000653 4653 6F               4      LD  L,A
000654 4654 8C               4      ADC A,H
000655 4655 95               4      SUB L
000656 4656 67               4      LD  H,A
000657 4657 E5              11      PUSH    HL
000658 4658 29              11      ADD HL,HL
000659 4659 29              11      ADD HL,HL
00065A 465A 29              11      ADD HL,HL
00065B 465B 7C               4      LD  A,H
00065C 465C C601             7      ADD A,DISK_BANK
00065E 465E 320068          13      LD  (BANK1_SEL),A
000661 4661 32D4F7          13      LD  (_BANK),A
000664 4664 E1              10      POP HL
000665 4665 3E1F             7      LD  A,01FH
000667 4667 A5               4      AND L
000668 4668 C660             7      ADD A,high BANK1_ADR
00066A 466A 67               4      LD  H,A
00066B 466B 2E00             7      LD  L,0
00066D 466D EB               4      EX  DE,HL
00066E 466E C9              10      RET
                                
       466F                     ENDCL:
00066F 466F 7A               4      LD  A,D ;END CLUSTER
000670 4670 FE02             7      CP  2   ;2CB=715
000672 4672 C0              11      RET NZ
000673 4673 7B               4      LD  A,E
000674 4674 FECB             7      CP  0CBH
000676 4676 C9              10      RET
                                
       4677                     DRDC:
000677 4677 C9              10      RET
                                
       4678                     JP_HL:
000678 4678 E9               4      JP  (HL)
                                
       4679                     WILDCARD:
000679 4679 3F3F3F3F3F3F3F3F        DB  "???????????"
            3F3F3F              
[EOF:FILE.ASM:UTF_8]
                                    INCLUDE "DISK.ASM"
                                
                                ;   Tablacus DISK ROM - DISK
                                
                                ;   ROM DISK DRIVER
                                ;   1セクタ512
                                
       4684                     ERROR_WRITE_PROTECTED:
000684 4684 3E00             7      LD  A,0     ;Write protected
000686 4686 C9              10      RET
       4687                     DISKIO:
000687 4687 38FB            12      JR  C,ERROR_WRITE_PROTECTED
000689 4689 48               4      LD  C,B
00068A 468A CDFF47          17      CALL    GET_DISK_BANK
       468D                     SETMAP1:        
00068D 468D E5              11      PUSH    HL
       468E                     DISKIO1:
00068E 468E C5              11      PUSH    BC      ;B=残りのセクタ数
00068F 468F D5              11      PUSH    DE      ;DE=セクタ番号
000690 4690 F5              11      PUSH    AF      ;A=8KB単位でカートリッジ内のディスクが存在する位置を指定
                                
000691 4691 EB               4      EX  DE,HL       ;DE=受け取る読み出し先のメモリアドレス HL=セクタ番号
000692 4692 29              11      ADD HL,HL
000693 4693 4D               4      LD  C,L     ;C=読み出し元(セクタ番号*2)※1セクタ512バイトなので倍にしておく
000694 4694 29              11      ADD HL,HL       ;64KB→32KB
000695 4695 29              11      ADD HL,HL       ;32KB→16KB
000696 4696 29              11      ADD HL,HL       ;16KB→8KB
000697 4697 84               4      ADD A,H
000698 4698 320068          13      LD  (BANK1_SEL),A   ;ASCII-8K/Konami-8K共通で使える
00069B 469B 32D4F7          13      LD  (_BANK),A
00069E 469E 79               4      LD  A,C     ;C=読み出し元
00069F 469F E61F             7      AND 01FH        ;セグメントのサイズでフィルタする(8K:1F/16K:3F)
0006A1 46A1 C660             7      ADD A,high BANK1_ADR
0006A3 46A3 67               4      LD  H,A
0006A4 46A4 010002          10      LD  BC,00200H   ;BCは読み出すセクタサイズ(512バイト)
0006A7 46A7 69               4      LD  L,C     ;C=0
0006A8 46A8 EDB0                    LDIR
0006AA 46AA EB               4      EX  DE,HL
0006AB 46AB F1              10      POP AF
0006AC 46AC D1              10      POP DE
0006AD 46AD 13               6      INC DE
0006AE 46AE C1              10      POP BC
0006AF 46AF 10DD            13      DJNZ    DISKIO1
0006B1 46B1 41               4      LD  B,C
                                
0006B2 46B2 E1              10      POP HL
0006B3 46B3 AF               4      XOR A
0006B4 46B4 FB               4      EI
0006B5 46B5 C9              10      RET
                                
       46B6                     DSKCHG:
0006B6 46B6 CDEF46          17      CALL    IS_BPB
0006B9 46B9 3824            12      JR  C,NOTREADY
0006BB 46BB 3A23FB          13      LD  A,(DRVTBL+2)
0006BE 46BE B7               4      OR  A
0006BF 46BF 201A            12      JR  NZ,DSKCHG1
0006C1 46C1 3A21FB          13      LD  A,(DRVTBL)
0006C4 46C4 FE02             7      CP  2
0006C6 46C6 2013            12      JR  NZ,DSKCHG1
0006C8 46C8 CDEF46          17      CALL    IS_BPB
0006CB 46CB 300E            12      JR  NC,DSKCHG1
0006CD 46CD 3E01             7      LD  A,1         ;ドライブテーブルを拡張 A:Tablacus DISK ROM B:MASTER SLOT ROM
0006CF 46CF 3221FB          13      LD  (DRVTBL),A
0006D2 46D2 3223FB          13      LD  (DRVTBL+2),A
0006D5 46D5 3A48F3          13      LD  A,(MASTERS)
0006D8 46D8 3224FB          13      LD  (DRVTBL+3),A
       46DB                     DSKCHG1:
0006DB 46DB AF               4      XOR A
0006DC 46DC 0601             7      LD  B,1
0006DE 46DE C9              10      RET
       46DF                     NOTREADY:
0006DF 46DF 3E02             7      LD  A,2
0006E1 46E1 37               4      SCF
0006E2 46E2 C9              10      RET
                                
       46E3                     NO_BPB:
0006E3 46E3 E1              10      POP HL
0006E4 46E4 23               6      INC HL
0006E5 46E5 110248          10      LD  DE,DPB2DD
0006E8 46E8 011200          10      LD  BC,DPB2DD_E-DPB2DD
0006EB 46EB EDB0                    LDIR
0006ED 46ED AF               4      XOR A
0006EE 46EE C9              10      RET
                                
       46EF                     IS_BPB:
                                ; in
                                ; A=DRIVE 0:A 1:B
                                ; out
                                ; CF=0ディスクは存在する CF=1 ディスクは存在しない
0006EF 46EF CDFF47          17      CALL    GET_DISK_BANK
0006F2 46F2 320068          13      LD  (BANK1_SEL),A
                                
0006F5 46F5 3A1560          13      LD  A,(BANK1_ADR+21)    ;BPB_Media
0006F8 46F8 FE01             7      CP  1
0006FA 46FA D8              11      RET C
                                
0006FB 46FB 3A0B60          13      LD  A,(BANK1_ADR+11)    ;BPB_BytsPerSec
0006FE 46FE C6FF             7      ADD A,0FFH
000700 4700 D8              11      RET C
                                
000701 4701 3A0C60          13      LD  A,(BANK1_ADR+12)    ;BPB_BytsPerSec
000704 4704 FE02             7      CP  2
000706 4706 C8              11      RET Z
000707 4707 FE04             7      CP  4
000709 4709 C8              11      RET Z
00070A 470A 37               4      SCF
00070B 470B C9              10      RET
                                
       470C                     GETDPB:
00070C 470C E5              11      PUSH    HL
00070D 470D CDFF47          17      CALL    GET_DISK_BANK
000710 4710 320068          13      LD  (BANK1_SEL),A
                                
000713 4713 3A1560          13      LD  A,(BANK1_ADR+21)    ;BPB_Media  
000716 4716 B7               4      OR  A
000717 4717 28CA            12      JR  Z,NO_BPB
000719 4719 DDE1            14      POP IX
00071B 471B DD7701          19      LD  (IX+1),A        ;MEDIA
                                
00071E 471E 3A0B60          13      LD  A,(BANK1_ADR+11)    ;BPB_BytsPerSec 
000721 4721 DD7702          19      LD  (IX+2),A        ;SECSIZ LOW
                                
000724 4724 3A0C60          13      LD  A,(BANK1_ADR+12)    ;BPB_BytsPerSec 
000727 4727 DD7703          19      LD  (IX+3),A        ;SECSIZ HIGH
                                
00072A 472A 87               4      ADD A,A
00072B 472B 87               4      ADD A,A
00072C 472C 87               4      ADD A,A
00072D 472D 3D               4      DEC A
00072E 472E DD7704          19      LD  (IX+4),A        ;DIRMSK
                                
000731 4731 06FF             7      LD  B,-1
000733 4733 A7               4      AND A           ;無限ループ阻止
       4734                     GETDPB1:
000734 4734 04               4      INC B
000735 4735 1F               4      RRA
000736 4736 38FC            12      JR  C,GETDPB1
000738 4738 DD7005          19      LD  (IX+5),B        ;DIRSHFT
                                
00073B 473B 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus 
00073E 473E 3D               4      DEC A
00073F 473F DD7706          19      LD  (IX+6),A        ;CLUSMSK
                                
000742 4742 A7               4      AND A           ;無限ループ阻止
000743 4743 06FF             7      LD  B,-1
       4745                     GETDPB2:
000745 4745 04               4      INC B
000746 4746 1F               4      RRA
000747 4747 38FC            12      JR  C,GETDPB2
000749 4749 04               4      INC B
00074A 474A DD7007          19      LD  (IX+7),B        ;CLUSSHFT
                                
00074D 474D 2A0E60          16      LD  HL,(BANK1_ADR+14)   ;BPB_RsvdSecCnt 
000750 4750 DD7508          19      LD  (IX+8),L        ;FIRFAT LOW
000753 4753 DD7409          19      LD  (IX+9),H        ;FIRFAT HIGH
                                
000756 4756 3A1060          13      LD  A,(BANK1_ADR+16)    ;BPB_NumFATs    
000759 4759 DD770A          19      LD  (IX+10),A       ;FATCNT
                                
00075C 475C 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt 
00075F 475F DD770B          19      LD  (IX+11),A       ;FATCNT
                                
000762 4762 ED5B1660        20      LD  DE,(BANK1_ADR+22)   ;BPB_FATSz16    
000766 4766 DD7310          19      LD  (IX+16),E       ;FATSIZ
                                
000769 4769 DD460A          19      LD  B,(IX+10)       ;FATCNT
00076C 476C 210000          10      LD  HL,0
       476F                     GETDPB3:
00076F 476F 19              11      ADD HL,DE
000770 4770 10FD            13      DJNZ    GETDPB3
       4772                     GETDPB4:
000772 4772 DD5E08          19      LD  E,(IX+8)        ;FIRFAT
000775 4775 DD5609          19      LD  D,(IX+9)        ;FIRFAT
000778 4778 19              11      ADD HL,DE
000779 4779 DD7511          19      LD  (IX+17),L       ;FIRDIR
00077C 477C DD7412          19      LD  (IX+18),H       ;FIRDIR
                                
00077F 477F 3E08             7      LD  A,2*4           ;SECSIZ HIGH
000781 4781 DD5E0B          19      LD  E,(IX+11)       ;MAXENT
       4784                     GETDPB5:
000784 4784 CB3B             8      SRL E
000786 4786 1F               4      RRA
000787 4787 30FB            12      JR  NC,GETDPB5
000789 4789 1600             7      LD  D,0
00078B 478B 19              11      ADD HL,DE
00078C 478C DD750C          19      LD  (IX+12),L       ;FIRREC
00078F 478F DD740D          19      LD  (IX+13),H       ;FIRREC
                                
000792 4792 2A1360          16      LD  HL,(BANK1_ADR+19)   ;BPB_TotSec16   
                                
000795 4795 DD5E0C          19      LD  E,(IX+12)       ;FIRREC
000798 4798 DD560D          19      LD  D,(IX+13)       ;FIRREC
00079B 479B A7               4      AND A
00079C 479C ED52            15      SBC HL,DE
                                
00079E 479E DD7E06          19      LD  A,(IX+6)        ;CLUSMSK
0007A1 47A1 3C               4      INC A
0007A2 47A2 37               4      SCF             ;無限ループ阻止
       47A3                     GETDPB6:
0007A3 47A3 1F               4      RRA
0007A4 47A4 3806            12      JR  C,GETDPB7
0007A6 47A6 CB3C             8      SRL H
0007A8 47A8 CB1D             8      RR  L
0007AA 47AA 18F7            12      JR  GETDPB6
       47AC                     GETDPB7:
0007AC 47AC 23               6      INC HL
0007AD 47AD DD750E          19      LD  (IX+14),L       ;MAXCLUS
0007B0 47B0 DD740F          19      LD  (IX+15),H       ;MAXCLUS
                                
                                    ;1セクタが512バイト以上の場合を考慮(2HD/1セクタ1024バイト/1.23MB等)
       47B3                     GETDPBD1:
0007B3 47B3 DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
0007B6 47B6 E6FC             7      AND 0FCH
0007B8 47B8 C8              11      RET Z
                                
0007B9 47B9 DDCB033E        23      SRL (IX+3)          ;SECSIZ HIGH
                                
0007BD 47BD 37               4      SCF
0007BE 47BE DDCB0616        23      RL  (IX+6)          ;CLUSMSK
                                
0007C2 47C2 DD3407          23      INC (IX+7)          ;CLUSSHFT
                                
0007C5 47C5 DDCB0826        23      SLA (IX+8)          ;FIRFAT LOW
0007C9 47C9 DDCB0916        23      RL  (IX+9)          ;FIRFAT HIGH
                                
0007CD 47CD DDCB1026        23      SLA (IX+16)         ;FATSIZ
                                
0007D1 47D1 DDCB1126        23      SLA (IX+17)         ;FIRDIR
0007D5 47D5 DDCB1216        23      RL  (IX+18)         ;FIRDIR
                                
0007D9 47D9 DD6E11          19      LD  L,(IX+17)       ;FIRDIR
0007DC 47DC DD6612          19      LD  H,(IX+18)       ;FIRDIR
                                
0007DF 47DF 3E08             7      LD  A,2*4           ;SECSIZ HIGH
0007E1 47E1 DD5E0B          19      LD  E,(IX+11)       ;MAXENT
       47E4                     GETDPBD5:
0007E4 47E4 CB3B             8      SRL E
0007E6 47E6 1F               4      RRA
0007E7 47E7 30FB            12      JR  NC,GETDPBD5
0007E9 47E9 1600             7      LD  D,0
0007EB 47EB 19              11      ADD HL,DE
0007EC 47EC DD750C          19      LD  (IX+12),L       ;FIRREC
0007EF 47EF DD740D          19      LD  (IX+13),H       ;FIRREC
                                
0007F2 47F2 18BF            12      JR  GETDPBD1
                                
       47F4                     CHOICE:
0007F4 47F4 210000          10      LD  HL,0
0007F7 47F7 C9              10      RET
                                
       47F8                     DSKFMT:
0007F8 47F8 AF               4      XOR A
0007F9 47F9 37               4      SCF
       47FA                     DSKSTP:
       47FA                     BASENT:
0007FA 47FA C9              10      RET
                                
       47FB                     GETSLT:
0007FB 47FB 3A22FB          13      LD  A,(DRVTBL+1)
0007FE 47FE C9              10      RET
                                
       47FF                     GET_DISK_BANK:
0007FF 47FF 3E01             7      LD  A,DISK_BANK
000801 4801 C9              10      RET
                                
       4802                     DPB2DD:
000802 4802 F9                      DB  0F9H    ;MEDIA
000803 4803 0002                    DW  00200H  ;SECSIZ
000805 4805 0F                      DB  00FH    ;DIRMSK
000806 4806 04                      DB  004H    ;DIRSHFT
000807 4807 01                      DB  001H    ;CLUSMSK
000808 4808 02                      DB  002H    ;CLUSSHFT
000809 4809 0100                    DW  00001H  ;FIRFAT
00080B 480B 02                      DB  002H    ;FATCNT
00080C 480C 70                      DB  070H    ;MAXENT
00080D 480D 0E00                    DW  0000EH  ;FIRREC
00080F 480F CA02                    DW  002CAH  ;MAXCLUS
000811 4811 03                      DB  003H    ;FATSIZ
000812 4812 0700                    DW  0007H   ;FIRDIR
       4814                     DPB2DD_E:
                                
[EOF:DISK.ASM:UTF_8]
                                    INCLUDE "BDOS.ASM"
       4814                     _ERROR:
000814 4814 A7               4      AND A
000815 4815 C9              10      RET
                                
       4816                     BDOS0:
000816 4816 E5              11      PUSH    HL
000817 4817 79               4      LD  A,C
000818 4818 FE7F             7      CP  07FH
00081A 481A 38F8            12      JR  C,_ERROR
00081C 481C 87               4      ADD A,A
00081D 481D 6F               4      LD  L,A
00081E 481E 265F             7      LD  H,high STABLE
000820 4820 7E               7      LD  A,(HL)
000821 4821 2C               4      INC L
000822 4822 66               7      LD  H,(HL)
000823 4823 6F               4      LD  L,A
000824 4824 E3              19      EX  (SP),HL
000825 4825 79               4      LD  A,C
000826 4826 C9              10      RET
                                
       4827                     _SYS0F:     ;(BDOS)ファイルのオープン
000827 4827 D5              11      PUSH    DE
000828 4828 FDE1            14      POP IY
00082A 482A 13               6      INC DE
00082B 482B EB               4      EX  DE,HL
00082C 482C 010B00          10      LD  BC,8+3
00082F 482F EDB0                    LDIR
000831 4831 CDE944          17      CALL    ROM_OPEN_0F
000834 4834 3853            12      JR  C,SCF_FF_RET
                                ;               Open(Read)
000836 4836 FD361CFF        19      LD  (IY+28),0FFH
                                ;               FILENAME
00083A 483A FDE5            15      PUSH    IY
00083C 483C D1              10      POP DE
00083D 483D 13               6      INC DE
00083E 483E 010B00          10      LD  BC,11
000841 4841 EDB0                    LDIR
                                ;               Attribute
000843 4843 7E               7      LD  A,(HL)
000844 4844 FD770D          19      LD  (IY+13),A
                                ;               TIME
000847 4847 110B00          10      LD  DE,11
00084A 484A 19              11      ADD HL,DE
00084B 484B 7E               7      LD  A,(HL)
00084C 484C 23               6      INC HL
00084D 484D FD7716          19      LD  (IY+22),A
000850 4850 7E               7      LD  A,(HL)
000851 4851 23               6      INC HL
000852 4852 FD7717          19      LD  (IY+23),A
                                ;               DATE
000855 4855 7E               7      LD  A,(HL)
000856 4856 23               6      INC HL
000857 4857 FD7714          19      LD  (IY+20),A
00085A 485A 7E               7      LD  A,(HL)
00085B 485B 23               6      INC HL
00085C 485C FD7715          19      LD  (IY+21),A
                                ;               First cluster
00085F 485F 7E               7      LD  A,(HL)
000860 4860 23               6      INC HL
000861 4861 FD771A          19      LD  (IY+26),A
000864 4864 7E               7      LD  A,(HL)
000865 4865 23               6      INC HL
000866 4866 FD771B          19      LD  (IY+27),A
                                ;               SIZE
000869 4869 7E               7      LD  A,(HL)
00086A 486A 23               6      INC HL
00086B 486B FD7710          19      LD  (IY+16),A
00086E 486E 7E               7      LD  A,(HL)
00086F 486F 23               6      INC HL
000870 4870 FD7711          19      LD  (IY+17),A
000873 4873 7E               7      LD  A,(HL)
000874 4874 23               6      INC HL
000875 4875 FD7712          19      LD  (IY+18),A
000878 4878 7E               7      LD  A,(HL)
000879 4879 FD7713          19      LD  (IY+19),A
00087C 487C AF               4      XOR A
00087D 487D FD770C          19      LD  (IY+12),A
                                ;   LD  (OFCB+1),IY
       4880                     FEND:
000880 4880 9F               4      SBC A,A     ;CF=0 A=0 : CF=1 A=0FFH
       4881                     FENDE:
000881 4881 FDE1            14      POP IY
000883 4883 C1              10      POP BC
000884 4884 D1              10      POP DE
000885 4885 E1              10      POP HL
000886 4886 C9              10      RET
                                
       4887                     _SYS10:
000887 4887 AF               4      XOR A
000888 4888 C9              10      RET
                                
       4889                     SCF_FF_RET:
000889 4889 37               4      SCF
00088A 488A 9F               4      SBC A,A
00088B 488B C9              10      RET
                                
       488C                     _SYS1A:     ;(BDOS)DTAの設定
00088C 488C ED5346FF        20      LD  (_DTA),DE
000890 4890 AF               4      XOR A
000891 4891 C9              10      RET
                                
       4892                     _SYS27:
000892 4892 E5              11      PUSH    HL
000893 4893 FDE1            14      POP IY
000895 4895 FD7E1C          19      LD  A,(IY+28)
000898 4898 FEFF             7      CP  0FFH
00089A 489A 20ED            12      JR  NZ,SCF_FF_RET
00089C 489C 13               6      INC DE
00089D 489D EB               4      EX  DE,HL
00089E 489E 010B00          10      LD  BC,8+3
0008A1 48A1 EDB0                    LDIR
0008A3 48A3 FD6E1A          19      LD  L,(IY+26)
0008A6 48A6 FD661B          19      LD  H,(IY+27)
0008A9 48A9 22CAF7          16      LD  (_CLPS),HL
0008AC 48AC FD6E21          19      LD  L,(IY+33)
0008AF 48AF FD6622          19      LD  H,(IY+34)
0008B2 48B2 22C6F7          16      LD  (RR_LOW),HL
0008B5 48B5 FD6E23          19      LD  L,(IY+35)
0008B8 48B8 FD6624          19      LD  H,(IY+36)
0008BB 48BB 22C8F7          16      LD  (RR_HIGH),HL
0008BE 48BE E1              10      POP HL
0008BF 48BF CD8643          17      CALL    ROM_READ
0008C2 48C2 2AC6F7          16      LD  HL,(RR_LOW)
0008C5 48C5 FD7521          19      LD  (IY+33),L
0008C8 48C8 FD7422          19      LD  (IY+34),H
0008CB 48CB 2AC8F7          16      LD  HL,(RR_HIGH)
0008CE 48CE FD7523          19      LD  (IY+35),L
0008D1 48D1 FD7424          19      LD  (IY+36),H
0008D4 48D4 9F               4      SBC A,A
0008D5 48D5 C9              10      RET
                                
       48D6                     _SYS2F:
0008D6 48D6 44               4      LD  B,H
0008D7 48D7 2A46FF          16      LD  HL,(_DTA)
0008DA 48DA C38746          10      JP  DISKIO
                                
0008DD 48DD                         DS  05F00H-$
       5F00                     STABLE:
                                ;0
001F00 5F00 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F08 5F08 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F10 5F10 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F18 5F18 1448144814482748        DW  _ERROR,_ERROR,_ERROR,_SYS0F
                                ;1
001F20 5F20 8748144814481448        DW  _SYS10,_ERROR,_ERROR,_ERROR
001F28 5F28 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F30 5F30 144814488C481448        DW  _ERROR,_ERROR,_SYS1A,_ERROR
001F38 5F38 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;2
001F40 5F40 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F48 5F48 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F50 5F50 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F58 5F58 1448144814489248        DW  _ERROR,_ERROR,_ERROR,_SYS27
                                ;3
001F60 5F60 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F68 5F68 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F70 5F70 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F78 5F78 144814481448D648        DW  _ERROR,_ERROR,_ERROR,_SYS2F
                                ;4
001F80 5F80 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F88 5F88 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F90 5F90 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F98 5F98 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;5
001FA0 5FA0 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FA8 5FA8 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FB0 5FB0 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FB8 5FB8 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;6
001FC0 5FC0 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FC8 5FC8 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FD0 5FD0 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FD8 5FD8 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;7
001FE0 5FE0 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FE8 5FE8 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FF0 5FF0 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FF8 5FF8 1448144814481448        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                
[EOF:BDOS.ASM:UTF_8]
       6000                     LAST_ADR:
                                
                                    END
[EOF:DISKROM.ASM:UTF_8]
