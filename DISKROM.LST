                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.0.0, LST:Full:4
                                ;   Tablacus DISK ROM Lite for MSX
                                ;   Programmed by
                                ;   Gaku (Lovers/Tablacus)
                                ;
                                    INCLUDE "DEF.ASM"
                                
                                ;   LSX-Dodgers DEF
                                ;   MSX
                                
       4000                     RUN EQU 04000H
                                
       000C                     _RDSLT  EQU 0000CH
       0014                     _WRSLT  EQU 00014H
       001C                     _CALSLT EQU 0001CH
       0024                     _ENASLT EQU 00024H
       0030                     _CALLF  EQU 00030H
       004A                     RDVRM   EQU 0004AH
       004D                     WRTVRM  EQU 0004DH
       005C                     LDIRVM  EQU 0005CH
       009C                     CHSNS   EQU 0009CH
       009F                     CHGET   EQU 0009FH
       00A2                     CHPUT   EQU 000A2H
       00B7                     BREAKX  EQU 000B7H
       00C6                     POSIT   EQU 000C6H
       0138                     RSLREG  EQU 00138H
       0156                     KILBUF  EQU 00156H
                                
       406F                     ERRHAND EQU 0406FH
       42B2                     CRUNCH  EQU 042B2H
       4C64                     FRMEVL  EQU 04C64H
       67D0                     FRESTR  EQU 067D0H
                                
       F331                     H_BDOS  EQU 0F331H
       F341                     RAMAD0  EQU 0F341H
       F342                     RAMAD1  EQU 0F342H
       F343                     RAMAD2  EQU 0F343H
       F344                     RAMAD3  EQU 0F344H
       F348                     MASTERS EQU 0F348H
       F368                     ROMUSE  EQU 0F368H
       F36B                     RAMUSE  EQU 0F36BH
       F37D                     BDOS    EQU 0F37DH
       F38C                     CLPRIM  EQU 0F38CH
       F3B0                     LINLEN  EQU 0F3B0H
       F3B9                     TXTATR  EQU 0F3B9H
       F3BB                     TXTPAT  EQU 0F3BBH
       F3D3                     MLTCOL  EQU 0F3D3H
       F3DC                     CSRY    EQU 0F3DCH
       F3DD                     CSRX    EQU 0F3DDH
       F3F8                     PUTPNT  EQU 0F3F8H
       F3FA                     GETPNT  EQU 0F3FAH
       F3FC                     CS120   EQU 0F3FCH
                                
                                
       F41F                     KBUF    EQU 0F41FH
                                
       F55E                     BUF EQU 0F55EH
                                
       F663                     VALTYP  EQU 0F663H
       F672                     MEMSIZ  EQU 0F672H
       F674                     STKTOP  EQU 0F674H
       F676                     TXTTAB  EQU 0F676H
       F6B1                     SAVSTK  EQU 0F6B1H
       F6C2                     VARTAB  EQU 0F6C2H
       F6C4                     ARYTAB  EQU 0F6C4H
       F6C6                     STREND  EQU 0F6C6H
                                
       F7F6                     DAC EQU 0F7F6H
                                
                                ;FBUFFR EQU 0F7C5H
                                
                                ;PTRFIL EQU 0F864H
       F866                     RUNFLG  EQU 0F866H
                                ;FILNAM EQU 0F866H
                                ;FILNM2 EQU 0F871H
                                
                                ;RSTMP  EQU 0FB03H
       FB21                     DRVTBL  EQU 0FB21H
       FBCA                     FSTPOS  EQU 0FBCAH
       FBF0                     KEYBUF  EQU 0FBF0H
                                
       FC4A                     HIMEM   EQU 0FC4AH
       FCC1                     EXPTBL  EQU 0FCC1H
       FCBE                     RUNBNF  EQU 0FCBEH
       FCBF                     SAVENT  EQU 0FCBFH
                                
       FD99                     DEVICE  EQU 0FD99H
       FE71                     H_BINS  EQU 0FE71H
       FE76                     H_BINL  EQU 0FE76H
       FE7B                     H_FILE  EQU 0FE7BH
       FFA7                     H_PHYD  EQU 0FFA7H
       FEDA                     H_STKE  EQU 0FEDAH
                                
       FF43                     H_GONE  EQU 0FF43H
                                            ;ASCII-8K
       6000                     BANK0_SEL EQU   06000H  ;6000-67FF
       6800                     BANK1_SEL EQU   06800H  ;6800-6FFF
       7000                     BANK2_SEL EQU   07000H  ;7000-77FF
       7800                     BANK3_SEL EQU   07800H  ;7800-7FFF
                                            ;ASCII-16K
                                ;BANK0_SEL EQU 06000H
                                ;BANK1_SEL EQU 07000H
                                            ;KONAMI-8K
       6000                     KONAMI_BANK1_SEL EQU    06000H  ;6000-7FFF
       8000                     KONAMI_BANK2_SEL EQU    08000H  ;8000-9FFF
       A000                     KONAMI_BANK3_SEL EQU    0A000H  ;A000-BFFF
                                                ;KONAMI-SCC
       5000                     KONAMI_SCC_BANK0_SEL EQU    05000H  ;5000-57FF
       7000                     KONAMI_SCC_BANK1_SEL EQU    07000H  ;7000-77FF
       9000                     KONAMI_SCC_BANK2_SEL EQU    09000H  ;9000-97FF
       B000                     KONAMI_SCC_BANK3_SEL EQU    0B000H  ;B000-B7FF
                                
       F0E9                     ISC EQU 0F0E9H
                                
       0001                     DISK_BANK   EQU 1       ;ドライブAが始まるバンク#
       6000                     BANK1_ADR   EQU 06000H      ;バンク1の開始アドレス
                                
       F7F8                     DACDAT  EQU DAC+2
[EOF:DEF.ASM:UTF_8]
                                
                                ;USE_RAM_BLOAD_S    EQU 1   ;先頭のコメントを外すとBLOAD,SでRAMを使う
                                
000000 4000                         ORG RUN
                                
                                ; MSX ROM header
000000 4000 4142                    DB  "AB"   ; ID for auto-executable ROM
000002 4002 0041                    DW  INIT_ROM   ; Main program execution address.
000004 4004 0000                    DW  0      ; STATEMENT
000006 4006 0000                    DW  0      ; DEVICE
000008 4008 0000                    DW  0      ; TEXT
00000A 400A 000000000000            DW  0,0,0  ; Reserved
                                
000010 4010 C3404B          10      JP  DISKIO
000013 4013 C37A4B          10      JP  DSKCHG
000016 4016 C3D04B          10      JP  GETDPB
000019 4019 C3C34C          10      JP  CHOICE
00001C 401C C3C74C          10      JP  DSKFMT
00001F 401F C3C94C          10      JP  DSKSTP
000022 4022 C3CA4C          10      JP  BASENT
000025 4025 37               4      SCF
000026 4026 C3C74C          10      JP  DSKFMT
000029 4029 C3C94C          10      JP  DSKSTP
00002C 402C 00               4      NOP
00002D 402D C3D14C          10      JP  GETSLT
000030 4030 2A4BF3          16      LD  HL,(0F34BH)
000033 4033 C9              10      RET
                                
00007F 407F                         ORG 0407FH
00007F 407F C9              10      RET
                                ; Version
000080 4080 5461626C61637573        DB  "Tablacus DISK ROM Lite v0.1.4.4",0
            204449534B20524F    
            4D204C6974652076    
            302E312E342E3400    
                                
0000FF 40FF                         ORG 040FFH
0000FF 40FF C9              10      RET
                                
                                    INCLUDE "INIT.ASM"
                                
                                ;   Tablacus DISK ROM - INIT
                                ;
                                
       4100                     INIT_ROM:
000100 4100 3A21FB          13      LD  A,(DRVTBL)
000103 4103 FE01             7      CP  1
000105 4105 C8              11      RET Z
                                
000106 4106 0180FF          10      LD  BC,-00080H
000109 4109 2A72F6          16      LD  HL,(MEMSIZ)
00010C 410C 09              11      ADD HL,BC
00010D 410D 2272F6          16      LD  (MEMSIZ),HL
000110 4110 2A74F6          16      LD  HL,(STKTOP)
000113 4113 09              11      ADD HL,BC
000114 4114 2274F6          16      LD  (STKTOP),HL
000117 4117 2180F0          10      LD  HL,0F080H
00011A 411A 1100F0          10      LD  DE,0F000H
00011D 411D 012000          10      LD  BC,00020H
000120 4120 EDB0                    LDIR
000122 4122 2180FF          10      LD  HL,-00080H
000125 4125 39              11      ADD HL,SP
000126 4126 224FF1          16      LD  (BASSTK),HL
000129 4129 ED7B4FF1        20      LD  SP,(BASSTK)
                                
00012D 412D 3EFF             7      LD  A,0FFH
00012F 412F 3299FD          13      LD  (DEVICE),A
                                
000132 4132 3E01             7      LD  A,1
000134 4134 3221FB          13      LD  (DRVTBL),A
                                
000137 4137 AF               4      XOR A
000138 4138 323AF1          13      LD  (_DVSW),A
                                
00013B 413B 210643          10      LD  HL,AT_ISC
00013E 413E 11E9F0          10      LD  DE,ISC
000141 4141 016C00          10      LD  BC,ISC_E-ISC
000144 4144 EDB0                    LDIR
                                    
000146 4146 3EC3             7      LD  A,0C3H      ;JP
000148 4148 3243FF          13      LD  (H_GONE),A
00014B 414B 327DF3          13      LD  (BDOS),A
00014E 414E 326BF3          13      LD  (RAMUSE),A
000151 4151 3268F3          13      LD  (ROMUSE),A
000154 4154 21E9F0          10      LD  HL,REPLACE_COMMAND
000157 4157 2244FF          16      LD  (H_GONE+1),HL
00015A 415A 2131F3          10      LD  HL,H_BDOS
00015D 415D 227EF3          16      LD  (BDOS+1),HL
000160 4160 2110F1          10      LD  HL,RAMUSE1
000163 4163 226CF3          16      LD  (RAMUSE+1),HL
000166 4166 210BF1          10      LD  HL,ROMUSE1
000169 4169 2269F3          16      LD  (ROMUSE+1),HL
                                
00016C 416C 3E                      DB  03EH
00016D 416D F7              12      RST 30H
00016E 416E 3271FE          13      LD  (H_BINS),A
000171 4171 3276FE          13      LD  (H_BINL),A
000174 4174 327BFE          13      LD  (H_FILE),A
000177 4177 3231F3          13      LD  (H_BDOS),A
00017A 417A 32DAFE          13      LD  (H_STKE),A
00017D 417D 32A7FF          13      LD  (H_PHYD),A
                                
000180 4180 CD4642          17      CALL    GTSL1_
000183 4183 32FCF0          13      LD  (ROM_SLT),A
000186 4186 3272FE          13      LD  (H_BINS+1),A
000189 4189 3277FE          13      LD  (H_BINL+1),A
00018C 418C 327CFE          13      LD  (H_FILE+1),A
00018F 418F 3232F3          13      LD  (H_BDOS+1),A
000192 4192 32DBFE          13      LD  (H_STKE+1),A
000195 4195 32A8FF          13      LD  (H_PHYD+1),A
000198 4198 3222FB          13      LD  (DRVTBL+1),A
00019B 419B 3248F3          13      LD  (MASTERS),A
                                
00019E 419E 212D45          10      LD  HL,ROM_LOAD
0001A1 41A1 2273FE          16      LD  (H_BINS+2),HL
0001A4 41A4 214846          10      LD  HL,ROM_RUN
0001A7 41A7 2278FE          16      LD  (H_BINL+2),HL
0001AA 41AA 215546          10      LD  HL,ROM_FILES
0001AD 41AD 227DFE          16      LD  (H_FILE+2),HL
0001B0 41B0 211D4D          10      LD  HL,ROM_BDOS
0001B3 41B3 2233F3          16      LD  (H_BDOS+2),HL
0001B6 41B6 219C43          10      LD  HL,ROM_STKE
0001B9 41B9 22DCFE          16      LD  (H_STKE+2),HL
0001BC 41BC 21404B          10      LD  HL,DISKIO
0001BF 41BF 22A9FF          16      LD  (H_PHYD+2),HL
                                
0001C2 41C2 3E                      DB  03EH
0001C3 41C3 C9              10      RET
0001C4 41C4 327FFE          13      LD  (H_FILE+4),A
0001C7 41C7 3275FE          13      LD  (H_BINS+4),A
0001CA 41CA 327AFE          13      LD  (H_BINL+4),A
0001CD 41CD 3235F3          13      LD  (H_BDOS+4),A
0001D0 41D0 32DEFE          13      LD  (H_STKE+4),A
0001D3 41D3 32ABFF          13      LD  (H_PHYD+4),A
                                
                                #if exists USE_NORMAL_32K_ROM
                                #else
0001D6 41D6 AF               4      XOR A
0001D7 41D7 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
0001DA 41DA 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
0001DD 41DD 3A0060          13      LD  A,(BANK1_ADR)
0001E0 41E0 FE41             7      CP  'A'
0001E2 41E2 2051            12      JR  NZ,NOT_8K_BANK
0001E4 41E4 3E01             7      LD  A,DISK_BANK
0001E6 41E6 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
0001E9 41E9 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
                                #endif
0001EC 41EC CD3801          17      CALL    RSLREG      ;read primary slot #
0001EF 41EF 07               4      RLCA
0001F0 41F0 07               4      RLCA
0001F1 41F1 F5              11      PUSH    AF
0001F2 41F2 1605             7      LD  D,4+1
0001F4 41F4 CD4D42          17      CALL    GTSL2_
0001F7 41F7 3244F3          13      LD  (RAMAD3),A
0001FA 41FA F1              10      POP AF
0001FB 41FB 07               4      RLCA
0001FC 41FC 07               4      RLCA
0001FD 41FD 1603             7      LD  D,2+1
0001FF 41FF CD4D42          17      CALL    GTSL2_
000202 4202 2680             7      LD  H,080H
000204 4204 CD6A42          17      CALL    CHK_RAM
000207 4207 3243F3          13      LD  (RAMAD2),A
       420A                     RAMCHK2:
00020A 420A 3A44F3          13      LD  A,(RAMAD3)
00020D 420D 2640             7      LD  H,040H
00020F 420F CD6A42          17      CALL    CHK_RAM
000212 4212 3242F3          13      LD  (RAMAD1),A
       4215                     RAMCHK1:
000215 4215 3A44F3          13      LD  A,(RAMAD3)
000218 4218 2600             7      LD  H,00H
00021A 421A CD6A42          17      CALL    CHK_RAM
00021D 421D 3241F3          13      LD  (RAMAD0),A
       4220                     RAMCHK0:
000220 4220 2A1360          16      LD  HL,(BANK1_ADR+19)   ;BPB_TotSec16   
000223 4223 010F00          10      LD  BC,0000FH       ;切り上げ
000226 4226 09              11      ADD HL,BC
000227 4227 7D               4      LD  A,L
                                
000228 4228 0604             7      LD  B,4
       422A                     B_DRIVE1:
00022A 422A CB3C             8      SRL H
00022C 422C 1F               4      RRA
00022D 422D 10FB            13      DJNZ    B_DRIVE1
                                
00022F 422F C601             7      ADD A,DISK_BANK     ;A=(TotSec16/16)+DISK_BANK
000231 4231 3239F1          13      LD  (B_DRIVE),A
                                
                                #if exists FIX_DRIVE
                                    LD  A,(B_DRIVE)
                                    CP  FIX_DRIVE
                                    JR  Z,OK_FIX_DRIVE
                                    LD  HL,MSG_ERROR_DRIVE
                                    CALL    MSX
                                    LD  A,(B_DRIVE)
                                    CALL    PRTHX
                                    LD  IY,(EXPTBL-1) ;メインROMスロット
                                    LD  IX,CHGET
                                    CALL    _CALSLT
                                    LD  HL,MSG_CRLF
                                    CALL    MSX
                                OK_FIX_DRIVE:
                                #endif
000234 4234 C9              10      RET
                                
       4235                     NOT_8K_BANK:
                                                ;ASCII-8K/Konami-8Kではない(ASCII-16K等)
000235 4235 21EA43          10      LD  HL,MSG_ERROR_ROM_MODE
000238 4238 CD7543          17      CALL    MSX
00023B 423B FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
00023F 423F DD219F00        14      LD  IX,CHGET
000243 4243 C31C00          10      JP  _CALSLT
                                
       4246                     GTSL1_:             ;自分のいるスロットを知る
000246 4246 CD3801          17      CALL    RSLREG      ;read primary slot #
000249 4249 0F               4      RRCA
00024A 424A 0F               4      RRCA
00024B 424B 1601             7      LD  D,1
       424D                     GTSL2_:
00024D 424D E603             7      AND 3       ;[A]=000000PP
00024F 424F 5F               4      LD  E,A     ;[E]=000000PP
000250 4250 21C1FC          10      LD  HL,EXPTBL
000253 4253 85               4      ADD A,L     ;桁上りは無い
000254 4254 6F               4      LD  L,A     ;[HL]=EXPTBL+000000PP
000255 4255 7B               4      LD  A,E     ;[A]=000000PP
000256 4256 CB7E            13      BIT 7,(HL)
000258 4258 C8              11      RET Z
000259 4259 7D               4      LD  A,L     ;point to SLTTBL entry
00025A 425A C604             7      ADD A,4     ;桁上りは無い
00025C 425C 6F               4      LD  L,A
00025D 425D 7E               7      LD  A,(HL)      ;get currently expansion slot register
       425E                     GTSL3_:
00025E 425E 15               4      DEC D
00025F 425F 2803            12      JR  Z,GTSL4_:
000261 4261 0F               4      RRCA
000262 4262 18FA            12      JR  GTSL3_:
       4264                     GTSL4_:
000264 4264 E60C             7      AND 00CH        ;[A] = 0000SS00
000266 4266 B3               4      OR  E       ;[A] = 0000SSPP
000267 4267 F680             7      OR  080H        ;[A] = 1000SSPP
000269 4269 C9              10      RET
                                
       426A                     CHK_RAM:
00026A 426A E5              11      PUSH    HL
00026B 426B CDBF42          17      CALL    CHK_RAM0
00026E 426E E1              10      POP HL
00026F 426F C8              11      RET Z
000270 4270 3AC1FC          13      LD  A,(EXPTBL)      ;スロット#0
000273 4273 E680             7      AND 080H
000275 4275 CD9642          17      CALL    CHK_RAM_SLT
000278 4278 C8              11      RET Z
000279 4279 3AC2FC          13      LD  A,(EXPTBL+1)        ;スロット#1
00027C 427C E680             7      AND 080H
00027E 427E C601             7      ADD A,1
000280 4280 CD9642          17      CALL    CHK_RAM_SLT
000283 4283 C8              11      RET Z
000284 4284 3AC3FC          13      LD  A,(EXPTBL+2)        ;スロット#2
000287 4287 E680             7      AND 080H
000289 4289 C602             7      ADD A,2
00028B 428B CD9642          17      CALL    CHK_RAM_SLT
00028E 428E C8              11      RET Z
00028F 428F 3AC4FC          13      LD  A,(EXPTBL+3)        ;スロット#3
000292 4292 E680             7      AND 080H
000294 4294 C603             7      ADD A,3
       4296                     CHK_RAM_SLT:
000296 4296 E5              11      PUSH    HL
000297 4297 CDBF42          17      CALL    CHK_RAM0        ;スロット#X or X-0
00029A 429A E1              10      POP HL
00029B 429B C8              11      RET Z
00029C 429C CB79             8      BIT 7,C
00029E 429E 281A            12      JR  Z,CHK_RAM_E     ;スロットは拡張されていない
0002A0 42A0 79               4      LD  A,C
0002A1 42A1 C604             7      ADD A,4*1           ;スロット#X-1
0002A3 42A3 E5              11      PUSH    HL
0002A4 42A4 CDBF42          17      CALL    CHK_RAM0
0002A7 42A7 E1              10      POP HL
0002A8 42A8 C8              11      RET Z
0002A9 42A9 79               4      LD  A,C
0002AA 42AA C608             7      ADD A,4*2           ;スロット#X-2
0002AC 42AC E5              11      PUSH    HL
0002AD 42AD CDBF42          17      CALL    CHK_RAM0
0002B0 42B0 E1              10      POP HL
0002B1 42B1 C8              11      RET Z
0002B2 42B2 79               4      LD  A,C
0002B3 42B3 C60C             7      ADD A,4*3           ;スロット#X-3
0002B5 42B5 E5              11      PUSH    HL
0002B6 42B6 CDBF42          17      CALL    CHK_RAM0
0002B9 42B9 E1              10      POP HL
       42BA                     CHK_RAM_E:
0002BA 42BA AF               4      XOR A
0002BB 42BB 3C               4      INC A           ;ZF=0にする
0002BC 42BC 3E00             7      LD  A,0
0002BE 42BE C9              10      RET
                                
       42BF                     CHK_RAM0:
0002BF 42BF 4F               4      LD  C,A
0002C0 42C0 3AFCF0          13      LD  A,(ROM_SLT)
0002C3 42C3 B9               4      CP  C
0002C4 42C4 28F4            12      JR  Z,CHK_RAM_E
0002C6 42C6 2E00             7      LD  L,0
       42C8                     CHK_RAM1:
0002C8 42C8 79               4      LD  A,C
0002C9 42C9 DD210C00        14      LD  IX,_RDSLT
0002CD 42CD CDFA42          17      CALL    CALSLT_R
0002D0 42D0 C6E5             7      ADD A,0E5H
0002D2 42D2 47               4      LD  B,A
0002D3 42D3 5F               4      LD  E,A
0002D4 42D4 79               4      LD  A,C
0002D5 42D5 DD211400        14      LD  IX,_WRSLT
0002D9 42D9 CDFA42          17      CALL    CALSLT_R
0002DC 42DC 79               4      LD  A,C
0002DD 42DD DD210C00        14      LD  IX,_RDSLT
0002E1 42E1 CDFA42          17      CALL    CALSLT_R
0002E4 42E4 B8               4      CP  B
0002E5 42E5 C0              11      RET NZ
0002E6 42E6 D6E5             7      SUB 0E5H
0002E8 42E8 79               4      LD  A,C
0002E9 42E9 5F               4      LD  E,A
0002EA 42EA DD211400        14      LD  IX,_WRSLT
0002EE 42EE CDFA42          17      CALL    CALSLT_R
0002F1 42F1 24               4      INC H
0002F2 42F2 7D               4      LD  A,L
0002F3 42F3 C604             7      ADD A,4
0002F5 42F5 6F               4      LD  L,A
0002F6 42F6 20D0            12      JR  NZ,CHK_RAM1
0002F8 42F8 79               4      LD  A,C     ;ZF=1のハズ
0002F9 42F9 C9              10      RET
                                
       42FA                     CALSLT_R:
0002FA 42FA C5              11      PUSH    BC
0002FB 42FB E5              11      PUSH    HL
0002FC 42FC FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
000300 4300 CD1C00          17      CALL    _CALSLT
000303 4303 E1              10      POP HL
000304 4304 C1              10      POP BC
000305 4305 C9              10      RET
                                
       4306                     AT_ISC:
000306 F0E9                         ORG ISC,AT_ISC-RUN
       F0E9                     REPLACE_COMMAND:
000306 F0E9 FEB7             7      CP  0B7H            ;FILES
000308 F0EB CC7BFE          17      CALL    Z,H_FILE
00030B F0EE FEB5             7      CP  0B5H            ;LOAD
00030D F0F0 CA71FE          10      JP  Z,H_BINS
000310 F0F3 FE8A             7      CP  08AH            ;RUN
000312 F0F5 CA76FE          10      JP  Z,H_BINL
000315 F0F8 FECF             7      CP  0CFH            ;BLOAD
000317 F0FA C0              11      RET NZ
       F0FB                     FIX_BLOAD:
000318 F0FB F7              12      RST 30H
       F0FC                     ROM_SLT:
000319 F0FC 00                      DB  0
00031A F0FD 8A45                    DW  ROM_BLOAD
00031C F0FF F5              11      PUSH    AF
00031D F100 E5              11      PUSH    HL
00031E F101 CD0AF1          17      CALL    BLOAD_RET
       F102                     SWC_BLOAD   EQU $-2
000321 F104 E1              10      POP HL
000322 F105 F1              10      POP AF
000323 F106 FECF             7      CP  0CFH            ;BLOAD
       F108                     SWC_BLOAD_M:
000325 F108 28DF            12      JR  Z,REPLACE_COMMAND
       F10A                     BLOAD_RET:
000327 F10A C9              10      RET
       F10B                     ROMUSE1:
000328 F10B 3AFCF0          13      LD  A,(ROM_SLT)
00032B F10E 1803            12      JR  ROMUSE2
       F110                     RAMUSE1:
00032D F110 3A42F3          13      LD  A,(RAMAD1)
       F113                     ROMUSE2:
000330 F113 C32400          10      JP  _ENASLT
                                
       F116                     _RESULT:
000333 F116 00                      DB  0
       F117                     _BANK:
000334 F117 00                      DB  0
       F118                     CLSZ:               ;クラスタサイズ
000335 F118 0004                    DW  1024
       F119                     CLSZ_H  EQU $-1     ;クラスタサイズ上位8ビット
       F11A                     SECSZ:              ;セクタサイズ
000337 F11A 0002                    DW  512
       F11B                     SECSZ_H EQU $-1     ;セクタサイズ上位8ビット
       F11C                     RR_LOW:
000339 F11C 0000                    DW  0
       F11D                     RR_MID  EQU $-1
       F11E                     RR_HIGH:
00033B F11E 0000                    DW  0
       F120                     _CLPS:
00033D F120 0000                    DW  0
       F122                     _LEFT:
00033F F122 0000                    DW  0
       F124                     _DTPS:
000341 F124 0000                    DW  0
       F126                     _DTA:
000343 F126 0000                    DW  0
                                #if exists USE_RAM_BLOAD_S
                                #else
       F128                     FLG_LDIR:
000345 F128 00                      DB  0
                                #endif
                                ;   BDOS
000346 F129 F7              12      RST 30H
000347 F12A 00                      DB  0
000348 F12B 1D4D                    DW  ROM_BDOS
00034A F12D C9              10      RET 
       F12E                     _FCB:
00034B F12E 0000                    DW  0
       F130                     _BUF:
00034D F130 00                      DB  0
       F131                     _BUF_ST:
00034E F131 0000                    DW  0
       F133                     _BUF_EN:
000350 F133 0000                    DW  0
       F135                     _BUF_EX:
000352 F135 0000                    DW  0
                                
       F137                     DTAX:
000354 F137 0000                    DW  0
       F139                     B_DRIVE:
000356 F139 00                      DB  0
       F13A                     _DVSW:
000357 F13A 00                      DB  0
       F13B                     FCBX:
000358 F13B 0000                    DW  0
       F13D                     LEFTX:
00035A F13D 0000                    DW  0
       F13F                     PARAM0:
00035C F13F 0000                    DW  0
       F141                     PARAM1:
00035E F141 0000                    DW  0
       F143                     FDRV:
000360 F143 00                      DB  0
       F144                     FNAME:
000361 F144                         DS  8+3
                                
       F14F                     BASSTK:
00036C F14F 0000                    DW  0
       F151                     _HL:
00036E F151 0000                    DW  0
       F153                     _SP:
000370 F153 0000                    DW  0
                                
       F155                     ISC_E:
000372 4372                         ORG $$+RUN          ;$DEPHASE
                                
       4372                     MSX1:
000372 4372 CD364D          17      CALL    MSGA1
       4375                     MSX:
000375 4375 7E               7      LD  A,(HL)
000376 4376 23               6      INC HL
000377 4377 B7               4      OR  A
000378 4378 20F8            12      JR  NZ,MSX1
00037A 437A C9              10      RET
                                
       437B                     PRTHX:
00037B 437B F5              11      PUSH    AF
00037C 437C 07               4      RLCA
00037D 437D 07               4      RLCA
00037E 437E 07               4      RLCA
00037F 437F 07               4      RLCA
000380 4380 CD8443          17      CALL    PRTA2
000383 4383 F1              10      POP AF
       4384                     PRTA2:
000384 4384 CD8A43          17      CALL    ASC
000387 4387 C3324D          10      JP  MSG_A
                                    
       438A                     ASC:
00038A 438A E60F             7      AND $0F
00038C 438C F630             7      OR  $30
00038E 438E FE3A             7      CP  $3A
000390 4390 D8              11      RET C
000391 4391 C607             7      ADD A,7
000393 4393 C9              10      RET
                                
       4394                     MSN:
000394 4394 7E               7      LD  A,(HL)
000395 4395 23               6      INC HL
000396 4396 CD324D          17      CALL    MSG_A
000399 4399 10F9            13      DJNZ    MSN
00039B 439B C9              10      RET
                                
       439C                     ROM_STKE:
00039C 439C 3E                      DB  03EH
00039D 439D C9              10      RET
00039E 439E 32DAFE          13      LD  (H_STKE),A
0003A1 43A1 E5              11      PUSH    HL
0003A2 43A2 D5              11      PUSH    DE
0003A3 43A3 C5              11      PUSH    BC
0003A4 43A4 181D            12      JR  BASAUTO
                                
0003A6 43A6 AF               4      XOR A
0003A7 43A7 5F               4      LD  E,A
0003A8 43A8 57               4      LD  D,A
0003A9 43A9 0601             7      LD  B,1
0003AB 43AB 2100C0          10      LD  HL,0C000H
0003AE 43AE CD404B          17      CALL    DISKIO
                                
0003B1 43B1 ED734FF1        20      LD  (BASSTK),SP
0003B5 43B5 116BF3          10      LD  DE,RAMUSE
0003B8 43B8 AF               4      XOR A
0003B9 43B9 CD1EC0          17      CALL    0C01EH
0003BC 43BC 116BF3          10      LD  DE,RAMUSE
0003BF 43BF 37               4      SCF
0003C0 43C0 CD1EC0          17      CALL    0C01EH
       43C3                     BASAUTO:
0003C3 43C3 211044          10      LD  HL,AUTOEXEC
0003C6 43C6 1143F1          10      LD  DE,FDRV
0003C9 43C9 010C00          10      LD  BC,1+8+3
0003CC 43CC EDB0                    LDIR
0003CE 43CE CDB648          17      CALL    ROM_OPEN
0003D1 43D1 3813            12      JR  C,RSTKEE
0003D3 43D3 211C44          10      LD  HL,RUN_AUTOEXEC
0003D6 43D6 11F0FB          10      LD  DE,KEYBUF
0003D9 43D9 ED53FAF3        20      LD  (GETPNT),DE
0003DD 43DD 011300          10      LD  BC,RUN_AUTOEXEC_E-RUN_AUTOEXEC
0003E0 43E0 EDB0                    LDIR
0003E2 43E2 ED53F8F3        20      LD  (PUTPNT),DE
       43E6                     RSTKEE:
0003E6 43E6 C1              10      POP BC
0003E7 43E7 D1              10      POP DE
0003E8 43E8 E1              10      POP HL
0003E9 43E9 C9              10      RET
                                
       43EA                     MSG_ERROR_ROM_MODE:
0003EA 43EA 41534349492D384B        DB  "ASCII-8K/Konami-8K/Konami-SCC only!",13,10
            2F4B6F6E616D692D    
            384B2F4B6F6E616D    
            692D534343206F6E    
            6C79210D0A          
       440F                     NULL:
00040F 440F 00                      DB  0
                                
       4410                     AUTOEXEC:
000410 4410 004155544F455845        DB  0,"AUTOEXECBAS"
            43424153            
       441C                     RUN_AUTOEXEC:
00041C 441C 52554E2022415554        DB  'RUN "AUTOEXEC.BAS"',00DH
            4F455845432E4241    
            53220D              
                                ;   DB  'LOAD "AUTOEXEC.BAS"',00DH  ;テスト用
       442F                     RUN_AUTOEXEC_E:
[EOF:INIT.ASM:UTF_8]
                                    INCLUDE "FILE.ASM"
       442F                     ROM_LDIR:
                                #if exists USE_RAM_BLOAD_S
                                #else
00042F 442F 3A28F1          13      LD  A,(FLG_LDIR)
000432 4432 B7               4      OR  A
000433 4433 2008            12      JR  NZ,ROM_LDIRVM
                                #endif
000435 4435 CB7A             8      BIT 7,D
000437 4437 CA4F44          10      JP  Z,ROM_LDIRSLT
                                
                                #if exists USE_NORMAL_32K_ROM
                                    LD  (_SP),SP
                                    LD  SP,DRVTBL
                                LDIR1:
                                    LD  A,B
                                    OR  C
                                    JR  Z,LDIRE
                                
                                    PUSH    BC
                                    PUSH    DE
                                    PUSH    HL
                                    LD  A,(ROM_SLT)
                                    LD  H,080H
                                    CALL    _ENASLT
                                    POP HL
                                    POP DE
                                    POP BC
                                LDIR2:
                                    LD  A,D
                                    CP  0C0H
                                    JR  NC,LDIR4
                                
                                    PUSH    BC
                                    PUSH    DE
                                    LD  DE,BUF
                                
                                    LD  A,B
                                    OR  A
                                    JR  Z,LDIR3
                                    LD  BC,00100H
                                LDIR3:
                                    PUSH    BC
                                    LDIR
                                    LD  (_HL),HL
                                
                                    LD  A,(RAMAD2)
                                    LD  H,080H
                                    CALL    _ENASLT
                                
                                    LD  HL,BUF
                                    POP BC
                                    POP DE
                                    LDIR
                                
                                    LD  HL,(_HL)
                                    POP BC
                                    LD  A,B
                                    OR  A
                                    JR  Z,LDIRE
                                    DEC B
                                    JR  LDIR1
                                LDIR4:
                                #endif
00043A 443A EDB0                    LDIR
                                
                                #if exists USE_NORMAL_32K_ROM
                                LDIRE:
                                    PUSH    DE
                                    PUSH    HL
                                    LD  A,(RAMAD2)
                                    LD  H,080H
                                    CALL    _ENASLT
                                    POP HL
                                    POP DE
                                    LD  SP,(_SP)
                                #endif
00043C 443C C9              10      RET
                                
       443D                     ROM_LDIRVM:
                                #if exists USE_NORMAL_32K_ROM
                                    PUSH    BC
                                    PUSH    DE
                                    PUSH    HL
                                    LD  A,(ROM_SLT)
                                    LD  H,080H
                                    CALL    _ENASLT
                                    POP HL
                                    POP DE
                                    POP BC
                                #endif
00043D 443D C5              11      PUSH    BC
00043E 443E D5              11      PUSH    DE
00043F 443F FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
000443 4443 DD215C00        14      LD  IX,LDIRVM
000447 4447 CD1C00          17      CALL    _CALSLT
                                #if exists USE_NORMAL_32K_ROM
                                    LD  H,080H
                                    LD  A,(RAMAD2)
                                    CALL    _ENASLT
                                #endif
00044A 444A E1              10      POP HL
00044B 444B C1              10      POP BC
00044C 444C 09              11      ADD HL,BC
00044D 444D EB               4      EX  DE,HL
00044E 444E C9              10      RET
                                
       444F                     ROM_LDIRSLT:
00044F 444F EB               4      EX  DE,HL
       4450                     RLDIRSLT1:
000450 4450 1A               7      LD  A,(DE)
000451 4451 13               6      INC DE
000452 4452 C5              11      PUSH    BC
000453 4453 D5              11      PUSH    DE
000454 4454 E5              11      PUSH    HL
000455 4455 5F               4      LD  E,A
000456 4456 3A42F3          13      LD  A,(RAMAD1)
000459 4459 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
00045D 445D DD211400        14      LD  IX,_WRSLT
000461 4461 CD1C00          17      CALL    _CALSLT
000464 4464 E1              10      POP HL
000465 4465 D1              10      POP DE
000466 4466 C1              10      POP BC
000467 4467 EDA1            16      CPI         ;HL=HL+1 BC=BC-1 BCが0の場合にP/V=0
000469 4469 EA5044          10      JP  PE,RLDIRSLT1
00046C 446C EB               4      EX  DE,HL
00046D 446D C9              10      RET
                                
       446E                     END_OF_LINE:
00046E 446E 215EF5          10      LD  HL,BUF
       4471                     EOL1:
000471 4471 7E               7      LD  A,(HL)
000472 4472 C8              11      RET Z
000473 4473 FE0D             7      CP  00DH
000475 4475 2807            12      JR  Z,EOLE
000477 4477 FE0A             7      CP  00AH
000479 4479 2803            12      JR  Z,EOLE
00047B 447B 23               6      INC HL
00047C 447C 18F3            12      JR  EOL1
       447E                     EOLE:
00047E 447E 3600            10      LD  (HL),0
000480 4480 23               6      INC HL
000481 4481 7E               7      LD  A,(HL)
000482 4482 FE0A             7      CP  00AH
000484 4484 C0              11      RET NZ
000485 4485 23               6      INC HL
000486 4486 C9              10      RET
                                
       4487                     ROM_LOAD_ASCII:
000487 4487 210000          10      LD  HL,0
00048A 448A 2231F1          16      LD  (_BUF_ST),HL    ;読み出し位置
00048D 448D 2A76F6          16      LD  HL,(TXTTAB)
000490 4490 2233F1          16      LD  (_BUF_EN),HL    ;書き出し位置
                                
000493 4493 215EF5          10      LD  HL,BUF
000496 4496 2226F1          16      LD  (_DTA),HL
       4499                     RLOAD_A1:
000499 4499 2A31F1          16      LD  HL,(_BUF_ST)
00049C 449C 221CF1          16      LD  (RR_LOW),HL
00049F 449F 210201          10      LD  HL,258
0004A2 44A2 CDD646          17      CALL    ROM_READ
0004A5 44A5 7C               4      LD  A,H
0004A6 44A6 B5               4      OR  L
0004A7 44A7 2877            12      JR  Z,RLOAD_AEND
0004A9 44A9 015EF5          10      LD  BC,BUF
0004AC 44AC 09              11      ADD HL,BC
0004AD 44AD 3600            10      LD  (HL),0
0004AF 44AF CD6E44          17      CALL    END_OF_LINE
0004B2 44B2 015EF5          10      LD  BC,BUF
0004B5 44B5 A7               4      AND A
0004B6 44B6 ED42            15      SBC HL,BC
0004B8 44B8 2810            12      JR  Z,RLOAD_A2
0004BA 44BA 4D               4      LD  C,L
0004BB 44BB 44               4      LD  B,H
0004BC 44BC ED5B31F1        20      LD  DE,(_BUF_ST)
0004C0 44C0 19              11      ADD HL,DE
0004C1 44C1 2231F1          16      LD  (_BUF_ST),HL
0004C4 44C4 3A5EF5          13      LD  A,(BUF)
0004C7 44C7 B7               4      OR  A
0004C8 44C8 28CF            12      JR  Z,RLOAD_A1
       44CA                     RLOAD_A2:
0004CA 44CA 115EF5          10      LD  DE,BUF
0004CD 44CD CD4D48          17      CALL    SPCUTEX
0004D0 44D0 1A               7      LD  A,(DE)
0004D1 44D1 B7               4      OR  A
0004D2 44D2 284C            12      JR  Z,RLOAD_AEND
0004D4 44D4 CD5F48          17      CALL    GETNUM
0004D7 44D7 7C               4      LD  A,H
0004D8 44D8 B5               4      OR  L
0004D9 44D9 CA7745          10      JP  Z,ERROR_DIRECT_IN_FILE
0004DC 44DC DD2A33F1        20      LD  IX,(_BUF_EN)
0004E0 44E0 DD7502          19      LD  (IX+2),L
0004E3 44E3 DD7403          19      LD  (IX+3),H
                                
0004E6 44E6 CD4648          17      CALL    SPCUT
0004E9 44E9 EB               4      EX  DE,HL
0004EA 44EA DDE5            15      PUSH    IX
0004EC 44EC DD21B242        14      LD  IX,CRUNCH
0004F0 44F0 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
0004F4 44F4 CD1C00          17      CALL    _CALSLT
0004F7 44F7 DDE1            14      POP IX
0004F9 44F9 EB               4      EX  DE,HL
0004FA 44FA 111FF4          10      LD  DE,KBUF
0004FD 44FD 37               4      SCF
0004FE 44FE ED52            15      SBC HL,DE
000500 4500 2875            12      JR  Z,ERROR_DIRECT_IN_FILE
000502 4502 3873            12      JR  C,ERROR_DIRECT_IN_FILE
000504 4504 4D               4      LD  C,L
000505 4505 44               4      LD  B,H
000506 4506 2A33F1          16      LD  HL,(_BUF_EN)
000509 4509 110400          10      LD  DE,4
00050C 450C 19              11      ADD HL,DE
00050D 450D 111FF4          10      LD  DE,KBUF
                                
000510 4510 EB               4      EX  DE,HL
000511 4511 EDB0                    LDIR
000513 4513 EB               4      EX  DE,HL
                                
000514 4514 DD7500          19      LD  (IX+0),L
000517 4517 DD7401          19      LD  (IX+1),H
00051A 451A 2233F1          16      LD  (_BUF_EN),HL
00051D 451D C39944          10      JP  RLOAD_A1
                                
       4520                     RLOAD_AEND:
000520 4520 2A33F1          16      LD  HL,(_BUF_EN)
000523 4523 AF               4      XOR A
000524 4524 77               7      LD  (HL),A
000525 4525 23               6      INC HL
000526 4526 77               7      LD  (HL),A
000527 4527 23               6      INC HL
000528 4528 2233F1          16      LD  (_BUF_EN),HL
00052B 452B 1833            12      JR  RLOAD_END1
                                
       452D                     ROM_LOAD:
00052D 452D CDAB46          17      CALL    INIT_PARAM
000530 4530 CD7647          17      CALL    FILE_B
000533 4533 CDB648          17      CALL    ROM_OPEN
000536 4536 3845            12      JR  C,ERROR_FILE_NOT_FOUND
                                
000538 4538 2130F1          10      LD  HL,_BUF
00053B 453B 2226F1          16      LD  (_DTA),HL
00053E 453E 210100          10      LD  HL,1            ;ヘッダを1バイト読み込む
000541 4541 CDD646          17      CALL    ROM_READ
000544 4544 3A30F1          13      LD  A,(_BUF)
000547 4547 3C               4      INC A
000548 4548 C28744          10      JP  NZ,ROM_LOAD_ASCII
00054B 454B 2A76F6          16      LD  HL,(TXTTAB)
00054E 454E 2226F1          16      LD  (_DTA),HL
000551 4551 EB               4      EX  DE,HL
000552 4552 2100FF          10      LD  HL,-256
000555 4555 39              11      ADD HL,SP
000556 4556 ED52            15      SBC HL,DE
000558 4558 CDD646          17      CALL    ROM_READ
00055B 455B ED5B26F1        20      LD  DE,(_DTA)
00055F 455F 19              11      ADD HL,DE
       4560                     RLOAD_END1:
000560 4560 22C2F6          16      LD  (VARTAB),HL
000563 4563 22C4F6          16      LD  (ARYTAB),HL
000566 4566 22C6F6          16      LD  (STREND),HL
                                
000569 4569 AF               4      XOR A
00056A 456A 2133F1          10      LD  HL,_BUF+3
00056D 456D 77               7      LD  (HL),A
00056E 456E 2B               6      DEC HL
00056F 456F 77               7      LD  (HL),A
000570 4570 2B               6      DEC HL
000571 4571 77               7      LD  (HL),A
000572 4572 2B               6      DEC HL
000573 4573 3E8F             7      LD  A,08FH          ;REM
000575 4575 77               7      LD  (HL),A
000576 4576 C9              10      RET
                                
       4577                     ERROR_DIRECT_IN_FILE:
000577 4577 1E39             7      LD  E,57            ;Direct statement in file
000579 4579 01                      DB  1           ;LD BC,
       457A                     ERROR_FILE_NOT_OPEN:
00057A 457A 1E3B             7      LD  E,59            ;File not OPEN
00057C 457C 01                      DB  1           ;LD BC,
       457D                     ERROR_FILE_NOT_FOUND:
00057D 457D 1E35             7      LD  E,53            ;File not found
       457F                     ERROR:
00057F 457F FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
000583 4583 DD216F40        14      LD  IX,ERRHAND
000587 4587 C31C00          10      JP  _CALSLT
                                
       458A                     ROM_BLOAD:
00058A 458A CDAB46          17      CALL    INIT_PARAM
00058D 458D CD7647          17      CALL    FILE_B
000590 4590 CDB648          17      CALL    ROM_OPEN
000593 4593 38E8            12      JR  C,ERROR_FILE_NOT_FOUND
                                
000595 4595 2130F1          10      LD  HL,_BUF
000598 4598 2226F1          16      LD  (_DTA),HL
00059B 459B 210700          10      LD  HL,7            ;ヘッダを7バイト読み込む
00059E 459E CDD646          17      CALL    ROM_READ
0005A1 45A1 3A30F1          13      LD  A,(_BUF)
0005A4 45A4 FEFE             7      CP  0FEH
0005A6 45A6 20D2            12      JR  NZ,ERROR_FILE_NOT_OPEN
                                
0005A8 45A8 210AF1          10      LD  HL,BLOAD_RET
0005AB 45AB 2202F1          16      LD  (SWC_BLOAD),HL
                                
0005AE 45AE 2A41F1          16      LD  HL,(PARAM1)
0005B1 45B1 7E               7      LD  A,(HL)
0005B2 45B2 FE2C             7      CP  ','
0005B4 45B4 2048            12      JR  NZ,RBREAD_MEM
0005B6 45B6 23               6      INC HL
0005B7 45B7 7E               7      LD  A,(HL)
0005B8 45B8 CDA048          17      CALL    CAP
0005BB 45BB 32BEFC          13      LD  (RUNBNF),A
       45BE                     RBOS1:
0005BE 45BE 7E               7      LD  A,(HL)
0005BF 45BF 23               6      INC HL
0005C0 45C0 B7               4      OR  A
0005C1 45C1 282F            12      JR  Z,RBREAD_OSE
0005C3 45C3 FE3A             7      CP  ':'
0005C5 45C5 282B            12      JR  Z,RBREAD_OSE
0005C7 45C7 FE2C             7      CP  ','     ;次のパラメータを探す
0005C9 45C9 20F3            12      JR  NZ,RBOS1
                                                ;オフセット
0005CB 45CB 2241F1          16      LD  (PARAM1),HL
0005CE 45CE 7E               7      LD  A,(HL)
0005CF 45CF B7               4      OR  A
0005D0 45D0 2820            12      JR  Z,RBREAD_OSE
0005D2 45D2 DD21644C        14      LD  IX,FRMEVL
0005D6 45D6 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
0005DA 45DA CD1C00          17      CALL    _CALSLT
0005DD 45DD 2241F1          16      LD  (PARAM1),HL
0005E0 45E0 3A63F6          13      LD  A,(VALTYP)
0005E3 45E3 FE02             7      CP  2
0005E5 45E5 200B            12      JR  NZ,RBREAD_OSE
0005E7 45E7 2A31F1          16      LD  HL,(_BUF_ST)
0005EA 45EA ED5BF8F7        20      LD  DE,(DACDAT)
0005EE 45EE 19              11      ADD HL,DE
0005EF 45EF 2231F1          16      LD  (_BUF_ST),HL
       45F2                     RBREAD_OSE:
0005F2 45F2 3ABEFC          13      LD  A,(RUNBNF)
0005F5 45F5 FE53             7      CP  'S'
                                #if exists USE_RAM_BLOAD_S
                                    JR  Z,ROM_BLOAD_SCREEN
                                #else
0005F7 45F7 2005            12      JR  NZ,RBREAD_MEM
0005F9 45F9 3E01             7      LD  A,1
0005FB 45FB 3228F1          13      LD  (FLG_LDIR),A
                                #endif
       45FE                     RBREAD_MEM:
0005FE 45FE 2A31F1          16      LD  HL,(_BUF_ST)
000601 4601 22BFFC          16      LD  (SAVENT),HL
000604 4604 2226F1          16      LD  (_DTA),HL
000607 4607 21FFFF          10      LD  HL,0FFFFH
00060A 460A CDD646          17      CALL    ROM_READ
00060D 460D 3ABEFC          13      LD  A,(RUNBNF)
000610 4610 FE52             7      CP  'R'
000612 4612 2006            12      JR  NZ,RBREAD1
000614 4614 2A35F1          16      LD  HL,(_BUF_EX)
000617 4617 2202F1          16      LD  (SWC_BLOAD),HL
       461A                     RBREAD1:
       461A                     ROM_NEXT:
00061A 461A 2A41F1          16      LD  HL,(PARAM1)
00061D 461D 7E               7      LD  A,(HL)
00061E 461E 2B               6      DEC HL
00061F 461F B7               4      OR  A
000620 4620 2805            12      JR  Z,RN1
000622 4622 FE3A             7      CP  ':'
000624 4624 2801            12      JR  Z,RN1
000626 4626 23               6      INC HL
       4627                     RN1:
000627 4627 5D               4      LD  E,L
000628 4628 54               4      LD  D,H
                                
000629 4629 CD7648          17      CALL    SEARCH_END
00062C 462C B7               4      OR  A
00062D 462D 2815            12      JR  Z,REM
                                                    ;マルチステートメントの処理
00062F 462F 7E               7      LD  A,(HL)
                                
000630 4630 FEB5             7      CP  0B5H            ;LOAD
000632 4632 CA2D45          10      JP  Z,ROM_LOAD
000635 4635 FE8A             7      CP  08AH            ;RUN
000637 4637 280F            12      JR  Z,ROM_RUN
000639 4639 FEB7             7      CP  0B7H            ;FILES
00063B 463B 2818            12      JR  Z,ROM_FILES
00063D 463D 3E28             7      LD  A,028H          ;JR Z,
00063F 463F 3208F1          13      LD  (SWC_BLOAD_M),A
000642 4642 7E               7      LD  A,(HL)
000643 4643 C9              10      RET
                                
       4644                     REM:
000644 4644 EB               4      EX  DE,HL
000645 4645 3E8F             7      LD  A,08FH          ;REM
000647 4647 C9              10      RET
                                
                                #if exists USE_RAM_BLOAD_S
                                ROM_BLOAD_SCREEN:
                                    LD  HL,(STREND)
                                    LD  (_DTA),HL
                                    EX  DE,HL
                                    LD  HL,-512
                                    ADD HL,SP
                                    XOR A
                                    SBC HL,DE
                                    JR  NC,RBS0
                                    LD  HL,BUF
                                    LD  (_DTA),HL
                                    LD  L,A ;0
                                    LD  H,A ;0
                                RBS0:
                                    INC H
                                    LD  (_BUF_EN),HL
                                RBS1:
                                    LD  HL,(_BUF_EN)
                                    CALL    ROM_READ
                                    LD  A,H
                                    OR  L
                                    JR  Z,ROM_NEXT
                                
                                    PUSH    HL
                                    LD  C,L
                                    LD  B,H
                                    LD  HL,(_DTA)   ;転送元
                                    LD  DE,(_BUF_ST)    ;転送先
                                
                                    LD  IY,(EXPTBL-1)   ;メインROMスロット
                                    LD  IX,LDIRVM
                                    CALL    _CALSLT
                                
                                    LD  HL,(_BUF_ST)
                                    POP DE
                                    ADD HL,DE
                                    LD  (_BUF_ST),HL
                                    JR  RBS1
                                #endif
                                
       4648                     ROM_RUN:
000648 4648 23               6      INC HL
000649 4649 7E               7      LD  A,(HL)
00064A 464A 2B               6      DEC HL
00064B 464B B7               4      OR  A
00064C 464C 2803            12      JR  Z,ROM_RUN1
00064E 464E CD2D45          17      CALL    ROM_LOAD
       4651                     ROM_RUN1:
000651 4651 3E8A             7      LD  A,08AH          ;RUN
000653 4653 77               7      LD  (HL),A
000654 4654 C9              10      RET
                                
       4655                     ROM_FILES:
000655 4655 CDAB46          17      CALL    INIT_PARAM
000658 4658 CD7647          17      CALL    FILE_B
00065B 465B CDD54C          17      CALL    GET_DISK_BANK_FDRV
00065E 465E 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000661 4661 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000664 4664 3A44F1          13      LD  A,(FNAME)
000667 4667 FE21             7      CP  021H
000669 4669 3005            12      JR  NC,RFILES0
00066B 466B 060B             7      LD  B,11
00066D 466D CD0A48          17      CALL    FILE10
       4670                     RFILES0:
000670 4670 CDFE4A          17      CALL    GET_DIR_DAT
       4673                     RFILES1:
000673 4673 CDD248          17      CALL    FILESE
000676 4676 302E            12      JR  NC,RFILES_NOT_MATCH
       4678                     RFILES_DISP:
000678 4678 E5              11      PUSH    HL
000679 4679 0608             7      LD  B,8
00067B 467B CD9443          17      CALL    MSN
00067E 467E 3E2E             7      LD  A,'.'
000680 4680 CD324D          17      CALL    MSG_A
000683 4683 0603             7      LD  B,3
000685 4685 CD9443          17      CALL    MSN
000688 4688 3ADDF3          13      LD  A,(CSRX)
00068B 468B 47               4      LD  B,A
00068C 468C 3AB0F3          13      LD  A,(LINLEN)
00068F 468F 90               4      SUB B
000690 4690 FE0C             7      CP  12
000692 4692 3009            12      JR  NC,RFILES2
000694 4694 3E0D             7      LD  A,00DH      ;改行
000696 4696 CD324D          17      CALL    MSG_A
000699 4699 3E0A             7      LD  A,00AH
00069B 469B 1802            12      JR  RFILES3
       469D                     RFILES2:
00069D 469D 3E20             7      LD  A,020H
       469F                     RFILES3:
00069F 469F CD324D          17      CALL    MSG_A
0006A2 46A2 E1              10      POP HL
0006A3 46A3 CDEE48          17      CALL    FNEXT
       46A6                     RFILES_NOT_MATCH:
0006A6 46A6 20CB            12      JR  NZ,RFILES1
0006A8 46A8 C31A46          10      JP  ROM_NEXT
                                
       46AB                     INIT_PARAM:
0006AB 46AB 223FF1          16      LD  (PARAM0),HL
0006AE 46AE 2241F1          16      LD  (PARAM1),HL
0006B1 46B1 EB               4      EX  DE,HL
0006B2 46B2 AF               4      XOR A
                                #if exists USE_RAM_BLOAD_S
                                #else
0006B3 46B3 3228F1          13      LD  (FLG_LDIR),A
                                #endif
0006B6 46B6 32BEFC          13      LD  (RUNBNF),A
0006B9 46B9 3263F6          13      LD  (VALTYP),A
0006BC 46BC 13               6      INC DE
0006BD 46BD CD4648          17      CALL    SPCUT
0006C0 46C0 1A               7      LD  A,(DE)
0006C1 46C1 B7               4      OR  A
0006C2 46C2 C8              11      RET Z
0006C3 46C3 FE3A             7      CP  ':'
0006C5 46C5 C8              11      RET Z
0006C6 46C6 EB               4      EX  DE,HL
0006C7 46C7 DD21644C        14      LD  IX,FRMEVL
0006CB 46CB FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
0006CF 46CF CD1C00          17      CALL    _CALSLT
0006D2 46D2 2241F1          16      LD  (PARAM1),HL
0006D5 46D5 C9              10      RET
                                
       46D6                     ROM_READ:
0006D6 46D6 E5              11      PUSH    HL
0006D7 46D7 D5              11      PUSH    DE
0006D8 46D8 C5              11      PUSH    BC
0006D9 46D9 FDE5            15      PUSH    IY
0006DB 46DB 223DF1          16      LD  (LEFTX),HL
0006DE 46DE 2A26F1          16      LD  HL,(_DTA)
0006E1 46E1 2237F1          16      LD  (DTAX),HL
0006E4 46E4 2A3DF1          16      LD  HL,(LEFTX)
                                
0006E7 46E7 CD3149          17      CALL    RBX1
0006EA 46EA 3870            12      JR  C,RBRERR1
0006EC 46EC 79               4      LD  A,C
0006ED 46ED EB               4      EX  DE,HL
0006EE 46EE ED52            15      SBC HL,DE       ;CP 0HL,CDE
0006F0 46F0 19              11      ADD HL,DE
0006F1 46F1 DE00             7      SBC A,000H
0006F3 46F3 3801            12      JR  C,RBR1
0006F5 46F5 EB               4      EX  DE,HL
       46F6                     RBR1:
0006F6 46F6 9F               4      SBC A,A
0006F7 46F7 E601             7      AND 1
0006F9 46F9 3216F1          13      LD  (_RESULT),A
0006FC 46FC 7C               4      LD  A,H
0006FD 46FD B5               4      OR  L
0006FE 46FE CA5247          10      JP  Z,RBREND0
                                
000701 4701 2222F1          16      LD  (_LEFT),HL  ;Read record byte
000704 4704 223DF1          16      LD  (LEFTX),HL
                                
000707 4707 CD5749          17      CALL    RBX2
00070A 470A 281A            12      JR  Z,RBRB
                                                ;先頭の端数
00070C 470C CD6A49          17      CALL    RBXA
00070F 470F DA6847          10      JP  C,RBRERR
000712 4712 C5              11      PUSH    BC
000713 4713 CD2F44          17      CALL    ROM_LDIR
000716 4716 ED5337F1        20      LD  (DTAX),DE
00071A 471A 2A3DF1          16      LD  HL,(LEFTX)
00071D 471D D1              10      POP DE
00071E 471E A7               4      AND A
00071F 471F ED52            15      SBC HL,DE
000721 4721 223DF1          16      LD  (LEFTX),HL
000724 4724 2829            12      JR  Z,RBREND
                                
       4726                     RBRB:
000726 4726 CDA649          17      CALL    RBXB
000729 4729 2818            12      JR  Z,RBRC
       472B                     RBRB1:
00072B 472B C5              11      PUSH    BC
00072C 472C D5              11      PUSH    DE
00072D 472D CD4E4A          17      CALL    CLUST
000730 4730 EB               4      EX  DE,HL
000731 4731 ED4B18F1        20      LD  BC,(CLSZ)       ;1クラスタのサイズ
000735 4735 CD2F44          17      CALL    ROM_LDIR
000738 4738 EB               4      EX  DE,HL
000739 4739 D1              10      POP DE
00073A 473A C1              10      POP BC
00073B 473B CD2B4A          17      CALL    GNCL
00073E 473E DA6847          10      JP  C,RBRERR
000741 4741 10E8            13      DJNZ    RBRB1
       4743                     RBRC:
000743 4743 CDBE49          17      CALL    RBXC
000746 4746 2807            12      JR  Z,RBREND
                                
000748 4748 CD4E4A          17      CALL    CLUST
00074B 474B EB               4      EX  DE,HL
00074C 474C CD2F44          17      CALL    ROM_LDIR
       474F                     RBREND:
00074F 474F CDCA49          17      CALL    RBXEND
       4752                     RBREND0:
000752 4752 FDE1            14      POP IY
000754 4754 C1              10      POP BC
000755 4755 D1              10      POP DE
000756 4756 F1              10      POP AF  ;(HL)
000757 4757 AF               4      XOR A
000758 4758 3A16F1          13      LD  A,(_RESULT)
00075B 475B C9              10      RET
                                
       475C                     RBRERR1:
00075C 475C 3E01             7      LD  A,001H
       475E                     RBRERR2:
00075E 475E FDE1            14      POP IY
000760 4760 C1              10      POP BC
000761 4761 D1              10      POP DE
000762 4762 E1              10      POP HL
000763 4763 37               4      SCF
000764 4764 210000          10      LD  HL,0
000767 4767 C9              10      RET
       4768                     RBRERR:
000768 4768 3EFF             7      LD  A,0FFH
00076A 476A 18F2            12      JR  RBRERR2
                                
       476C                     FILE_DD:
00076C 476C 3E                      DB  03EH
00076D 476D C9              10      RET
00076E 476E 3208F1          13      LD  (SWC_BLOAD_M),A
000771 4771 2A3FF1          16      LD  HL,(PARAM0)
000774 4774 7E               7      LD  A,(HL)
000775 4775 C9              10      RET
       4776                     FILE_B:
000776 4776 AF               4      XOR A
000777 4777 3243F1          13      LD  (FDRV),A
00077A 477A 1E00             7      LD  E,0
00077C 477C 3A63F6          13      LD  A,(VALTYP)
00077F 477F FE03             7      CP  3       ;string
000781 4781 2044            12      JR  NZ,FILED
                                
000783 4783 DD21D067        14      LD  IX,FRESTR
000787 4787 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
00078B 478B CD1C00          17      CALL    _CALSLT
00078E 478E E5              11      PUSH    HL
00078F 478F DDE1            14      POP IX
                                
000791 4791 DD5E00          19      LD  E,(IX+0)
000794 4794 DD7E01          19      LD  A,(IX+1)
000797 4797 DD5602          19      LD  D,(IX+2)
00079A 479A DD62             9      LD  IXH,D
00079C 479C DD6F             9      LD  IXL,A
00079E 479E 7B               4      LD  A,E
00079F 479F FE04             7      CP  4
0007A1 47A1 3808            12      JR  C,FILEB1
0007A3 47A3 DD7E03          19      LD  A,(IX+3)
0007A6 47A6 FE3A             7      CP  ':'
0007A8 47A8 28C2            12      JR  Z,FILE_DD
0007AA 47AA 7B               4      LD  A,E
       47AB                     FILEB1:
0007AB 47AB FE02             7      CP  2
0007AD 47AD 3818            12      JR  C,FILED
0007AF 47AF DD7E01          19      LD  A,(IX+1)
0007B2 47B2 FE3A             7      CP  ':'
0007B4 47B4 2011            12      JR  NZ,DEVI1
0007B6 47B6 DD7E00          19      LD  A,(IX+0)        ;DRIVE
0007B9 47B9 CDA048          17      CALL    CAP
0007BC 47BC D640             7      SUB '@'
0007BE 47BE DD23            10      INC IX
0007C0 47C0 DD23            10      INC IX
0007C2 47C2 1D               4      DEC E
0007C3 47C3 1D               4      DEC E
0007C4 47C4 3243F1          13      LD  (FDRV),A
       47C7                     DEVI1:
                                
       47C7                     FILED:
0007C7 47C7 CD0E48          17      CALL    FILEI
0007CA 47CA 2144F1          10      LD  HL,FNAME
                                
0007CD 47CD 0608             7      LD  B,8
       47CF                     FILE2:
0007CF 47CF CD1B48          17      CALL    CCHKF
0007D2 47D2 C8              11      RET Z
0007D3 47D3 FE2A             7      CP  '*'
0007D5 47D5 282E            12      JR  Z,FILE9
0007D7 47D7 FE2E             7      CP  '.'
0007D9 47D9 280C            12      JR  Z,FILE4
0007DB 47DB 77               7      LD  (HL),A
0007DC 47DC 23               6      INC HL
0007DD 47DD 10F0            13      DJNZ    FILE2
                                
       47DF                     FILE3:
0007DF 47DF CD1B48          17      CALL    CCHKF
0007E2 47E2 C8              11      RET Z
0007E3 47E3 FE2E             7      CP  '.'
0007E5 47E5 20F8            12      JR  NZ,FILE3
                                
       47E7                     FILE4:
0007E7 47E7 214CF1          10      LD  HL,FNAME+8
0007EA 47EA 0603             7      LD  B,3
                                
       47EC                     FILE4L:
0007EC 47EC CD1B48          17      CALL    CCHKF
0007EF 47EF C8              11      RET Z
0007F0 47F0 FE2E             7      CP  '.'
0007F2 47F2 2008            12      JR  NZ,FILE12
0007F4 47F4 3244F1          13      LD  (FNAME),A   ;Parent directory(..)
0007F7 47F7 3245F1          13      LD  (FNAME+1),A
0007FA 47FA 3E20             7      LD  A,020H
       47FC                     FILE12:
0007FC 47FC FE2A             7      CP  '*'
0007FE 47FE 280A            12      JR  Z,FILE10
000800 4800 77               7      LD  (HL),A
000801 4801 23               6      INC HL
000802 4802 10E8            13      DJNZ    FILE4L
000804 4804 C9              10      RET
                                
       4805                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000805 4805 CD0A48          17      CALL    FILE10
000808 4808 18D5            12      JR  FILE3
                                
       480A                     FILE10:
00080A 480A 3E3F             7      LD  A,'?'
00080C 480C 1808            12      JR  FILL_MEMORY
       480E                     FILEI:              ;名前＋拡張子をスペースで初期化
00080E 480E 3E20             7      LD  A,020H
000810 4810 01000B          10      LD  BC,11*256   ;C=0にしておく
000813 4813 2144F1          10      LD  HL,FNAME
       4816                     FILL_MEMORY:            ;HLからBバイトAで埋める
000816 4816 77               7      LD  (HL),A
000817 4817 23               6      INC HL
000818 4818 10FC            13      DJNZ    FILL_MEMORY
00081A 481A C9              10      RET
                                
       481B                     CCHKF:
00081B 481B 7B               4      LD  A,E
00081C 481C B7               4      OR  A
00081D 481D C8              11      RET Z
00081E 481E DD7E00          19      LD  A,(IX+0)
000821 4821 CD2848          17      CALL    CCHK2
000824 4824 C8              11      RET Z
000825 4825 C38B48          10      JP  FKAN
                                
       4828                     CCHK2:
000828 4828 0C               4      INC C
000829 4829 0D               4      DEC C
00082A 482A C0              11      RET NZ
       482B                     CCHK3:              ;ZF=1 で使えない文字
00082B 482B FE2B             7      CP  '+'
00082D 482D C8              11      RET Z
00082E 482E FE2C             7      CP  ','
000830 4830 C8              11      RET Z
000831 4831 FE2F             7      CP  '/'
000833 4833 C8              11      RET Z
000834 4834 FE3A             7      CP  ':'
000836 4836 C8              11      RET Z
000837 4837 FE3B             7      CP  ';'
000839 4839 C8              11      RET Z
00083A 483A FE3D             7      CP  '='
00083C 483C C8              11      RET Z
00083D 483D FE5C             7      CP  05CH    ;\
00083F 483F C8              11      RET Z
000840 4840 FE1F             7      CP  01FH
000842 4842 D0              11      RET NC
000843 4843 BF               4      CP  A       ;Z=1
000844 4844 C9              10      RET
                                
       4845                     SS1:
000845 4845 13               6      INC DE
       4846                     SPCUT:              ;スペースをカット
000846 4846 1A               7      LD  A,(DE)
000847 4847 FE20             7      CP  020H
000849 4849 28FA            12      JR  Z,SS1
00084B 484B C9              10      RET
                                
       484C                     SCREOF1:
00084C 484C 13               6      INC DE
       484D                     SPCUTEX:            ;スペース改行などをカット
00084D 484D 1A               7      LD  A,(DE)
00084E 484E FE20             7      CP  020H
000850 4850 28FA            12      JR  Z,SCREOF1
000852 4852 FE0D             7      CP  00DH
000854 4854 28F6            12      JR  Z,SCREOF1
000856 4856 FE0A             7      CP  00AH
000858 4858 28F2            12      JR  Z,SCREOF1
00085A 485A FE1A             7      CP  01AH
00085C 485C 28EE            12      JR  Z,SCREOF1
00085E 485E C9              10      RET
                                
       485F                     GETNUM:
00085F 485F 210000          10      LD  HL,0
       4862                     GETNUM1:
000862 4862 1A               7      LD  A,(DE)
000863 4863 13               6      INC DE
000864 4864 D630             7      SUB '0'
000866 4866 D8              11      RET C
000867 4867 FE0A             7      CP  10
000869 4869 D0              11      RET NC
00086A 486A 4D               4      LD  C,L
00086B 486B 44               4      LD  B,H
00086C 486C 29              11      ADD HL,HL   ;*2
00086D 486D 29              11      ADD HL,HL   ;*4
00086E 486E 09              11      ADD HL,BC   ;*5
00086F 486F 29              11      ADD HL,HL   ;*10
000870 4870 4F               4      LD  C,A
000871 4871 0600             7      LD  B,0
000873 4873 09              11      ADD HL,BC
000874 4874 18EC            12      JR  GETNUM1
                                
       4876                     SEARCH_END:
000876 4876 7E               7      LD  A,(HL)
       4877                     SEARCH_END1:
000877 4877 23               6      INC HL
000878 4878 B7               4      OR  A
000879 4879 C8              11      RET Z
00087A 487A FE3A             7      CP  ':'
00087C 487C 20F8            12      JR  NZ,SEARCH_END
00087E 487E 7E               7      LD  A,(HL)
00087F 487F FE3A             7      CP  ':'
000881 4881 28F4            12      JR  Z,SEARCH_END1
000883 4883 C9              10      RET
                                
       4884                     FKANC:
000884 4884 CB41             8      BIT 0,C
000886 4886 CCA948          17      CALL    Z,CAP2
000889 4889 1803            12      JR  FKANX
       488B                     FKAN:           ;漢字チェック
00088B 488B DD23            10      INC IX
00088D 488D 1D               4      DEC E
       488E                     FKANX:
00088E 488E CB41             8      BIT 0,C
000890 4890 CB81             8      RES 0,C
000892 4892 C0              11      RET NZ
000893 4893 FE80             7      CP  080H
000895 4895 D8              11      RET C
000896 4896 FEA0             7      CP  0A0H
000898 4898 3803            12      JR  C,FKAN1
00089A 489A FEE0             7      CP  0E0H
00089C 489C D8              11      RET C
       489D                     FKAN1:
00089D 489D 0C               4      INC C
00089E 489E A7               4      AND A
00089F 489F C9              10      RET
                                
       48A0                     CAP:
0008A0 48A0 FE61             7      CP  'a'
0008A2 48A2 D8              11      RET C
0008A3 48A3 FE7B             7      CP  'z'+1
0008A5 48A5 D0              11      RET NC
0008A6 48A6 D620             7      SUB 020H
0008A8 48A8 C9              10      RET
       48A9                     CAP2:
0008A9 48A9 CDA048          17      CALL    CAP
       48AC                     CAP3:               ;
0008AC 48AC FE05             7      CP  5
0008AE 48AE 2803            12      JR  Z,CAP4
0008B0 48B0 FE21             7      CP  021H
0008B2 48B2 C9              10      RET
       48B3                     CAP4:
0008B3 48B3 3EE5             7      LD  A,0E5H
0008B5 48B5 C9              10      RET
                                
       48B6                     ROM_OPEN:
0008B6 48B6 CDD54C          17      CALL    GET_DISK_BANK_FDRV
                                
0008B9 48B9 CDFE4A          17      CALL    GET_DIR_DAT
0008BC 48BC D5              11      PUSH    DE
0008BD 48BD CDD248          17      CALL    FILESE
0008C0 48C0 D1              10      POP DE
0008C1 48C1 3F               4      CCF
0008C2 48C2 D8              11      RET C
0008C3 48C3 223BF1          16      LD  (FCBX),HL
0008C6 48C6 E5              11      PUSH    HL
0008C7 48C7 210000          10      LD  HL,0
0008CA 48CA 221CF1          16      LD  (RR_LOW),HL
0008CD 48CD 221EF1          16      LD  (RR_HIGH),HL
0008D0 48D0 E1              10      POP HL
0008D1 48D1 C9              10      RET
                                
       48D2                     FILESE:
0008D2 48D2 7E               7      LD  A,(HL)
0008D3 48D3 B7               4      OR  A
0008D4 48D4 C8              11      RET Z       ;END:ZF=1 CF=0
0008D5 48D5 FEE5             7      CP  0E5H
0008D7 48D7 280D            12      JR  Z,FILESE1
0008D9 48D9 1144F1          10      LD  DE,FNAME
0008DC 48DC E5              11      PUSH    HL
0008DD 48DD CD0B49          17      CALL    CPFILE
0008E0 48E0 CC2C49          17      CALL    Z,CPFILE2
0008E3 48E3 E1              10      POP HL
0008E4 48E4 37               4      SCF
0008E5 48E5 C8              11      RET Z       ;!!!:(ZF=1) CF=1
       48E6                     FILESE1:
0008E6 48E6 CDEE48          17      CALL    FNEXT
0008E9 48E9 20E7            12      JR  NZ,FILESE
       48EB                     ZF0_CF0_AFF_RET:
0008EB 48EB F6FF             7      OR  0FFH        ;ZF=0 CF=0
0008ED 48ED C9              10      RET
                                
       48EE                     FNEXT:
0008EE 48EE 112000          10      LD  DE,020H
0008F1 48F1 19              11      ADD HL,DE
0008F2 48F2 0D               4      DEC C
                                #if exists USE_NORMAL_32K_ROM
                                #else
       48F3                     CHECK_DIR_PAGE:         ;ディレクトリが2ページ目に跨るかチェックする
0008F3 48F3 F5              11      PUSH    AF
0008F4 48F4 CB7C             8      BIT 7,H
0008F6 48F6 2811            12      JR  Z,CHECK_DIR_PAGE1
0008F8 48F8 7C               4      LD  A,H
0008F9 48F9 D620             7      SUB 020H
0008FB 48FB 67               4      LD  H,A
0008FC 48FC 3A17F1          13      LD  A,(_BANK)
0008FF 48FF 3C               4      INC A
000900 4900 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000903 4903 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000906 4906 3217F1          13      LD  (_BANK),A
       4909                     CHECK_DIR_PAGE1:
000909 4909 F1              10      POP AF
                                #endif
00090A 490A C9              10      RET
                                
       490B                     CPFILE:
00090B 490B C5              11      PUSH    BC
00090C 490C 01000B          10      LD  BC,00B00H
       490F                     CPSTR1:
00090F 490F 1A               7      LD  A,(DE)
000910 4910 FE3F             7      CP  '?'     ;Wild card
000912 4912 2812            12      JR  Z,CPSTR2
000914 4914 7E               7      LD  A,(HL)
000915 4915 CD8448          17      CALL    FKANC
000918 4918 E5              11      PUSH    HL
000919 4919 67               4      LD  H,A
00091A 491A 1A               7      LD  A,(DE)
00091B 491B CB01             4      RLC C
00091D 491D CD8448          17      CALL    FKANC
000920 4920 CB09             4      RRC C
000922 4922 BC               4      CP  H       ;CP (HL),(DE)
000923 4923 E1              10      POP HL
000924 4924 2004            12      JR  NZ,CPSTR3
       4926                     CPSTR2:
000926 4926 13               6      INC DE
000927 4927 23               6      INC HL
000928 4928 10E5            13      DJNZ    CPSTR1
       492A                     CPSTR3:
00092A 492A C1              10      POP BC
00092B 492B C9              10      RET
                                
       492C                     CPFILE2:
                                ;   LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
                                ;   OR  0E1H
00092C 492C 3EE1             7      LD  A,0E1H
00092E 492E 2F               4      CPL
00092F 492F A6               7      AND (HL)
000930 4930 C9              10      RET
                                
       4931                     RBX1:
000931 4931 E5              11      PUSH    HL      ;Record byte
                                
000932 4932 ED5B1CF1        20      LD  DE,(RR_LOW) ;CDE=Random record
000936 4936 3A1FF1          13      LD  A,(RR_HIGH+1)
000939 4939 4F               4      LD  C,A
                                
00093A 493A CDD54C          17      CALL    GET_DISK_BANK_FDRV
                                
00093D 493D FD2A3BF1        20      LD  IY,(FCBX)
000941 4941 FD6E1C          19      LD  L,(IY+01CH) ;AHL=File size
000944 4944 FD661D          19      LD  H,(IY+01DH)
000947 4947 FD7E1E          19      LD  A,(IY+01EH)
                                
00094A 494A A7               4      AND A
00094B 494B ED52            15      SBC HL,DE
00094D 494D 99               4      SBC A,C
00094E 494E D1              10      POP DE
                                
00094F 494F D8              11      RET C
000950 4950 4F               4      LD  C,A
000951 4951 EB               4      EX  DE,HL   ;CDE=File byte  HL=Record byte
000952 4952 B2               4      OR  D
000953 4953 B3               4      OR  E
000954 4954 C0              11      RET NZ
000955 4955 37               4      SCF
000956 4956 C9              10      RET
                                
       4957                     RBX2:
000957 4957 ED4B1DF1        20      LD  BC,(RR_LOW+1)
00095B 495B CDDF49          17      CALL    RWXR
00095E 495E 3A19F1          13      LD  A,(CLSZ_H)
000961 4961 3D               4      DEC A
000962 4962 E5              11      PUSH    HL
000963 4963 2A1CF1          16      LD  HL,(RR_LOW)
000966 4966 A4               4      AND H
000967 4967 B5               4      OR  L
000968 4968 E1              10      POP HL
000969 4969 C9              10      RET
                                
       496A                     RBXA:
00096A 496A D5              11      PUSH    DE
00096B 496B CD4E4A          17      CALL    CLUST
00096E 496E ED5324F1        20      LD  (_DTPS),DE
000972 4972 D1              10      POP DE
000973 4973 CD2B4A          17      CALL    GNCL
000976 4976 D8              11      RET C
000977 4977 ED5320F1        20      LD  (_CLPS),DE
                                
00097B 497B ED4B1CF1        20      LD  BC,(RR_LOW)
00097F 497F 2A18F1          16      LD  HL,(CLSZ)
000982 4982 7C               4      LD  A,H
000983 4983 3D               4      DEC A
000984 4984 A0               4      AND B
000985 4985 47               4      LD  B,A
000986 4986 ED42            15      SBC HL,BC       ;remaining cluster
                                
000988 4988 ED5B3DF1        20      LD  DE,(LEFTX)
00098C 498C ED52            15      SBC HL,DE       ;CP HL,DE
00098E 498E 19              11      ADD HL,DE
00098F 498F 3801            12      JR  C,RBXA1
000991 4991 EB               4      EX  DE,HL
       4992                     RBXA1:
000992 4992 3A17F1          13      LD  A,(_BANK)   ;GNCLでバンクを切り替えたのでデータのあるバンク
000995 4995 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000998 4998 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
00099B 499B E5              11      PUSH    HL
00099C 499C 2A24F1          16      LD  HL,(_DTPS)
00099F 499F 09              11      ADD HL,BC
0009A0 49A0 ED5B37F1        20      LD  DE,(DTAX)
0009A4 49A4 C1              10      POP BC
0009A5 49A5 C9              10      RET
                                
       49A6                     RBXB:
0009A6 49A6 2A37F1          16      LD  HL,(DTAX)
0009A9 49A9 ED5B20F1        20      LD  DE,(_CLPS)
0009AD 49AD 3A3EF1          13      LD  A,(LEFTX+1)
0009B0 49B0 47               4      LD  B,A
0009B1 49B1 3A19F1          13      LD  A,(CLSZ_H)  ;1024=4 / 512=2 / 256=1
       49B4                     RBXB1:
0009B4 49B4 1F               4      RRA     ;->CF
0009B5 49B5 3804            12      JR  C,RBXB2
0009B7 49B7 CB38             8      SRL B   ;B=B/2
0009B9 49B9 18F9            12      JR  RBXB1
       49BB                     RBXB2:
0009BB 49BB 78               4      LD  A,B
0009BC 49BC B7               4      OR  A
0009BD 49BD C9              10      RET
                                
       49BE                     RBXC:
0009BE 49BE ED4B3DF1        20      LD  BC,(LEFTX)
0009C2 49C2 3A19F1          13      LD  A,(CLSZ_H)
0009C5 49C5 3D               4      DEC A
0009C6 49C6 A0               4      AND B
0009C7 49C7 47               4      LD  B,A
0009C8 49C8 B1               4      OR  C
0009C9 49C9 C9              10      RET
                                
       49CA                     RBXEND:
0009CA 49CA ED5B22F1        20      LD  DE,(_LEFT)
0009CE 49CE 2A1CF1          16      LD  HL,(RR_LOW)
0009D1 49D1 3A1FF1          13      LD  A,(RR_HIGH+1)
0009D4 49D4 19              11      ADD HL,DE
0009D5 49D5 CE00             7      ADC A,0
0009D7 49D7 221CF1          16      LD  (RR_LOW),HL
0009DA 49DA 321FF1          13      LD  (RR_HIGH+1),A
0009DD 49DD EB               4      EX  DE,HL       ;HL=Read byte
0009DE 49DE C9              10      RET 
                                
       49DF                     RWXR:
0009DF 49DF 3A19F1          13      LD  A,(CLSZ_H)  ;1024=4 / 512=2 / 256=1
       49E2                     L_RWX:
0009E2 49E2 1F               4      RRA     ;->CF
0009E3 49E3 3806            12      JR  C,E_RWX
0009E5 49E5 CB38             8      SRL B   ;BC=BC/2
0009E7 49E7 CB19             8      RR  C   ;
0009E9 49E9 18F7            12      JR  L_RWX
       49EB                     E_RWX:
0009EB 49EB CDD54C          17      CALL    GET_DISK_BANK_FDRV
                                
0009EE 49EE FD2A3BF1        20      LD  IY,(FCBX)
0009F2 49F2 FD5E1A          19      LD  E,(IY+01AH) ;ファイルの先頭クラスタ
0009F5 49F5 FD561B          19      LD  D,(IY+01BH)
       49F8                     RWX1:
0009F8 49F8 ED5320F1        20      LD  (_CLPS),DE
0009FC 49FC 7A               4      LD  A,D
0009FD 49FD B3               4      OR  E
0009FE 49FE 37               4      SCF
0009FF 49FF C8              11      RET Z
                                
000A00 4A00 78               4      LD  A,B
000A01 4A01 B1               4      OR  C
000A02 4A02 C8              11      RET Z
                                
000A03 4A03 CD2B4A          17      CALL    GNCL
000A06 4A06 D8              11      RET C
000A07 4A07 0B               6      DEC BC
000A08 4A08 CD974A          17      CALL    ENDCL
000A0B 4A0B 38EB            12      JR  C,RWX1
000A0D 4A0D 37               4      SCF
000A0E 4A0E C9              10      RET
                                
       4A0F                     NCL3:
000A0F 4A0F CDD54C          17      CALL    GET_DISK_BANK_FDRV
000A12 4A12 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000A15 4A15 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000A18 4A18 6B               4      LD  L,E
000A19 4A19 62               4      LD  H,D
000A1A 4A1A CB3C             8      SRL H
000A1C 4A1C CB1D             8      RR  L
000A1E 4A1E 1F               4      RRA
000A1F 4A1F 19              11      ADD HL,DE
000A20 4A20 010060          10      LD  BC,BANK1_ADR
000A23 4A23 09              11      ADD HL,BC
000A24 4A24 ED4B1AF1        20      LD  BC,(SECSZ)
000A28 4A28 09              11      ADD HL,BC
000A29 4A29 17               4      RLA
000A2A 4A2A C9              10      RET
                                
       4A2B                     GNCL:
000A2B 4A2B 7A               4      LD  A,D
000A2C 4A2C B3               4      OR  E
000A2D 4A2D 37               4      SCF
000A2E 4A2E C8              11      RET Z
000A2F 4A2F C5              11      PUSH    BC
000A30 4A30 E5              11      PUSH    HL
000A31 4A31 CD0F4A          17      CALL    NCL3
000A34 4A34 3809            12      JR  C,GNC1
000A36 4A36 5E               7      LD  E,(HL)
000A37 4A37 23               6      INC HL
000A38 4A38 7E               7      LD  A,(HL)
000A39 4A39 E60F             7      AND 00FH
000A3B 4A3B 57               4      LD  D,A
000A3C 4A3C E1              10      POP HL
000A3D 4A3D C1              10      POP BC
000A3E 4A3E C9              10      RET
       4A3F                     GNC1:
000A3F 4A3F 7E               7      LD  A,(HL)
000A40 4A40 23               6      INC HL
000A41 4A41 56               7      LD  D,(HL)
000A42 4A42 0604             7      LD  B,4
       4A44                     GNC1L:
000A44 4A44 CB3A             8      SRL D
000A46 4A46 1F               4      RRA
000A47 4A47 10FB            13      DJNZ    GNC1L
                                
000A49 4A49 5F               4      LD  E,A
000A4A 4A4A E1              10      POP HL
000A4B 4A4B C1              10      POP BC
000A4C 4A4C A7               4      AND A
000A4D 4A4D C9              10      RET
                                
       4A4E                     CLUST:
000A4E 4A4E EB               4      EX  DE,HL
000A4F 4A4F C5              11      PUSH    BC
000A50 4A50 3A19F1          13      LD  A,(CLSZ_H)
000A53 4A53 CD014D          17      CALL    MUL_AHL
                                
000A56 4A56 CD0E4B          17      CALL    GET_DIR_POS
000A59 4A59 4F               4      LD  C,A
000A5A 4A5A 0600             7      LD  B,0
000A5C 4A5C 09              11      ADD HL,BC
                                
000A5D 4A5D 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt
000A60 4A60 0F               4      RRCA
000A61 4A61 0F               4      RRCA
000A62 4A62 0F               4      RRCA
000A63 4A63 0F               4      RRCA
000A64 4A64 4F               4      LD  C,A
                                
000A65 4A65 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus
000A68 4A68 FE02             7      CP  2
000A6A 4A6A 280C            12      JR  Z,CLUST1
000A6C 4A6C CB01             4      RLC C
000A6E 4A6E 0D               4      DEC C
000A6F 4A6F 3A0C60          13      LD  A,(BANK1_ADR+11+1)  ;BPB_BytsPerSec High    
000A72 4A72 FE02             7      CP  2
000A74 4A74 2002            12      JR  NZ,CLUST1
000A76 4A76 0D               4      DEC C
000A77 4A77 0D               4      DEC C
       4A78                     CLUST1:
000A78 4A78 0D               4      DEC C
000A79 4A79 09              11      ADD HL,BC
                                
                                #if exists USE_NORMAL_32K_ROM
                                    LD  A,L
                                #else
000A7A 4A7A E5              11      PUSH    HL
000A7B 4A7B 29              11      ADD HL,HL   ;*2
000A7C 4A7C 29              11      ADD HL,HL   ;*4
000A7D 4A7D 29              11      ADD HL,HL   ;*8
000A7E 4A7E CDD54C          17      CALL    GET_DISK_BANK_FDRV
000A81 4A81 84               4      ADD A,H
000A82 4A82 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000A85 4A85 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000A88 4A88 3217F1          13      LD  (_BANK),A
000A8B 4A8B E1              10      POP HL
000A8C 4A8C 3E1F             7      LD  A,01FH          ;セグメントのサイズでフィルタする(8K:1F)
000A8E 4A8E A5               4      AND L
                                #endif
000A8F 4A8F C660             7      ADD A,high BANK1_ADR
000A91 4A91 67               4      LD  H,A
000A92 4A92 2E00             7      LD  L,0
000A94 4A94 EB               4      EX  DE,HL
000A95 4A95 C1              10      POP BC
000A96 4A96 C9              10      RET
                                
       4A97                     ENDCL:
000A97 4A97 7A               4      LD  A,D ;END CLUSTER
000A98 4A98 FE0F             7      CP  00FH    ;FAT12の最大値
000A9A 4A9A C0              11      RET NZ
000A9B 4A9B 7B               4      LD  A,E
000A9C 4A9C FEF7             7      CP  0F7H
000A9E 4A9E C9              10      RET
                                
       4A9F                     RB_READ:
000A9F 4A9F AF               4      XOR A   ;HLA = HL*128
000AA0 4AA0 CB3C             8      SRL H
000AA2 4AA2 CB1D             8      RR  L
000AA4 4AA4 1F               4      RRA
000AA5 4AA5 321CF1          13      LD  (RR_LOW),A
000AA8 4AA8 221DF1          16      LD  (RR_MID),HL
000AAB 4AAB 218000          10      LD  HL,128
                                
000AAE 4AAE CDD646          17      CALL    ROM_READ
000AB1 4AB1 C9              10      RET
                                
       4AB2                     GETSEQ:
000AB2 4AB2 FD6E20          19      LD  L,(IY+32)
000AB5 4AB5 FD660C          19      LD  H,(IY+12)
                                
000AB8 4AB8 CB25             8      SLA L
                                
000ABA 4ABA CB3C             8      SRL H
000ABC 4ABC CB1D             8      RR  L
000ABE 4ABE C9              10      RET
                                
       4ABF                     SETSEQ:
000ABF 4ABF F5              11      PUSH    AF
000AC0 4AC0 3A1CF1          13      LD  A,(RR_LOW)
000AC3 4AC3 2A1DF1          16      LD  HL,(RR_MID)
                                
000AC6 4AC6 CDDD4A          17      CALL    SSQ1
                                
000AC9 4AC9 29              11      ADD HL,HL
000ACA 4ACA CB3D             8      SRL L
000ACC 4ACC FD7520          19      LD  (IY+32),L
000ACF 4ACF FD740C          19      LD  (IY+12),H
000AD2 4AD2 F1              10      POP AF
000AD3 4AD3 C9              10      RET
                                
       4AD4                     GETSIZE:
000AD4 4AD4 FD7E10          19      LD  A,(IY+16)
000AD7 4AD7 FD6E11          19      LD  L,(IY+17)
000ADA 4ADA FD6612          19      LD  H,(IY+18)
       4ADD                     SSQ1:
000ADD 4ADD 87               4      ADD A,A
000ADE 4ADE ED6A            15      ADC HL,HL
000AE0 4AE0 B7               4      OR  A
000AE1 4AE1 C8              11      RET Z
000AE2 4AE2 23               6      INC HL
000AE3 4AE3 C9              10      RET
                                
       4AE4                     SET_FCB:
000AE4 4AE4 D5              11      PUSH    DE
000AE5 4AE5 FDE1            14      POP IY
000AE7 4AE7 FD7E1C          19      LD  A,(IY+28)
000AEA 4AEA FEFF             7      CP  0FFH
000AEC 4AEC 200C            12      JR  NZ,POPAF_SCF_FF_RET
000AEE 4AEE E5              11      PUSH    HL
000AEF 4AEF FD6E1A          19      LD  L,(IY+26)
000AF2 4AF2 FD661B          19      LD  H,(IY+27)
000AF5 4AF5 2220F1          16      LD  (_CLPS),HL
000AF8 4AF8 E1              10      POP HL
000AF9 4AF9 C9              10      RET
                                
       4AFA                     POPAF_SCF_FF_RET:
000AFA 4AFA F1              10      POP AF
000AFB 4AFB 37               4      SCF
000AFC 4AFC 9F               4      SBC A,A
000AFD 4AFD C9              10      RET
                                
       4AFE                     GET_DIR_DAT:
000AFE 4AFE CD0E4B          17      CALL    GET_DIR_POS
000B01 4B01 C660             7      ADD A,high BANK1_ADR
000B03 4B03 2E00             7      LD  L,0
000B05 4B05 67               4      LD  H,A         ;HL=BANK1_ADR+(BPB_RsvdSecCnt+BPB_FATSz16*BPB_NumFATs)*BPB_BytsPerSec
                                #if exists USE_NORMAL_32K_ROM
                                #else
000B06 4B06 CDF348          17      CALL    CHECK_DIR_PAGE
                                #endif
000B09 4B09 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt
000B0C 4B0C 4F               4      LD  C,A
000B0D 4B0D C9              10      RET
                                
       4B0E                     GET_DIR_POS:
000B0E 4B0E CDD54C          17      CALL    GET_DISK_BANK_FDRV
000B11 4B11 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000B14 4B14 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000B17 4B17 3217F1          13      LD  (_BANK),A
000B1A 4B1A 3A1060          13      LD  A,(BANK1_ADR+16)    ;BPB_NumFATs
000B1D 4B1D 47               4      LD  B,A
000B1E 4B1E 3A1660          13      LD  A,(BANK1_ADR+22)    ;BPB_FATSz16
000B21 4B21 4F               4      LD  C,A
000B22 4B22 3A0E60          13      LD  A,(BANK1_ADR+14)    ;BPB_RsvdSecCnt
       4B25                     GET_DIR_POS1:
000B25 4B25 81               4      ADD A,C
000B26 4B26 10FD            13      DJNZ    GET_DIR_POS1
                                
000B28 4B28 ED4B0B60        20      LD  BC,(BANK1_ADR+11)   ;BPB_BytsPerSec 
       4B2C                     L_MDP:
000B2C 4B2C CB18             8      RR  B   ;->CF
000B2E 4B2E D8              11      RET C
000B2F 4B2F 87               4      ADD A,A
000B30 4B30 18FA            12      JR  L_MDP
                                
       4B32                     WILDCARD:
000B32 4B32 3F3F3F3F3F3F3F3F        DB  "???????????"
            3F3F3F              
[EOF:FILE.ASM:UTF_8]
                                    INCLUDE "DISK.ASM"
                                
                                ;   Tablacus DISK ROM - DISK
                                
                                ;   ROM DISK DRIVER
                                ;   1セクタ512
                                
       4B3D                     ERROR_WRITE_PROTECTED:
000B3D 4B3D 3E00             7      LD  A,0     ;Write protected
000B3F 4B3F C9              10      RET
       4B40                     DISKIO:
000B40 4B40 38FB            12      JR  C,ERROR_WRITE_PROTECTED
000B42 4B42 48               4      LD  C,B
000B43 4B43 CDDF4C          17      CALL    GET_DISK_BANK
       4B46                     SETMAP1:        
000B46 4B46 E5              11      PUSH    HL
       4B47                     DISKIO1:
000B47 4B47 C5              11      PUSH    BC      ;B=残りのセクタ数
000B48 4B48 D5              11      PUSH    DE      ;DE=セクタ番号
000B49 4B49 F5              11      PUSH    AF      ;A=8KB単位でカートリッジ内のディスクが存在する位置を指定
                                
000B4A 4B4A EB               4      EX  DE,HL       ;DE=受け取る読み出し先のメモリアドレス HL=セクタ番号
000B4B 4B4B F5              11      PUSH    AF
000B4C 4B4C 3A1BF1          13      LD  A,(SECSZ_H)
000B4F 4B4F CD014D          17      CALL    MUL_AHL
000B52 4B52 F1              10      POP AF
000B53 4B53 4D               4      LD  C,L     ;C=読み出し元
000B54 4B54 29              11      ADD HL,HL       ;64KB→32KB
000B55 4B55 29              11      ADD HL,HL       ;32KB→16KB
000B56 4B56 29              11      ADD HL,HL       ;16KB→8KB  バンク切り替えのサイズに合わせる
000B57 4B57 84               4      ADD A,H
000B58 4B58 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000B5B 4B5B 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000B5E 4B5E 3217F1          13      LD  (_BANK),A
000B61 4B61 79               4      LD  A,C     ;C=読み出し元
000B62 4B62 E61F             7      AND 01FH        ;セグメントのサイズでフィルタする(8K:1F)
000B64 4B64 C660             7      ADD A,high BANK1_ADR
000B66 4B66 67               4      LD  H,A
000B67 4B67 ED4B1AF1        20      LD  BC,(SECSZ)  ;BCは読み出すセクタサイズ
000B6B 4B6B 69               4      LD  L,C     ;C=0
000B6C 4B6C EDB0                    LDIR
000B6E 4B6E EB               4      EX  DE,HL
000B6F 4B6F F1              10      POP AF
000B70 4B70 D1              10      POP DE
000B71 4B71 13               6      INC DE
000B72 4B72 C1              10      POP BC
000B73 4B73 10D2            13      DJNZ    DISKIO1
000B75 4B75 41               4      LD  B,C
                                
000B76 4B76 E1              10      POP HL
000B77 4B77 AF               4      XOR A
000B78 4B78 FB               4      EI
000B79 4B79 C9              10      RET
                                
       4B7A                     DSKCHG:
000B7A 4B7A CDB34B          17      CALL    IS_BPB
000B7D 4B7D 3824            12      JR  C,NOTREADY
000B7F 4B7F 3A23FB          13      LD  A,(DRVTBL+2)
000B82 4B82 B7               4      OR  A
000B83 4B83 201A            12      JR  NZ,DSKCHG1
000B85 4B85 3A21FB          13      LD  A,(DRVTBL)
000B88 4B88 FE02             7      CP  2
000B8A 4B8A 2013            12      JR  NZ,DSKCHG1
000B8C 4B8C CDB34B          17      CALL    IS_BPB
000B8F 4B8F 300E            12      JR  NC,DSKCHG1
000B91 4B91 3E01             7      LD  A,1         ;ドライブテーブルを拡張 A:Tablacus DISK ROM B:MASTER SLOT ROM
000B93 4B93 3221FB          13      LD  (DRVTBL),A
000B96 4B96 3223FB          13      LD  (DRVTBL+2),A
000B99 4B99 3A48F3          13      LD  A,(MASTERS)
000B9C 4B9C 3224FB          13      LD  (DRVTBL+3),A
       4B9F                     DSKCHG1:
000B9F 4B9F AF               4      XOR A
000BA0 4BA0 0601             7      LD  B,1
000BA2 4BA2 C9              10      RET
       4BA3                     NOTREADY:
000BA3 4BA3 3E02             7      LD  A,2
000BA5 4BA5 37               4      SCF
000BA6 4BA6 C9              10      RET
                                
       4BA7                     NO_BPB:
000BA7 4BA7 E1              10      POP HL
000BA8 4BA8 23               6      INC HL
000BA9 4BA9 11064D          10      LD  DE,DPB2DD
000BAC 4BAC 011200          10      LD  BC,DPB2DD_E-DPB2DD
000BAF 4BAF EDB0                    LDIR
000BB1 4BB1 AF               4      XOR A
000BB2 4BB2 C9              10      RET
                                
       4BB3                     IS_BPB:
                                ; in
                                ; A=DRIVE 0:A 1:B
                                ; out
                                ; CF=0ディスクは存在する CF=1 ディスクは存在しない
000BB3 4BB3 CDDF4C          17      CALL    GET_DISK_BANK
                                
000BB6 4BB6 3A1560          13      LD  A,(BANK1_ADR+21)    ;BPB_Media
000BB9 4BB9 FE01             7      CP  1
000BBB 4BBB D8              11      RET C
                                
000BBC 4BBC 3A0B60          13      LD  A,(BANK1_ADR+11)    ;BPB_BytsPerSec
000BBF 4BBF C6FF             7      ADD A,0FFH
000BC1 4BC1 D8              11      RET C
                                
000BC2 4BC2 3A0C60          13      LD  A,(BANK1_ADR+12)    ;BPB_BytsPerSec
000BC5 4BC5 FE01             7      CP  1
000BC7 4BC7 C8              11      RET Z
000BC8 4BC8 FE02             7      CP  2
000BCA 4BCA C8              11      RET Z
000BCB 4BCB FE04             7      CP  4
000BCD 4BCD C8              11      RET Z
000BCE 4BCE 37               4      SCF
000BCF 4BCF C9              10      RET
                                
       4BD0                     GETDPB:
000BD0 4BD0 E5              11      PUSH    HL
000BD1 4BD1 CDDF4C          17      CALL    GET_DISK_BANK
                                
000BD4 4BD4 3A1560          13      LD  A,(BANK1_ADR+21)    ;BPB_Media  
000BD7 4BD7 B7               4      OR  A
000BD8 4BD8 28CD            12      JR  Z,NO_BPB
000BDA 4BDA DDE1            14      POP IX
000BDC 4BDC DD7701          19      LD  (IX+1),A        ;MEDIA
                                
000BDF 4BDF 3A0B60          13      LD  A,(BANK1_ADR+11)    ;BPB_BytsPerSec 
000BE2 4BE2 DD7702          19      LD  (IX+2),A        ;SECSIZ LOW
                                
000BE5 4BE5 3A0C60          13      LD  A,(BANK1_ADR+12)    ;BPB_BytsPerSec 
000BE8 4BE8 DD7703          19      LD  (IX+3),A        ;SECSIZ HIGH
                                
000BEB 4BEB 87               4      ADD A,A
000BEC 4BEC 87               4      ADD A,A
000BED 4BED 87               4      ADD A,A
000BEE 4BEE 3D               4      DEC A
000BEF 4BEF DD7704          19      LD  (IX+4),A        ;DIRMSK
                                
000BF2 4BF2 06FF             7      LD  B,-1
000BF4 4BF4 A7               4      AND A           ;無限ループ阻止
       4BF5                     GETDPB1:
000BF5 4BF5 04               4      INC B
000BF6 4BF6 1F               4      RRA
000BF7 4BF7 38FC            12      JR  C,GETDPB1
000BF9 4BF9 DD7005          19      LD  (IX+5),B        ;DIRSHFT
                                
000BFC 4BFC 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus
000BFF 4BFF 3D               4      DEC A
000C00 4C00 DD7706          19      LD  (IX+6),A        ;CLUSMSK
                                
000C03 4C03 A7               4      AND A           ;無限ループ阻止
000C04 4C04 06FF             7      LD  B,-1
       4C06                     GETDPB2:
000C06 4C06 04               4      INC B
000C07 4C07 1F               4      RRA
000C08 4C08 38FC            12      JR  C,GETDPB2
000C0A 4C0A 04               4      INC B
000C0B 4C0B DD7007          19      LD  (IX+7),B        ;CLUSSHFT
                                
000C0E 4C0E 2A0E60          16      LD  HL,(BANK1_ADR+14)   ;BPB_RsvdSecCnt 
000C11 4C11 DD7508          19      LD  (IX+8),L        ;FIRFAT LOW
000C14 4C14 DD7409          19      LD  (IX+9),H        ;FIRFAT HIGH
                                
000C17 4C17 3A1060          13      LD  A,(BANK1_ADR+16)    ;BPB_NumFATs    
000C1A 4C1A DD770A          19      LD  (IX+10),A       ;FATCNT
                                
000C1D 4C1D 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt 
000C20 4C20 DD770B          19      LD  (IX+11),A       ;FATCNT
                                
000C23 4C23 ED5B1660        20      LD  DE,(BANK1_ADR+22)   ;BPB_FATSz16    
000C27 4C27 DD7310          19      LD  (IX+16),E       ;FATSIZ
                                
000C2A 4C2A DD460A          19      LD  B,(IX+10)       ;FATCNT
000C2D 4C2D 210000          10      LD  HL,0
       4C30                     GETDPB3:
000C30 4C30 19              11      ADD HL,DE
000C31 4C31 10FD            13      DJNZ    GETDPB3
       4C33                     GETDPB4:
000C33 4C33 DD5E08          19      LD  E,(IX+8)        ;FIRFAT
000C36 4C36 DD5609          19      LD  D,(IX+9)        ;FIRFAT
000C39 4C39 19              11      ADD HL,DE
000C3A 4C3A DD7511          19      LD  (IX+17),L       ;FIRDIR
000C3D 4C3D DD7412          19      LD  (IX+18),H       ;FIRDIR
                                
000C40 4C40 DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
000C43 4C43 87               4      ADD A,A
000C44 4C44 87               4      ADD A,A
000C45 4C45 DD5E0B          19      LD  E,(IX+11)       ;MAXENT
       4C48                     GETDPB5:
000C48 4C48 CB3B             8      SRL E
000C4A 4C4A 1F               4      RRA
000C4B 4C4B 30FB            12      JR  NC,GETDPB5
000C4D 4C4D 1600             7      LD  D,0
000C4F 4C4F 19              11      ADD HL,DE
000C50 4C50 DD750C          19      LD  (IX+12),L       ;FIRREC
000C53 4C53 DD740D          19      LD  (IX+13),H       ;FIRREC
                                
000C56 4C56 2A1360          16      LD  HL,(BANK1_ADR+19)   ;BPB_TotSec16   
                                
000C59 4C59 DD5E0C          19      LD  E,(IX+12)       ;FIRREC
000C5C 4C5C DD560D          19      LD  D,(IX+13)       ;FIRREC
000C5F 4C5F A7               4      AND A
000C60 4C60 ED52            15      SBC HL,DE
                                
000C62 4C62 DD7E06          19      LD  A,(IX+6)        ;CLUSMSK
000C65 4C65 3C               4      INC A
000C66 4C66 37               4      SCF             ;無限ループ阻止
       4C67                     GETDPB6:
000C67 4C67 1F               4      RRA
000C68 4C68 3806            12      JR  C,GETDPB7
000C6A 4C6A CB3C             8      SRL H
000C6C 4C6C CB1D             8      RR  L
000C6E 4C6E 18F7            12      JR  GETDPB6
       4C70                     GETDPB7:
000C70 4C70 23               6      INC HL
000C71 4C71 DD750E          19      LD  (IX+14),L       ;MAXCLUS
000C74 4C74 DD740F          19      LD  (IX+15),H       ;MAXCLUS
                                
                                    ;1セクタが512バイト以上の場合を考慮(2HD/1セクタ1024バイト/1.23MB等)
       4C77                     GETDPBD1:
000C77 4C77 DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
000C7A 4C7A E6FC             7      AND 0FCH
000C7C 4C7C C8              11      RET Z
                                
000C7D 4C7D DDCB033E        23      SRL (IX+3)          ;SECSIZ HIGH
                                
000C81 4C81 37               4      SCF
000C82 4C82 DDCB0616        23      RL  (IX+6)          ;CLUSMSK
                                
000C86 4C86 DD3407          23      INC (IX+7)          ;CLUSSHFT
                                
000C89 4C89 DDCB0826        23      SLA (IX+8)          ;FIRFAT LOW
000C8D 4C8D DDCB0916        23      RL  (IX+9)          ;FIRFAT HIGH
                                
000C91 4C91 DDCB0E25        23      SLA (IX+14),L       ;MAXCLUS
000C95 4C95 DDCB0F14        23      RL  (IX+15),H       ;MAXCLUS
                                
000C99 4C99 DDCB1026        23      SLA (IX+16)         ;FATSIZ
                                
000C9D 4C9D DDCB1126        23      SLA (IX+17)         ;FIRDIR
000CA1 4CA1 DDCB1216        23      RL  (IX+18)         ;FIRDIR
                                
000CA5 4CA5 DD6E11          19      LD  L,(IX+17)       ;FIRDIR
000CA8 4CA8 DD6612          19      LD  H,(IX+18)       ;FIRDIR
                                
000CAB 4CAB DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
000CAE 4CAE 87               4      ADD A,A
000CAF 4CAF 87               4      ADD A,A
000CB0 4CB0 DD5E0B          19      LD  E,(IX+11)       ;MAXENT
       4CB3                     GETDPBD5:
000CB3 4CB3 CB3B             8      SRL E
000CB5 4CB5 1F               4      RRA
000CB6 4CB6 30FB            12      JR  NC,GETDPBD5
000CB8 4CB8 1600             7      LD  D,0
000CBA 4CBA 19              11      ADD HL,DE
000CBB 4CBB DD750C          19      LD  (IX+12),L       ;FIRREC
000CBE 4CBE DD740D          19      LD  (IX+13),H       ;FIRREC
                                
000CC1 4CC1 18B4            12      JR  GETDPBD1
                                
       4CC3                     CHOICE:
000CC3 4CC3 210000          10      LD  HL,0
000CC6 4CC6 C9              10      RET
                                
       4CC7                     DSKFMT:
000CC7 4CC7 AF               4      XOR A
000CC8 4CC8 37               4      SCF
       4CC9                     DSKSTP:
000CC9 4CC9 C9              10      RET
                                
       4CCA                     BASENT:
000CCA 4CCA ED7B4FF1        20      LD  SP,(BASSTK)
000CCE 4CCE C3C343          10      JP  BASAUTO
                                
       4CD1                     GETSLT:
000CD1 4CD1 3A22FB          13      LD  A,(DRVTBL+1)
000CD4 4CD4 C9              10      RET
                                
       4CD5                     GET_DISK_BANK_FDRV:
000CD5 4CD5 3A43F1          13      LD  A,(FDRV)
000CD8 4CD8 D601             7      SUB 1
000CDA 4CDA 3003            12      JR  NC,GET_DISK_BANK
000CDC 4CDC 3A3AF1          13      LD  A,(_DVSW)
       4CDF                     GET_DISK_BANK:
000CDF 4CDF B7               4      OR  A       ;A=DRIVE
000CE0 4CE0 3E01             7      LD  A,DISK_BANK
000CE2 4CE2 2803            12      JR  Z,SET_DISK_BANK
                                #if exists FIX_DRIVE
                                    LD  A,FIX_DRIVE
                                #else
000CE4 4CE4 3A39F1          13      LD  A,(B_DRIVE)
                                #endif
       4CE7                     SET_DISK_BANK:
000CE7 4CE7 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000CEA 4CEA 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000CED 4CED F5              11      PUSH    AF
000CEE 4CEE E5              11      PUSH    HL
000CEF 4CEF 2A0B60          16      LD  HL,(BANK1_ADR+11)   ;BPB_BytsPerSec 
000CF2 4CF2 221AF1          16      LD  (SECSZ),HL
000CF5 4CF5 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus
000CF8 4CF8 CD014D          17      CALL    MUL_AHL
000CFB 4CFB 2218F1          16      LD  (CLSZ),HL
000CFE 4CFE E1              10      POP HL
000CFF 4CFF F1              10      POP AF
000D00 4D00 C9              10      RET
                                
                                ;   HL = HL * A ただし、A=1,2,4,8,16,32,64,128(2のべき乗に限る)
       4D01                     MUL_AHL:
000D01 4D01 1F               4      RRA     ;->CF
000D02 4D02 D8              11      RET C
000D03 4D03 29              11      ADD HL,HL
000D04 4D04 18FB            12      JR  MUL_AHL
                                
       4D06                     DPB2DD:
000D06 4D06 F9                      DB  0F9H    ;MEDIA
000D07 4D07 0002                    DW  00200H  ;SECSIZ
000D09 4D09 0F                      DB  00FH    ;DIRMSK
000D0A 4D0A 04                      DB  004H    ;DIRSHFT
000D0B 4D0B 01                      DB  001H    ;CLUSMSK
000D0C 4D0C 02                      DB  002H    ;CLUSSHFT
000D0D 4D0D 0100                    DW  00001H  ;FIRFAT
000D0F 4D0F 02                      DB  002H    ;FATCNT
000D10 4D10 70                      DB  070H    ;MAXENT
000D11 4D11 0E00                    DW  0000EH  ;FIRREC
000D13 4D13 CA02                    DW  002CAH  ;MAXCLUS
000D15 4D15 03                      DB  003H    ;FATSIZ
000D16 4D16 0700                    DW  0007H   ;FIRDIR
       4D18                     DPB2DD_E:
                                
[EOF:DISK.ASM:UTF_8]
                                    INCLUDE "BDOS.ASM"
       4D18                     POP_HL_ERROR:
000D18 4D18 E1              10      POP     HL
       4D19                     _ERROR:
000D19 4D19 0600             7      LD  B,0
000D1B 4D1B A7               4      AND A
000D1C 4D1C C9              10      RET
                                
       4D1D                     ROM_BDOS:
000D1D 4D1D E5              11      PUSH    HL
000D1E 4D1E 79               4      LD  A,C
000D1F 4D1F 87               4      ADD A,A
000D20 4D20 38F7            12      JR  C,_ERROR
000D22 4D22 6F               4      LD  L,A
000D23 4D23 265F             7      LD  H,high STABLE
000D25 4D25 7E               7      LD  A,(HL)
000D26 4D26 2C               4      INC L
000D27 4D27 66               7      LD  H,(HL)
000D28 4D28 6F               4      LD  L,A
000D29 4D29 E3              19      EX  (SP),HL
000D2A 4D2A 79               4      LD  A,C
000D2B 4D2B C9              10      RET
                                
       4D2C                     _PRINT:
       4D2C                     PRINT:
000D2C 4D2C 7B               4      LD  A,E
000D2D 4D2D 1803            12      JR  MSG_A
                                
       4D2F                     _SYS01:     ;(BDOS)コンソール入力
000D2F 4D2F CDA64D          17      CALL    _SYS07
       4D32                     MSG_A:
000D32 4D32 FE03             7      CP  3
000D34 4D34 2814            12      JR  Z,MSG_BR
       4D36                     MSGA1:
000D36 4D36 F5              11      PUSH    AF
000D37 4D37 C5              11      PUSH    BC
000D38 4D38 D5              11      PUSH    DE
000D39 4D39 E5              11      PUSH    HL
000D3A 4D3A DDE5            15      PUSH    IX
000D3C 4D3C DD21A200        14      LD  IX,CHPUT
000D40 4D40 CDFA42          17      CALL    CALSLT_R
000D43 4D43 DDE1            14      POP IX
000D45 4D45 E1              10      POP HL
000D46 4D46 D1              10      POP DE
000D47 4D47 C1              10      POP BC
       4D48                     MSGA2:
000D48 4D48 F1              10      POP AF
000D49 4D49 C9              10      RET
       4D4A                     MSG_BR:
000D4A 4D4A F5              11      PUSH    AF
000D4B 4D4B 3ADDF3          13      LD  A,(CSRX)
000D4E 4D4E FE02             7      CP  2
000D50 4D50 38F6            12      JR  C,MSGA2
000D52 4D52 F1              10      POP AF
       4D53                     MSG_CR:
000D53 4D53 F5              11      PUSH    AF
000D54 4D54 3E0D             7      LD  A,00DH
000D56 4D56 CD364D          17      CALL    MSGA1
000D59 4D59 3E0A             7      LD  A,00AH
000D5B 4D5B CD364D          17      CALL    MSGA1
000D5E 4D5E F1              10      POP AF
000D5F 4D5F C9              10      RET
                                
       4D60                     _SYS02:     ;(BDOS)コンソール出力
000D60 4D60 CD7B4D          17      CALL    BREAK
000D63 4D63 1805            12      JR  PRINTX
                                
       4D65                     _SYS06:     ;(BDOS)コンソール直接入出力
000D65 4D65 7B               4      LD  A,E
000D66 4D66 3C               4      INC A
000D67 4D67 CABA4D          10      JP  Z,_INKEY
       4D6A                     PRINTX:
000D6A 4D6A C32C4D          10      JP  _PRINT
                                
       4D6D                     _SYS08:     ;(BDOS)エコーなしコンソール入力
000D6D 4D6D CDA64D          17      CALL    _SYS07
000D70 4D70 FE03             7      CP  3
000D72 4D72 CC7B4D          17      CALL    Z,_BREAK
000D75 4D75 FE13             7      CP  013H        ;CTRL+S
000D77 4D77 C0              11      RET NZ
       4D78                     PAUSE:
000D78 4D78 CD924D          17      CALL    KEYBC
                                
       4D7B                     _BREAK:
       4D7B                     BREAK:
000D7B 4D7B F5              11      PUSH    AF
000D7C 4D7C C5              11      PUSH    BC
000D7D 4D7D D5              11      PUSH    DE
000D7E 4D7E E5              11      PUSH    HL
000D7F 4D7F DDE5            15      PUSH    IX
000D81 4D81 DD21B700        14      LD  IX,BREAKX
000D85 4D85 CDFA42          17      CALL    CALSLT_R
000D88 4D88 DDE1            14      POP IX
000D8A 4D8A E1              10      POP HL
000D8B 4D8B D1              10      POP DE
000D8C 4D8C C1              10      POP BC
000D8D 4D8D DC7B4D          17      CALL    C,_BREAK
000D90 4D90 F1              10      POP AF
000D91 4D91 C9              10      RET
       4D92                     KEYBC:
000D92 4D92 F5              11      PUSH    AF
000D93 4D93 C5              11      PUSH    BC
000D94 4D94 D5              11      PUSH    DE
000D95 4D95 E5              11      PUSH    HL
000D96 4D96 DDE5            15      PUSH    IX
000D98 4D98 DD215601        14      LD  IX,KILBUF
000D9C 4D9C CDFA42          17      CALL    CALSLT_R
000D9F 4D9F DDE1            14      POP IX
000DA1 4DA1 E1              10      POP HL
000DA2 4DA2 D1              10      POP DE
000DA3 4DA3 C1              10      POP BC
000DA4 4DA4 F1              10      POP AF
000DA5 4DA5 C9              10      RET
                                
       4DA6                     _SYS07:
       4DA6                     FLGET:
000DA6 4DA6 C5              11      PUSH    BC
000DA7 4DA7 D5              11      PUSH    DE
000DA8 4DA8 E5              11      PUSH    HL
000DA9 4DA9 DDE5            15      PUSH    IX
000DAB 4DAB DD219F00        14      LD  IX,CHGET
000DAF 4DAF CDFA42          17      CALL    CALSLT_R
000DB2 4DB2 DDE1            14      POP IX
000DB4 4DB4 E1              10      POP HL
000DB5 4DB5 D1              10      POP DE
000DB6 4DB6 C1              10      POP BC
000DB7 4DB7 FE03             7      CP  3
000DB9 4DB9 C9              10      RET
                                ;   RET NZ
                                ;   JP  CPM_BOOT
                                
       4DBA                     _INKEY:
       4DBA                     INKEY:
000DBA 4DBA CD544E          17      CALL    CPM_CONST
000DBD 4DBD C8              11      RET Z
000DBE 4DBE 18E6            12      JR  FLGET
                                
       4DC0                     _SYS0A:     ;(BDOS)文字列入力
000DC0 4DC0 C5              11      PUSH    BC
000DC1 4DC1 E5              11      PUSH    HL
000DC2 4DC2 D5              11      PUSH    DE
000DC3 4DC3 CDEC4D          17      CALL    GETL
000DC6 4DC6 111FF4          10      LD  DE,KBUF
000DC9 4DC9 E1              10      POP HL
000DCA 4DCA E5              11      PUSH    HL
000DCB 4DCB 0E00             7      LD  C,0
000DCD 4DCD 3004            12      JR  NC,SAX0
000DCF 4DCF 23               6      INC HL
000DD0 4DD0 23               6      INC HL
000DD1 4DD1 1808            12      JR  SAX4
       4DD3                     SAX0:
000DD3 4DD3 46               7      LD  B,(HL)
000DD4 4DD4 23               6      INC HL
       4DD5                     SAX1:
000DD5 4DD5 23               6      INC HL
000DD6 4DD6 1A               7      LD  A,(DE)
000DD7 4DD7 13               6      INC DE
000DD8 4DD8 B7               4      OR  A
000DD9 4DD9 2004            12      JR  NZ,SAX2
       4DDB                     SAX4:
000DDB 4DDB 360D            10      LD  (HL),00DH
000DDD 4DDD 1804            12      JR  SAX3
       4DDF                     SAX2:
000DDF 4DDF 77               7      LD  (HL),A
000DE0 4DE0 0C               4      INC C
000DE1 4DE1 10F2            13      DJNZ    SAX1
       4DE3                     SAX3:
000DE3 4DE3 D1              10      POP DE
000DE4 4DE4 79               4      LD  A,C
000DE5 4DE5 13               6      INC DE
000DE6 4DE6 12               7      LD  (DE),A
000DE7 4DE7 1B               6      DEC DE
000DE8 4DE8 E1              10      POP HL
000DE9 4DE9 C1              10      POP BC
000DEA 4DEA A7               4      AND A
000DEB 4DEB C9              10      RET
       4DEC                     GETL:
000DEC 4DEC DDE5            15      PUSH    IX
000DEE 4DEE FDE5            15      PUSH    IY
                                
000DF0 4DF0 2ADCF3          16      LD  HL,(CSRY)
000DF3 4DF3 22CAFB          16      LD  (FSTPOS),HL
       4DF6                     GETL1:
000DF6 4DF6 CD6D4D          17      CALL    _SYS08
000DF9 4DF9 FE09             7      CP  9
000DFB 4DFB 2008            12      JR  NZ,GETL1V
000DFD 4DFD 211FF4          10      LD  HL,KBUF
000E00 4E00 CD7543          17      CALL    MSX
000E03 4E03 18F1            12      JR  GETL1
       4E05                     GETL1V:
000E05 4E05 5F               4      LD  E,A
000E06 4E06 FE08             7      CP  8
000E08 4E08 CCA24E          17      CALL    Z,CTRL02
000E0B 4E0B FE20             7      CP  020H
000E0D 4E0D D4CE4E          17      CALL    NC,INSERT
000E10 4E10 CD364D          17      CALL    MSGA1
                                
000E13 4E13 7B               4      LD  A,E
000E14 4E14 FE0D             7      CP  00DH
000E16 4E16 20DE            12      JR  NZ,GETL1
                                
000E18 4E18 111FF4          10      LD  DE,KBUF
000E1B 4E1B 3AB0F3          13      LD  A,(LINLEN)
000E1E 4E1E 47               4      LD  B,A
000E1F 4E1F CD8150          17      CALL    ZERO_MEMORY_DE
                                
000E22 4E22 2ACAFB          16      LD  HL,(FSTPOS)
000E25 4E25 3ADCF3          13      LD  A,(CSRY)
000E28 4E28 6F               4      LD  L,A
000E29 4E29 E5              11      PUSH    HL
000E2A 4E2A CDFF4E          17      CALL    LOC0
000E2D 4E2D 4D               4      LD  C,L
000E2E 4E2E 44               4      LD  B,H
000E2F 4E2F E1              10      POP HL
000E30 4E30 3AB0F3          13      LD  A,(LINLEN)
000E33 4E33 94               4      SUB H
000E34 4E34 3D               4      DEC A
000E35 4E35 5F               4      LD  E,A
000E36 4E36 211FF4          10      LD  HL,KBUF
       4E39                     GETL2:
000E39 4E39 CD924E          17      CALL    _SCRN
000E3C 4E3C 03               6      INC BC
000E3D 4E3D 77               7      LD  (HL),A
000E3E 4E3E 23               6      INC HL
000E3F 4E3F 1D               4      DEC E
000E40 4E40 20F7            12      JR  NZ,GETL2
000E42 4E42 CD534D          17      CALL    MSG_CR
                                
000E45 4E45 FDE1            14      POP IY
000E47 4E47 DDE1            14      POP IX
       4E49                     GETL3:
000E49 4E49 2B               6      DEC HL
000E4A 4E4A 7E               7      LD  A,(HL)
000E4B 4E4B FE21             7      CP  021H
000E4D 4E4D D0              11      RET NC
000E4E 4E4E 3600            10      LD  (HL),0
000E50 4E50 15               4      DEC D
000E51 4E51 20F6            12      JR  NZ,GETL3
000E53 4E53 C9              10      RET
                                
       4E54                     _SYS0B:     ;(BDOS)コンソール状態のチェック
       4E54                     CONSTX:
       4E54                     CPM_CONST:
000E54 4E54 C5              11      PUSH    BC
000E55 4E55 D5              11      PUSH    DE
000E56 4E56 E5              11      PUSH    HL
000E57 4E57 DDE5            15      PUSH    IX
000E59 4E59 DD219C00        14      LD  IX,CHSNS
000E5D 4E5D CDFA42          17      CALL    CALSLT_R
000E60 4E60 DDE1            14      POP IX
000E62 4E62 E1              10      POP HL
000E63 4E63 D1              10      POP DE
000E64 4E64 C1              10      POP BC
000E65 4E65 C9              10      RET
                                
       4E66                     _SYS2A:     ;(BDOS)日付の獲得
000E66 4E66 AF               4      XOR A
000E67 4E67 57               4      LD  D,A
000E68 4E68 5F               4      LD  E,A
000E69 4E69 67               4      LD  H,A
000E6A 4E6A 6F               4      LD  L,A
000E6B 4E6B C9              10      RET
                                
       4E6C                     _SYS2C:     ;(BDOS)時刻の獲得
000E6C 4E6C AF               4      XOR A
000E6D 4E6D 57               4      LD  D,A
000E6E 4E6E 5F               4      LD  E,A
000E6F 4E6F 67               4      LD  H,A
000E70 4E70 6F               4      LD  L,A
000E71 4E71 C9              10      RET
                                
       4E72                     POS:
000E72 4E72 F5              11      PUSH    AF
000E73 4E73 2ADCF3          16      LD  HL,(CSRY)
000E76 4E76 7D               4      LD  A,L
000E77 4E77 6C               4      LD  L,H
000E78 4E78 67               4      LD  H,A
000E79 4E79 2C               4      INC L
000E7A 4E7A 24               4      INC H
000E7B 4E7B F1              10      POP AF
000E7C 4E7C C9              10      RET
                                
       4E7D                     LOC:
000E7D 4E7D F5              11      PUSH    AF
000E7E 4E7E E5              11      PUSH    HL
000E7F 4E7F 7D               4      LD  A,L
000E80 4E80 6C               4      LD  L,H
000E81 4E81 67               4      LD  H,A
000E82 4E82 2D               4      DEC L
000E83 4E83 25               4      DEC H
000E84 4E84 DDE5            15      PUSH    IX
000E86 4E86 DD21C600        14      LD  IX,POSIT
000E8A 4E8A CDFA42          17      CALL    CALSLT_R
000E8D 4E8D DDE1            14      POP IX
000E8F 4E8F E1              10      POP HL
000E90 4E90 F1              10      POP AF
000E91 4E91 C9              10      RET
                                
       4E92                     _SCRN:
       4E92                     SCRN:
000E92 4E92 E5              11      PUSH    HL
000E93 4E93 DDE5            15      PUSH    IX
                                
000E95 4E95 69               4      LD  L,C
000E96 4E96 60               4      LD  H,B
000E97 4E97 DD214A00        14      LD  IX,RDVRM
000E9B 4E9B CDFA42          17      CALL    CALSLT_R
                                
000E9E 4E9E DDE1            14      POP IX
000EA0 4EA0 E1              10      POP HL
000EA1 4EA1 C9              10      RET
                                
       4EA2                     CTRL02:
000EA2 4EA2 F5              11      PUSH    AF
000EA3 4EA3 D5              11      PUSH    DE
000EA4 4EA4 2ADCF3          16      LD  HL,(CSRY)
000EA7 4EA7 3AB0F3          13      LD  A,(LINLEN)
000EAA 4EAA 4F               4      LD  C,A
000EAB 4EAB 94               4      SUB H   ;CSRX
000EAC 4EAC C602             7      ADD A,2
000EAE 4EAE 47               4      LD  B,A ;カーソルより右の文字数
000EAF 4EAF 61               4      LD  H,C ;LINLEN
000EB0 4EB0 C5              11      PUSH    BC
000EB1 4EB1 CDFF4E          17      CALL    LOC0
000EB4 4EB4 C1              10      POP BC
                                
000EB5 4EB5 1620             7      LD  D,020H
       4EB7                     C8X1:
000EB7 4EB7 DD214A00        14      LD  IX,RDVRM
000EBB 4EBB CDFA42          17      CALL    CALSLT_R
000EBE 4EBE 4F               4      LD  C,A
000EBF 4EBF 7A               4      LD  A,D
000EC0 4EC0 DD214D00        14      LD  IX,WRTVRM
000EC4 4EC4 CDFA42          17      CALL    CALSLT_R
000EC7 4EC7 2B               6      DEC HL
000EC8 4EC8 51               4      LD  D,C
000EC9 4EC9 10EC            13      DJNZ    C8X1
000ECB 4ECB D1              10      POP DE
000ECC 4ECC F1              10      POP AF
000ECD 4ECD C9              10      RET
                                
       4ECE                     INSERT:
000ECE 4ECE F5              11      PUSH    AF
000ECF 4ECF D5              11      PUSH    DE
000ED0 4ED0 2ADCF3          16      LD  HL,(CSRY)
000ED3 4ED3 3AB0F3          13      LD  A,(LINLEN)
000ED6 4ED6 4F               4      LD  C,A
000ED7 4ED7 94               4      SUB H   ;CSRX
000ED8 4ED8 3C               4      INC A
000ED9 4ED9 47               4      LD  B,A ;カーソルより右の文字数
000EDA 4EDA C5              11      PUSH    BC
000EDB 4EDB CDFF4E          17      CALL    LOC0
000EDE 4EDE C1              10      POP BC
                                
000EDF 4EDF 1620             7      LD  D,020H
       4EE1                     INS1:
000EE1 4EE1 DD214A00        14      LD  IX,RDVRM
000EE5 4EE5 CDFA42          17      CALL    CALSLT_R
000EE8 4EE8 4F               4      LD  C,A
000EE9 4EE9 7A               4      LD  A,D
000EEA 4EEA DD214D00        14      LD  IX,WRTVRM
000EEE 4EEE CDFA42          17      CALL    CALSLT_R
000EF1 4EF1 23               6      INC HL
000EF2 4EF2 51               4      LD  D,C
000EF3 4EF3 10EC            13      DJNZ    INS1
000EF5 4EF5 D1              10      POP DE
000EF6 4EF6 F1              10      POP AF
000EF7 4EF7 C9              10      RET
                                
       4EF8                     CONOUT1:
000EF8 4EF8 59               4      LD  E,C
000EF9 4EF9 C32C4D          10      JP  _PRINT
                                
       4EFC                     GETVRAM:
000EFC 4EFC 2ADCF3          16      LD  HL,(CSRY)
       4EFF                     LOC0:
000EFF 4EFF 2D               4      DEC L
000F00 4F00 25               4      DEC H
000F01 4F01 4C               4      LD  C,H ;CSRX-1
000F02 4F02 5D               4      LD  E,L ;CSRY-1
       4F03                     LOC1:
000F03 4F03 3AB0F3          13      LD  A,(LINLEN)
000F06 4F06 67               4      LD  H,A
000F07 4F07 1600             7      LD  D,0
000F09 4F09 6A               4      LD  L,D ;0
000F0A 4F0A 0608             7      LD  B,8
       4F0C                     LOC2:
000F0C 4F0C 29              11      ADD HL,HL
000F0D 4F0D 3001            12      JR  NC,LOC3
000F0F 4F0F 19              11      ADD HL,DE
       4F10                     LOC3:
000F10 4F10 10FA            13      DJNZ    LOC2
000F12 4F12 09              11      ADD HL,BC
000F13 4F13 C9              10      RET
                                
       4F14                     _SYS0C:     ;(BDOS)バージョン番号の獲得
000F14 4F14 212200          10      LD  HL,00022H
000F17 4F17 AF               4      XOR A
000F18 4F18 7D               4      LD  A,L
000F19 4F19 C9              10      RET
                                
       4F1A                     _SYS0D:     ;(BDOS)ディスク・リセット
000F1A 4F1A 218000          10      LD  HL,00080H
000F1D 4F1D 2226F1          16      LD  (_DTA),HL
000F20 4F20 C9              10      RET
                                
       4F21                     _SYS0E:     ;(BDOS)カレントドライブの設定
000F21 4F21 323AF1          13      LD  (_DVSW),A
000F24 4F24 C9              10      RET
                                
       4F25                     _SYS0F:     ;(BDOS)ファイルのオープン
000F25 4F25 D5              11      PUSH    DE
000F26 4F26 FDE1            14      POP IY
000F28 4F28 CD6E50          17      CALL    INIT_FILE
000F2B 4F2B CDB648          17      CALL    ROM_OPEN
000F2E 4F2E 3856            12      JR  C,SCF_FF_RET
                                ;               Open(Read)
000F30 4F30 FD361CFF        19      LD  (IY+28),0FFH
                                ;               FILENAME
000F34 4F34 FDE5            15      PUSH    IY
000F36 4F36 D1              10      POP DE
000F37 4F37 13               6      INC DE
000F38 4F38 010B00          10      LD  BC,11
000F3B 4F3B EDB0                    LDIR
                                ;               Attribute
000F3D 4F3D 7E               7      LD  A,(HL)
000F3E 4F3E FD770D          19      LD  (IY+13),A
                                ;               TIME
000F41 4F41 110B00          10      LD  DE,11
000F44 4F44 19              11      ADD HL,DE
000F45 4F45 7E               7      LD  A,(HL)
000F46 4F46 23               6      INC HL
000F47 4F47 FD7716          19      LD  (IY+22),A
000F4A 4F4A 7E               7      LD  A,(HL)
000F4B 4F4B 23               6      INC HL
000F4C 4F4C FD7717          19      LD  (IY+23),A
                                ;               DATE
000F4F 4F4F 7E               7      LD  A,(HL)
000F50 4F50 23               6      INC HL
000F51 4F51 FD7714          19      LD  (IY+20),A
000F54 4F54 7E               7      LD  A,(HL)
000F55 4F55 23               6      INC HL
000F56 4F56 FD7715          19      LD  (IY+21),A
                                ;               First cluster
000F59 4F59 7E               7      LD  A,(HL)
000F5A 4F5A 23               6      INC HL
000F5B 4F5B FD771A          19      LD  (IY+26),A
000F5E 4F5E 7E               7      LD  A,(HL)
000F5F 4F5F 23               6      INC HL
000F60 4F60 FD771B          19      LD  (IY+27),A
                                ;               SIZE
000F63 4F63 7E               7      LD  A,(HL)
000F64 4F64 23               6      INC HL
000F65 4F65 FD7710          19      LD  (IY+16),A
000F68 4F68 7E               7      LD  A,(HL)
000F69 4F69 23               6      INC HL
000F6A 4F6A FD7711          19      LD  (IY+17),A
000F6D 4F6D 7E               7      LD  A,(HL)
000F6E 4F6E 23               6      INC HL
000F6F 4F6F FD7712          19      LD  (IY+18),A
000F72 4F72 7E               7      LD  A,(HL)
000F73 4F73 FD7713          19      LD  (IY+19),A
000F76 4F76 AF               4      XOR A
000F77 4F77 FD770C          19      LD  (IY+12),A
000F7A 4F7A C9              10      RET
                                
       4F7B                     _SYS10:     ;(BDOS)ファイルのクローズ
000F7B 4F7B AF               4      XOR A
000F7C 4F7C C9              10      RET
                                
       4F7D                     S11X1:
000F7D 4F7D FD7119          19      LD  (IY+25),C       ;RootEntCnt
000F80 4F80 FD750E          19      LD  (IY+14),L
000F83 4F83 FD740F          19      LD  (IY+15),H
       4F86                     SCF_FF_RET:
000F86 4F86 37               4      SCF
000F87 4F87 9F               4      SBC A,A
000F88 4F88 C9              10      RET
                                
       4F89                     _SYS11:     ;(BDOS)最初のファイルの検索
000F89 4F89 ED532EF1        20      LD  (_FCB),DE
000F8D 4F8D D5              11      PUSH    DE
000F8E 4F8E FDE1            14      POP IY
000F90 4F90 CD6E50          17      CALL    INIT_FILE
000F93 4F93 CDFE4A          17      CALL    GET_DIR_DAT
       4F96                     S12X1:
000F96 4F96 CDD248          17      CALL    FILESE
000F99 4F99 30E2            12      JR  NC,S11X1
000F9B 4F9B 0D               4      DEC C
000F9C 4F9C FD7119          19      LD  (IY+25),C       ;RootEntCnt
000F9F 4F9F 012000          10      LD  BC,32
000FA2 4FA2 ED5B26F1        20      LD  DE,(_DTA)
000FA6 4FA6 AF               4      XOR A
000FA7 4FA7 12               7      LD  (DE),A      ;ドライブ番号
000FA8 4FA8 13               6      INC DE
000FA9 4FA9 EDB0                    LDIR            ;ディレクトリエントリ
000FAB 4FAB FD750E          19      LD  (IY+14),L
000FAE 4FAE FD740F          19      LD  (IY+15),H
000FB1 4FB1 C9              10      RET
                                
       4FB2                     _SYS12:
000FB2 4FB2 FD2A2EF1        20      LD  IY,(_FCB)
000FB6 4FB6 FDE5            15      PUSH    IY
000FB8 4FB8 D1              10      POP DE
000FB9 4FB9 CD6E50          17      CALL    INIT_FILE
                                
000FBC 4FBC FD6E0E          19      LD  L,(IY+14)
000FBF 4FBF FD660F          19      LD  H,(IY+15)
000FC2 4FC2 FD4E19          19      LD  C,(IY+25)
000FC5 4FC5 18CF            12      JR  S12X1
                                
       4FC7                     _SYS14:     ;(BDOS)シーケンシャルな読み出し
000FC7 4FC7 CDE44A          17      CALL    SET_FCB
000FCA 4FCA CDB24A          17      CALL    GETSEQ
000FCD 4FCD CD9F4A          17      CALL    RB_READ
000FD0 4FD0 E5              11      PUSH    HL
000FD1 4FD1 CDBF4A          17      CALL    SETSEQ
000FD4 4FD4 E1              10      POP HL
       4FD5                     SREAD:
000FD5 4FD5 C601             7      ADD A,001H
000FD7 4FD7 D8              11      RET C
                                
000FD8 4FD8 7D               4      LD  A,L
000FD9 4FD9 D601             7      SUB 001H
000FDB 4FDB 9F               4      SBC A,A
000FDC 4FDC E603             7      AND 3
000FDE 4FDE 1F               4      RRA
000FDF 4FDF C9              10      RET
                                
       4FE0                     _SYS18:     ;(BDOS)ログインベクトルの獲得
000FE0 4FE0 210100          10      LD  HL,00001H
000FE3 4FE3 AF               4      XOR A
000FE4 4FE4 C9              10      RET
                                
       4FE5                     _SYS19:     ;(BDOS)カレントドライブ番号の獲得
000FE5 4FE5 3A3AF1          13      LD  A,(_DVSW)
000FE8 4FE8 C9              10      RET
                                
       4FE9                     _SYS1A:     ;(BDOS)DTAの設定
000FE9 4FE9 ED5326F1        20      LD  (_DTA),DE
000FED 4FED AF               4      XOR A
000FEE 4FEE C9              10      RET
                                
       4FEF                     _SYS1B:     ;(BDOS)ディスク情報の獲得
000FEF 4FEF 010002          10      LD  BC,512
000FF2 4FF2 11C302          10      LD  DE,707
000FF5 4FF5 210000          10      LD  HL,0
000FF8 4FF8 DD2130F1        14      LD  IX,_BUF
000FFC 4FFC FD2130F1        14      LD  IY,_BUF
001000 5000 FD3600F9        19      LD  (IY+0),0F9H
001004 5004 3E02             7      LD  A,2
001006 5006 C9              10      RET
                                
       5007                     _SYS21:     ;(BDOS)ランダムな読み出し
001007 5007 CDE44A          17      CALL    SET_FCB
                                
00100A 500A FD6E21          19      LD  L,(IY+33)   ;(FCB)Random record
00100D 500D FD6622          19      LD  H,(IY+34)
                                
001010 5010 CD9F4A          17      CALL    RB_READ
001013 5013 18C0            12      JR  SREAD
                                
       5015                     _SYS23:     ;(BDOS)ファイル・サイズの獲得
001015 5015 CD254F          17      CALL    _SYS0F
001018 5018 D8              11      RET C
                                
001019 5019 D5              11      PUSH    DE      ;EX DE,IY
00101A 501A FDE3            23      EX  (SP),IY     ;
                                ;   POP DE      ;
                                ;   PUSH    DE      ;DEを破壊しないように注意vv
00101C 501C CDD44A          17      CALL    GETSIZE
       501F                     _S24X1:
00101F 501F FD7521          19      LD  (IY+33),L   ;(FCB)Random record
001022 5022 FD7422          19      LD  (IY+34),H
001025 5025 FD362300        19      LD  (IY+35),0
                                ;   POP DE      ;^^^^^^^^^^^^^^^^^^^^^^^^
                                ;   PUSH    DE      ;EX DE,IY
001029 5029 FDE3            23      EX  (SP),IY     ;
00102B 502B D1              10      POP DE      ;
                                
00102C 502C AF               4      XOR A
00102D 502D C9              10      RET
                                
       502E                     _SYS24:     ;(BDOS)ランダム・レコード・フィールドの設定
00102E 502E E5              11      PUSH    HL
00102F 502F D5              11      PUSH    DE      ;EX DE,IY
001030 5030 FDE3            23      EX  (SP),IY     ;
                                ;   POP DE      ;
                                ;   PUSH    DE      ;DEを破壊しないように注意vv
001032 5032 CDB24A          17      CALL    GETSEQ
001035 5035 18E8            12      JR  _S24X1      ;^^^^^^^^^^^^^^^^^^^^^^^^
                                
       5037                     _SYS27:     ;(BDOS)ランダムブロック読み込み
001037 5037 CDE44A          17      CALL    SET_FCB
00103A 503A E5              11      PUSH    HL
00103B 503B FD6E21          19      LD  L,(IY+33)
00103E 503E FD6622          19      LD  H,(IY+34)
001041 5041 221CF1          16      LD  (RR_LOW),HL
001044 5044 FD6E23          19      LD  L,(IY+35)
001047 5047 FD6624          19      LD  H,(IY+36)
00104A 504A 221EF1          16      LD  (RR_HIGH),HL
00104D 504D E1              10      POP HL
00104E 504E CDD646          17      CALL    ROM_READ
001051 5051 ED5B1CF1        20      LD  DE,(RR_LOW)
001055 5055 FD7321          19      LD  (IY+33),E
001058 5058 FD7222          19      LD  (IY+34),D
00105B 505B ED5B1EF1        20      LD  DE,(RR_HIGH)
00105F 505F FD7323          19      LD  (IY+35),E
001062 5062 FD7224          19      LD  (IY+36),D
001065 5065 9F               4      SBC A,A
001066 5066 C9              10      RET
                                
       5067                     _SYS2F:
001067 5067 44               4      LD  B,H
001068 5068 2A26F1          16      LD  HL,(_DTA)
00106B 506B C3404B          10      JP  DISKIO
                                
       506E                     INIT_FILE:
00106E 506E EB               4      EX  DE,HL
00106F 506F 1143F1          10      LD  DE,FDRV
001072 5072 010C00          10      LD  BC,1+8+3
001075 5075 EDB0                    LDIR
001077 5077 CDD54C          17      CALL    GET_DISK_BANK_FDRV
00107A 507A 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
00107D 507D 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
001080 5080 C9              10      RET
                                
       5081                     ZERO_MEMORY_DE:
001081 5081 AF               4      XOR A
       5082                     FILL_MEMORY_DE:
001082 5082 12               7      LD  (DE),A
001083 5083 13               6      INC DE
001084 5084 10FC            13      DJNZ    FILL_MEMORY_DE
001086 5086 C9              10      RET
                                
001087 5087                         DS  05F00H-$
       5F00                     STABLE:
                                ;0
001F00 5F00 194D2F4D604D194D        DW  _ERROR,_SYS01,_SYS02,_ERROR
001F08 5F08 194D194D654DA64D        DW  _ERROR,_ERROR,_SYS06,_SYS07
001F10 5F10 6D4D194DC04D544E        DW  _SYS08,_ERROR,_SYS0A,_SYS0B
001F18 5F18 144F1A4F214F254F        DW  _SYS0C,_SYS0D,_SYS0E,_SYS0F
                                ;1
001F20 5F20 7B4F894FB24F194D        DW  _SYS10,_SYS11,_SYS12,_ERROR
001F28 5F28 C74F194D194D194D        DW  _SYS14,_ERROR,_ERROR,_ERROR
001F30 5F30 E04FE54FE94FEF4F        DW  _SYS18,_SYS19,_SYS1A,_SYS1B
001F38 5F38 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;2
001F40 5F40 194D194D194D1550        DW  _ERROR,_ERROR,_ERROR,_SYS23
001F48 5F48 2E50194D194D3750        DW  _SYS24,_ERROR,_ERROR,_SYS27
001F50 5F50 194D194D664E194D        DW  _ERROR,_ERROR,_SYS2A,_ERROR
001F58 5F58 6C4E194D194D6750        DW  _SYS2C,_ERROR,_ERROR,_SYS2F
                                ;3
001F60 5F60 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F68 5F68 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F70 5F70 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F78 5F78 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;4
001F80 5F80 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F88 5F88 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F90 5F90 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F98 5F98 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;5
001FA0 5FA0 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FA8 5FA8 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FB0 5FB0 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FB8 5FB8 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;6
001FC0 5FC0 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FC8 5FC8 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FD0 5FD0 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FD8 5FD8 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;7
001FE0 5FE0 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FE8 5FE8 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FF0 5FF0 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FF8 5FF8 194D194D194D194D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                
[EOF:BDOS.ASM:UTF_8]
       6000                     LAST_ADR:
                                
                                    END
[EOF:DISKROM.ASM:UTF_8]
