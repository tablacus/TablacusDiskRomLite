                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.0.0, LST:Full:4
                                ;   Tablacus DISK ROM Lite for MSX
                                ;   Programmed by
                                ;   Gaku (Lovers/Tablacus)
                                ;
                                    INCLUDE "DEF.ASM"
                                
                                ;   LSX-Dodgers DEF
                                ;   MSX
                                
       4000                     RUN EQU 04000H
                                
       000C                     _RDSLT  EQU 0000CH
       0014                     _WRSLT  EQU 00014H
       001C                     _CALSLT EQU 0001CH
       0024                     _ENASLT EQU 00024H
       0030                     _CALLF  EQU 00030H
       004A                     RDVRM   EQU 0004AH
       004D                     WRTVRM  EQU 0004DH
       005C                     LDIRVM  EQU 0005CH
       009C                     CHSNS   EQU 0009CH
       009F                     CHGET   EQU 0009FH
       00A2                     CHPUT   EQU 000A2H
       00B7                     BREAKX  EQU 000B7H
       00C6                     POSIT   EQU 000C6H
       0138                     RSLREG  EQU 00138H
       0156                     KILBUF  EQU 00156H
                                
       406F                     ERRHAND EQU 0406FH
       42B2                     CRUNCH  EQU 042B2H
       4C64                     FRMEVL  EQU 04C64H
       67D0                     FRESTR  EQU 067D0H
                                
       F331                     H_BDOS  EQU 0F331H
       F341                     RAMAD0  EQU 0F341H
       F342                     RAMAD1  EQU 0F342H
       F343                     RAMAD2  EQU 0F343H
       F344                     RAMAD3  EQU 0F344H
       F348                     MASTERS EQU 0F348H
       F368                     ROMUSE  EQU 0F368H
       F36B                     RAMUSE  EQU 0F36BH
       F37D                     BDOS    EQU 0F37DH
       F38C                     CLPRIM  EQU 0F38CH
       F3B0                     LINLEN  EQU 0F3B0H
       F3B9                     TXTATR  EQU 0F3B9H
       F3BB                     TXTPAT  EQU 0F3BBH
       F3D3                     MLTCOL  EQU 0F3D3H
       F3DC                     CSRY    EQU 0F3DCH
       F3DD                     CSRX    EQU 0F3DDH
       F3F8                     PUTPNT  EQU 0F3F8H
       F3FA                     GETPNT  EQU 0F3FAH
       F3FC                     CS120   EQU 0F3FCH
                                
                                
       F41F                     KBUF    EQU 0F41FH
                                
       F55E                     BUF EQU 0F55EH
                                
       F663                     VALTYP  EQU 0F663H
       F672                     MEMSIZ  EQU 0F672H
       F674                     STKTOP  EQU 0F674H
       F676                     TXTTAB  EQU 0F676H
       F6B1                     SAVSTK  EQU 0F6B1H
       F6C2                     VARTAB  EQU 0F6C2H
       F6C4                     ARYTAB  EQU 0F6C4H
       F6C6                     STREND  EQU 0F6C6H
                                
       F7F6                     DAC EQU 0F7F6H
                                
                                ;FBUFFR EQU 0F7C5H
                                
                                ;PTRFIL EQU 0F864H
       F866                     RUNFLG  EQU 0F866H
                                ;FILNAM EQU 0F866H
                                ;FILNM2 EQU 0F871H
                                
                                ;RSTMP  EQU 0FB03H
       FB21                     DRVTBL  EQU 0FB21H
       FBCA                     FSTPOS  EQU 0FBCAH
       FBF0                     KEYBUF  EQU 0FBF0H
                                
       FC4A                     HIMEM   EQU 0FC4AH
       FCC1                     EXPTBL  EQU 0FCC1H
       FCBE                     RUNBNF  EQU 0FCBEH
       FCBF                     SAVENT  EQU 0FCBFH
                                
       FD99                     DEVICE  EQU 0FD99H
       FE71                     H_BINS  EQU 0FE71H
       FE76                     H_BINL  EQU 0FE76H
       FE7B                     H_FILE  EQU 0FE7BH
       FFA7                     H_PHYD  EQU 0FFA7H
       FEDA                     H_STKE  EQU 0FEDAH
                                
       FF43                     H_GONE  EQU 0FF43H
                                            ;ASCII-8K
       6000                     BANK0_SEL EQU   06000H  ;6000-67FF
       6800                     BANK1_SEL EQU   06800H  ;6800-6FFF
       7000                     BANK2_SEL EQU   07000H  ;7000-77FF
       7800                     BANK3_SEL EQU   07800H  ;7800-7FFF
                                            ;ASCII-16K
                                ;BANK0_SEL EQU 06000H
                                ;BANK1_SEL EQU 07000H
                                            ;KONAMI-8K
       6000                     KONAMI_BANK1_SEL EQU    06000H  ;6000-7FFF
       8000                     KONAMI_BANK2_SEL EQU    08000H  ;8000-9FFF
       A000                     KONAMI_BANK3_SEL EQU    0A000H  ;A000-BFFF
                                                ;KONAMI-SCC
       5000                     KONAMI_SCC_BANK0_SEL EQU    05000H  ;5000-57FF
       7000                     KONAMI_SCC_BANK1_SEL EQU    07000H  ;7000-77FF
       9000                     KONAMI_SCC_BANK2_SEL EQU    09000H  ;9000-97FF
       B000                     KONAMI_SCC_BANK3_SEL EQU    0B000H  ;B000-B7FF
                                
       F0E9                     ISC EQU 0F0E9H
                                
       0001                     DISK_BANK   EQU 1       ;ドライブAが始まるバンク#
       6000                     BANK1_ADR   EQU 06000H      ;バンク1の開始アドレス
                                
       F7F8                     DACDAT  EQU DAC+2
[EOF:DEF.ASM:UTF_8]
                                
                                ;USE_RAM_BLOAD_S    EQU 1   ;先頭のコメントを外すとBLOAD,SでRAMを使う
                                
000000 4000                         ORG RUN
                                
                                ; MSX ROM header
000000 4000 4142                    DB  "AB"   ; ID for auto-executable ROM
000002 4002 0041                    DW  INIT_ROM   ; Main program execution address.
000004 4004 0000                    DW  0      ; STATEMENT
000006 4006 0000                    DW  0      ; DEVICE
000008 4008 0000                    DW  0      ; TEXT
00000A 400A 000000000000            DW  0,0,0  ; Reserved
                                
000010 4010 C3324B          10      JP  DISKIO
000013 4013 C36C4B          10      JP  DSKCHG
000016 4016 C3C24B          10      JP  GETDPB
000019 4019 C3B54C          10      JP  CHOICE
00001C 401C C3B94C          10      JP  DSKFMT
00001F 401F C3BB4C          10      JP  DSKSTP
000022 4022 C3BC4C          10      JP  BASENT
000025 4025 37               4      SCF
000026 4026 C3B94C          10      JP  DSKFMT
000029 4029 C3BB4C          10      JP  DSKSTP
00002C 402C 00               4      NOP
00002D 402D C3C34C          10      JP  GETSLT
000030 4030 2A4BF3          16      LD  HL,(0F34BH)
000033 4033 C9              10      RET
                                
00007F 407F                         ORG 0407FH
00007F 407F C9              10      RET
                                ; Version
000080 4080 5461626C61637573        DB  "Tablacus DISK ROM Lite v0.1.4.3",0
            204449534B20524F    
            4D204C6974652076    
            302E312E342E3300    
                                
0000FF 40FF                         ORG 040FFH
0000FF 40FF C9              10      RET
                                
                                    INCLUDE "INIT.ASM"
                                
                                ;   Tablacus DISK ROM - INIT
                                ;
                                
       4100                     INIT_ROM:
000100 4100 3A21FB          13      LD  A,(DRVTBL)
000103 4103 FE01             7      CP  1
000105 4105 C8              11      RET Z
                                
000106 4106 0180FF          10      LD  BC,-00080H
000109 4109 2A72F6          16      LD  HL,(MEMSIZ)
00010C 410C 09              11      ADD HL,BC
00010D 410D 2272F6          16      LD  (MEMSIZ),HL
000110 4110 2A74F6          16      LD  HL,(STKTOP)
000113 4113 09              11      ADD HL,BC
000114 4114 2274F6          16      LD  (STKTOP),HL
000117 4117 2180F0          10      LD  HL,0F080H
00011A 411A 1100F0          10      LD  DE,0F000H
00011D 411D 012000          10      LD  BC,00020H
000120 4120 EDB0                    LDIR
000122 4122 2180FF          10      LD  HL,-00080H
000125 4125 39              11      ADD HL,SP
000126 4126 224FF1          16      LD  (BASSTK),HL
000129 4129 ED7B4FF1        20      LD  SP,(BASSTK)
                                
00012D 412D 3EFF             7      LD  A,0FFH
00012F 412F 3299FD          13      LD  (DEVICE),A
                                
000132 4132 3E01             7      LD  A,1
000134 4134 3221FB          13      LD  (DRVTBL),A
                                
000137 4137 AF               4      XOR A
000138 4138 323AF1          13      LD  (_DVSW),A
                                
00013B 413B 21F842          10      LD  HL,AT_ISC
00013E 413E 11E9F0          10      LD  DE,ISC
000141 4141 016C00          10      LD  BC,ISC_E-ISC
000144 4144 EDB0                    LDIR
                                    
000146 4146 3EC3             7      LD  A,0C3H      ;JP
000148 4148 3243FF          13      LD  (H_GONE),A
00014B 414B 327DF3          13      LD  (BDOS),A
00014E 414E 326BF3          13      LD  (RAMUSE),A
000151 4151 3268F3          13      LD  (ROMUSE),A
000154 4154 21E9F0          10      LD  HL,REPLACE_COMMAND
000157 4157 2244FF          16      LD  (H_GONE+1),HL
00015A 415A 2131F3          10      LD  HL,H_BDOS
00015D 415D 227EF3          16      LD  (BDOS+1),HL
000160 4160 2110F1          10      LD  HL,RAMUSE1
000163 4163 226CF3          16      LD  (RAMUSE+1),HL
000166 4166 210BF1          10      LD  HL,ROMUSE1
000169 4169 2269F3          16      LD  (ROMUSE+1),HL
                                
00016C 416C 3E                      DB  03EH
00016D 416D F7              12      RST 30H
00016E 416E 3271FE          13      LD  (H_BINS),A
000171 4171 3276FE          13      LD  (H_BINL),A
000174 4174 327BFE          13      LD  (H_FILE),A
000177 4177 3231F3          13      LD  (H_BDOS),A
00017A 417A 32DAFE          13      LD  (H_STKE),A
00017D 417D 32A7FF          13      LD  (H_PHYD),A
                                
000180 4180 CD4042          17      CALL    GTSL1_
000183 4183 32FCF0          13      LD  (ROM_SLT),A
000186 4186 3272FE          13      LD  (H_BINS+1),A
000189 4189 3277FE          13      LD  (H_BINL+1),A
00018C 418C 327CFE          13      LD  (H_FILE+1),A
00018F 418F 3232F3          13      LD  (H_BDOS+1),A
000192 4192 32DBFE          13      LD  (H_STKE+1),A
000195 4195 32A8FF          13      LD  (H_PHYD+1),A
000198 4198 3222FB          13      LD  (DRVTBL+1),A
00019B 419B 3248F3          13      LD  (MASTERS),A
                                
00019E 419E 211F45          10      LD  HL,ROM_LOAD
0001A1 41A1 2273FE          16      LD  (H_BINS+2),HL
0001A4 41A4 213A46          10      LD  HL,ROM_RUN
0001A7 41A7 2278FE          16      LD  (H_BINL+2),HL
0001AA 41AA 214746          10      LD  HL,ROM_FILES
0001AD 41AD 227DFE          16      LD  (H_FILE+2),HL
0001B0 41B0 210F4D          10      LD  HL,ROM_BDOS
0001B3 41B3 2233F3          16      LD  (H_BDOS+2),HL
0001B6 41B6 218E43          10      LD  HL,ROM_STKE
0001B9 41B9 22DCFE          16      LD  (H_STKE+2),HL
0001BC 41BC 21324B          10      LD  HL,DISKIO
0001BF 41BF 22A9FF          16      LD  (H_PHYD+2),HL
                                
0001C2 41C2 3E                      DB  03EH
0001C3 41C3 C9              10      RET
0001C4 41C4 327FFE          13      LD  (H_FILE+4),A
0001C7 41C7 3275FE          13      LD  (H_BINS+4),A
0001CA 41CA 327AFE          13      LD  (H_BINL+4),A
0001CD 41CD 3235F3          13      LD  (H_BDOS+4),A
0001D0 41D0 32DEFE          13      LD  (H_STKE+4),A
0001D3 41D3 32ABFF          13      LD  (H_PHYD+4),A
                                
                                #if exists USE_NORMAL_32K_ROM
                                #else
0001D6 41D6 AF               4      XOR A
0001D7 41D7 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
0001DA 41DA 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
0001DD 41DD 3A0060          13      LD  A,(BANK1_ADR)
0001E0 41E0 FE41             7      CP  'A'
0001E2 41E2 204B            12      JR  NZ,NOT_8K_BANK
0001E4 41E4 3E01             7      LD  A,DISK_BANK
0001E6 41E6 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
0001E9 41E9 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
                                #endif
0001EC 41EC CD3801          17      CALL    RSLREG      ;read primary slot #
0001EF 41EF 07               4      RLCA
0001F0 41F0 07               4      RLCA
0001F1 41F1 F5              11      PUSH    AF
0001F2 41F2 CD4542          17      CALL    GTSL2_
0001F5 41F5 3244F3          13      LD  (RAMAD3),A
0001F8 41F8 F1              10      POP AF  
0001F9 41F9 CD4542          17      CALL    GTSL2_
0001FC 41FC 2680             7      LD  H,080H
0001FE 41FE CD5C42          17      CALL    CHK_RAM
000201 4201 3243F3          13      LD  (RAMAD2),A
       4204                     RAMCHK2:
000204 4204 3A44F3          13      LD  A,(RAMAD3)
000207 4207 2640             7      LD  H,040H
000209 4209 CD5C42          17      CALL    CHK_RAM
00020C 420C 3242F3          13      LD  (RAMAD1),A
       420F                     RAMCHK1:
00020F 420F 3A44F3          13      LD  A,(RAMAD3)
000212 4212 2600             7      LD  H,00H
000214 4214 CD5C42          17      CALL    CHK_RAM
000217 4217 3241F3          13      LD  (RAMAD0),A
       421A                     RAMCHK0:
00021A 421A 2A1360          16      LD  HL,(BANK1_ADR+19)   ;BPB_TotSec16   
00021D 421D 010F00          10      LD  BC,0000FH       ;切り上げ
000220 4220 09              11      ADD HL,BC
000221 4221 7D               4      LD  A,L
                                
000222 4222 0604             7      LD  B,4
       4224                     B_DRIVE1:
000224 4224 CB3C             8      SRL H
000226 4226 1F               4      RRA
000227 4227 10FB            13      DJNZ    B_DRIVE1
                                
000229 4229 C601             7      ADD A,DISK_BANK     ;A=(TotSec16/16)+DISK_BANK
00022B 422B 3239F1          13      LD  (B_DRIVE),A
                                
                                #if exists FIX_DRIVE
                                    LD  A,(B_DRIVE)
                                    CP  FIX_DRIVE
                                    JR  Z,OK_FIX_DRIVE
                                    LD  HL,MSG_ERROR_DRIVE
                                    CALL    MSX
                                    LD  A,(B_DRIVE)
                                    CALL    PRTHX
                                    LD  IY,(EXPTBL-1) ;メインROMスロット
                                    LD  IX,CHGET
                                    CALL    _CALSLT
                                    LD  HL,MSG_CRLF
                                    CALL    MSX
                                OK_FIX_DRIVE:
                                #endif
00022E 422E C9              10      RET
                                
       422F                     NOT_8K_BANK:
                                                ;ASCII-8K/Konami-8Kではない(ASCII-16K等)
00022F 422F 21DC43          10      LD  HL,MSG_ERROR_ROM_MODE
000232 4232 CD6743          17      CALL    MSX
000235 4235 FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
000239 4239 DD219F00        14      LD  IX,CHGET
00023D 423D C31C00          10      JP  _CALSLT
                                
       4240                     GTSL1_:             ;自分のいるスロットを知る
000240 4240 CD3801          17      CALL    RSLREG      ;read primary slot #
000243 4243 0F               4      RRCA
000244 4244 0F               4      RRCA
       4245                     GTSL2_:
000245 4245 E603             7      AND 3       ;[A]=000000PP
000247 4247 5F               4      LD  E,A     ;[E]=000000PP
000248 4248 21C1FC          10      LD  HL,EXPTBL
00024B 424B 85               4      ADD A,L     ;桁上りは無い
00024C 424C 6F               4      LD  L,A     ;[HL]=EXPTBL+000000PP
00024D 424D 7B               4      LD  A,E     ;[A]=000000PP
00024E 424E CB7E            13      BIT 7,(HL)
000250 4250 C8              11      RET Z
000251 4251 7D               4      LD  A,L     ;point to SLTTBL entry
000252 4252 C604             7      ADD A,4     ;桁上りは無い
000254 4254 6F               4      LD  L,A
000255 4255 7E               7      LD  A,(HL)      ;get currently expansion slot register
000256 4256 E60C             7      AND 00CH        ;[A] = 0000SS00
000258 4258 B3               4      OR  E       ;[A] = 0000SSPP
000259 4259 F680             7      OR  080H        ;[A] = 1000SSPP
00025B 425B C9              10      RET
       425C                     GTSL1_E:
                                
       425C                     CHK_RAM:
00025C 425C E5              11      PUSH    HL
00025D 425D CDB142          17      CALL    CHK_RAM0
000260 4260 E1              10      POP HL
000261 4261 C8              11      RET Z
000262 4262 3AC1FC          13      LD  A,(EXPTBL)      ;スロット#0
000265 4265 E680             7      AND 080H
000267 4267 CD8842          17      CALL    CHK_RAM_SLT
00026A 426A C8              11      RET Z
00026B 426B 3AC2FC          13      LD  A,(EXPTBL+1)        ;スロット#1
00026E 426E E680             7      AND 080H
000270 4270 C601             7      ADD A,1
000272 4272 CD8842          17      CALL    CHK_RAM_SLT
000275 4275 C8              11      RET Z
000276 4276 3AC3FC          13      LD  A,(EXPTBL+2)        ;スロット#2
000279 4279 E680             7      AND 080H
00027B 427B C602             7      ADD A,2
00027D 427D CD8842          17      CALL    CHK_RAM_SLT
000280 4280 C8              11      RET Z
000281 4281 3AC4FC          13      LD  A,(EXPTBL+3)        ;スロット#3
000284 4284 E680             7      AND 080H
000286 4286 C603             7      ADD A,3
       4288                     CHK_RAM_SLT:
000288 4288 E5              11      PUSH    HL
000289 4289 CDB142          17      CALL    CHK_RAM0        ;スロット#X or X-0
00028C 428C E1              10      POP HL
00028D 428D C8              11      RET Z
00028E 428E CB79             8      BIT 7,C
000290 4290 281A            12      JR  Z,CHK_RAM_E     ;スロットは拡張されていない
000292 4292 79               4      LD  A,C
000293 4293 C604             7      ADD A,4         ;スロット#X-1
000295 4295 E5              11      PUSH    HL
000296 4296 CDB142          17      CALL    CHK_RAM0
000299 4299 E1              10      POP HL
00029A 429A C8              11      RET Z
00029B 429B 79               4      LD  A,C
00029C 429C C604             7      ADD A,4         ;スロット#X-2
00029E 429E E5              11      PUSH    HL
00029F 429F CDB142          17      CALL    CHK_RAM0
0002A2 42A2 E1              10      POP HL
0002A3 42A3 C8              11      RET Z
0002A4 42A4 79               4      LD  A,C
0002A5 42A5 C604             7      ADD A,4         ;スロット#X-3
0002A7 42A7 E5              11      PUSH    HL
0002A8 42A8 CDB142          17      CALL    CHK_RAM0
0002AB 42AB E1              10      POP HL
       42AC                     CHK_RAM_E:
0002AC 42AC AF               4      XOR A
0002AD 42AD 3C               4      INC A           ;ZF=0にする
0002AE 42AE 3E00             7      LD  A,0
0002B0 42B0 C9              10      RET
                                
       42B1                     CHK_RAM0:
0002B1 42B1 4F               4      LD  C,A
0002B2 42B2 3AFCF0          13      LD  A,(ROM_SLT)
0002B5 42B5 B9               4      CP  C
0002B6 42B6 28F4            12      JR  Z,CHK_RAM_E
0002B8 42B8 2E00             7      LD  L,0
       42BA                     CHK_RAM1:
0002BA 42BA 79               4      LD  A,C
0002BB 42BB DD210C00        14      LD  IX,_RDSLT
0002BF 42BF CDEC42          17      CALL    CALSLT_R
0002C2 42C2 C6E5             7      ADD A,0E5H
0002C4 42C4 47               4      LD  B,A
0002C5 42C5 5F               4      LD  E,A
0002C6 42C6 79               4      LD  A,C
0002C7 42C7 DD211400        14      LD  IX,_WRSLT
0002CB 42CB CDEC42          17      CALL    CALSLT_R
0002CE 42CE 79               4      LD  A,C
0002CF 42CF DD210C00        14      LD  IX,_RDSLT
0002D3 42D3 CDEC42          17      CALL    CALSLT_R
0002D6 42D6 B8               4      CP  B
0002D7 42D7 C0              11      RET NZ
0002D8 42D8 D6E5             7      SUB 0E5H
0002DA 42DA 79               4      LD  A,C
0002DB 42DB 5F               4      LD  E,A
0002DC 42DC DD211400        14      LD  IX,_WRSLT
0002E0 42E0 CDEC42          17      CALL    CALSLT_R
0002E3 42E3 24               4      INC H
0002E4 42E4 7D               4      LD  A,L
0002E5 42E5 C604             7      ADD A,4
0002E7 42E7 6F               4      LD  L,A
0002E8 42E8 20D0            12      JR  NZ,CHK_RAM1
0002EA 42EA 79               4      LD  A,C     ;ZF=1のハズ
0002EB 42EB C9              10      RET
                                
       42EC                     CALSLT_R:
0002EC 42EC C5              11      PUSH    BC
0002ED 42ED E5              11      PUSH    HL
0002EE 42EE FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
0002F2 42F2 CD1C00          17      CALL    _CALSLT
0002F5 42F5 E1              10      POP HL
0002F6 42F6 C1              10      POP BC
0002F7 42F7 C9              10      RET
                                
       42F8                     AT_ISC:
0002F8 F0E9                         ORG ISC,AT_ISC-RUN
       F0E9                     REPLACE_COMMAND:
0002F8 F0E9 FEB7             7      CP  0B7H            ;FILES
0002FA F0EB CC7BFE          17      CALL    Z,H_FILE
0002FD F0EE FEB5             7      CP  0B5H            ;LOAD
0002FF F0F0 CA71FE          10      JP  Z,H_BINS
000302 F0F3 FE8A             7      CP  08AH            ;RUN
000304 F0F5 CA76FE          10      JP  Z,H_BINL
000307 F0F8 FECF             7      CP  0CFH            ;BLOAD
000309 F0FA C0              11      RET NZ
       F0FB                     FIX_BLOAD:
00030A F0FB F7              12      RST 30H
       F0FC                     ROM_SLT:
00030B F0FC 00                      DB  0
00030C F0FD 7C45                    DW  ROM_BLOAD
00030E F0FF F5              11      PUSH    AF
00030F F100 E5              11      PUSH    HL
000310 F101 CD0AF1          17      CALL    BLOAD_RET
       F102                     SWC_BLOAD   EQU $-2
000313 F104 E1              10      POP HL
000314 F105 F1              10      POP AF
000315 F106 FECF             7      CP  0CFH            ;BLOAD
       F108                     SWC_BLOAD_M:
000317 F108 28DF            12      JR  Z,REPLACE_COMMAND
       F10A                     BLOAD_RET:
000319 F10A C9              10      RET
       F10B                     ROMUSE1:
00031A F10B 3AFCF0          13      LD  A,(ROM_SLT)
00031D F10E 1803            12      JR  ROMUSE2
       F110                     RAMUSE1:
00031F F110 3A42F3          13      LD  A,(RAMAD1)
       F113                     ROMUSE2:
000322 F113 C32400          10      JP  _ENASLT
                                
       F116                     _RESULT:
000325 F116 00                      DB  0
       F117                     _BANK:
000326 F117 00                      DB  0
       F118                     CLSZ:               ;クラスタサイズ
000327 F118 0004                    DW  1024
       F119                     CLSZ_H  EQU $-1     ;クラスタサイズ上位8ビット
       F11A                     SECSZ:              ;セクタサイズ
000329 F11A 0002                    DW  512
       F11B                     SECSZ_H EQU $-1     ;セクタサイズ上位8ビット
       F11C                     RR_LOW:
00032B F11C 0000                    DW  0
       F11D                     RR_MID  EQU $-1
       F11E                     RR_HIGH:
00032D F11E 0000                    DW  0
       F120                     _CLPS:
00032F F120 0000                    DW  0
       F122                     _LEFT:
000331 F122 0000                    DW  0
       F124                     _DTPS:
000333 F124 0000                    DW  0
       F126                     _DTA:
000335 F126 0000                    DW  0
                                #if exists USE_RAM_BLOAD_S
                                #else
       F128                     FLG_LDIR:
000337 F128 00                      DB  0
                                #endif
                                ;   BDOS
000338 F129 F7              12      RST 30H
000339 F12A 00                      DB  0
00033A F12B 0F4D                    DW  ROM_BDOS
00033C F12D C9              10      RET 
       F12E                     _FCB:
00033D F12E 0000                    DW  0
       F130                     _BUF:
00033F F130 00                      DB  0
       F131                     _BUF_ST:
000340 F131 0000                    DW  0
       F133                     _BUF_EN:
000342 F133 0000                    DW  0
       F135                     _BUF_EX:
000344 F135 0000                    DW  0
                                
       F137                     DTAX:
000346 F137 0000                    DW  0
       F139                     B_DRIVE:
000348 F139 00                      DB  0
       F13A                     _DVSW:
000349 F13A 00                      DB  0
       F13B                     FCBX:
00034A F13B 0000                    DW  0
       F13D                     LEFTX:
00034C F13D 0000                    DW  0
       F13F                     PARAM0:
00034E F13F 0000                    DW  0
       F141                     PARAM1:
000350 F141 0000                    DW  0
       F143                     FDRV:
000352 F143 00                      DB  0
       F144                     FNAME:
000353 F144                         DS  8+3
                                
       F14F                     BASSTK:
00035E F14F 0000                    DW  0
       F151                     _HL:
000360 F151 0000                    DW  0
       F153                     _SP:
000362 F153 0000                    DW  0
                                
       F155                     ISC_E:
000364 4364                         ORG $$+RUN          ;$DEPHASE
                                
       4364                     MSX1:
000364 4364 CD284D          17      CALL    MSGA1
       4367                     MSX:
000367 4367 7E               7      LD  A,(HL)
000368 4368 23               6      INC HL
000369 4369 B7               4      OR  A
00036A 436A 20F8            12      JR  NZ,MSX1
00036C 436C C9              10      RET
                                
       436D                     PRTHX:
00036D 436D F5              11      PUSH    AF
00036E 436E 07               4      RLCA
00036F 436F 07               4      RLCA
000370 4370 07               4      RLCA
000371 4371 07               4      RLCA
000372 4372 CD7643          17      CALL    PRTA2
000375 4375 F1              10      POP AF
       4376                     PRTA2:
000376 4376 CD7C43          17      CALL    ASC
000379 4379 C3244D          10      JP  MSG_A
                                    
       437C                     ASC:
00037C 437C E60F             7      AND $0F
00037E 437E F630             7      OR  $30
000380 4380 FE3A             7      CP  $3A
000382 4382 D8              11      RET C
000383 4383 C607             7      ADD A,7
000385 4385 C9              10      RET
                                
       4386                     MSN:
000386 4386 7E               7      LD  A,(HL)
000387 4387 23               6      INC HL
000388 4388 CD244D          17      CALL    MSG_A
00038B 438B 10F9            13      DJNZ    MSN
00038D 438D C9              10      RET
                                
       438E                     ROM_STKE:
00038E 438E 3E                      DB  03EH
00038F 438F C9              10      RET
000390 4390 32DAFE          13      LD  (H_STKE),A
000393 4393 E5              11      PUSH    HL
000394 4394 D5              11      PUSH    DE
000395 4395 C5              11      PUSH    BC
000396 4396 181D            12      JR  BASAUTO
                                
000398 4398 AF               4      XOR A
000399 4399 5F               4      LD  E,A
00039A 439A 57               4      LD  D,A
00039B 439B 0601             7      LD  B,1
00039D 439D 2100C0          10      LD  HL,0C000H
0003A0 43A0 CD324B          17      CALL    DISKIO
                                
0003A3 43A3 ED734FF1        20      LD  (BASSTK),SP
0003A7 43A7 116BF3          10      LD  DE,RAMUSE
0003AA 43AA AF               4      XOR A
0003AB 43AB CD1EC0          17      CALL    0C01EH
0003AE 43AE 116BF3          10      LD  DE,RAMUSE
0003B1 43B1 37               4      SCF
0003B2 43B2 CD1EC0          17      CALL    0C01EH
       43B5                     BASAUTO:
0003B5 43B5 210244          10      LD  HL,AUTOEXEC
0003B8 43B8 1143F1          10      LD  DE,FDRV
0003BB 43BB 010C00          10      LD  BC,1+8+3
0003BE 43BE EDB0                    LDIR
0003C0 43C0 CDA848          17      CALL    ROM_OPEN
0003C3 43C3 3813            12      JR  C,RSTKEE
0003C5 43C5 210E44          10      LD  HL,RUN_AUTOEXEC
0003C8 43C8 11F0FB          10      LD  DE,KEYBUF
0003CB 43CB ED53FAF3        20      LD  (GETPNT),DE
0003CF 43CF 011300          10      LD  BC,RUN_AUTOEXEC_E-RUN_AUTOEXEC
0003D2 43D2 EDB0                    LDIR
0003D4 43D4 ED53F8F3        20      LD  (PUTPNT),DE
       43D8                     RSTKEE:
0003D8 43D8 C1              10      POP BC
0003D9 43D9 D1              10      POP DE
0003DA 43DA E1              10      POP HL
0003DB 43DB C9              10      RET
                                
       43DC                     MSG_ERROR_ROM_MODE:
0003DC 43DC 41534349492D384B        DB  "ASCII-8K/Konami-8K/Konami-SCC only!",13,10
            2F4B6F6E616D692D    
            384B2F4B6F6E616D    
            692D534343206F6E    
            6C79210D0A          
       4401                     NULL:
000401 4401 00                      DB  0
                                
       4402                     AUTOEXEC:
000402 4402 004155544F455845        DB  0,"AUTOEXECBAS"
            43424153            
       440E                     RUN_AUTOEXEC:
00040E 440E 52554E2022415554        DB  'RUN "AUTOEXEC.BAS"',00DH
            4F455845432E4241    
            53220D              
                                ;   DB  'LOAD "AUTOEXEC.BAS"',00DH  ;テスト用
       4421                     RUN_AUTOEXEC_E:
[EOF:INIT.ASM:UTF_8]
                                    INCLUDE "FILE.ASM"
       4421                     ROM_LDIR:
                                #if exists USE_RAM_BLOAD_S
                                #else
000421 4421 3A28F1          13      LD  A,(FLG_LDIR)
000424 4424 B7               4      OR  A
000425 4425 2008            12      JR  NZ,ROM_LDIRVM
                                #endif
000427 4427 CB7A             8      BIT 7,D
000429 4429 CA4144          10      JP  Z,ROM_LDIRSLT
                                
                                #if exists USE_NORMAL_32K_ROM
                                    LD  (_SP),SP
                                    LD  SP,DRVTBL
                                LDIR1:
                                    LD  A,B
                                    OR  C
                                    JR  Z,LDIRE
                                
                                    PUSH    BC
                                    PUSH    DE
                                    PUSH    HL
                                    LD  A,(ROM_SLT)
                                    LD  H,080H
                                    CALL    _ENASLT
                                    POP HL
                                    POP DE
                                    POP BC
                                LDIR2:
                                    LD  A,D
                                    CP  0C0H
                                    JR  NC,LDIR4
                                
                                    PUSH    BC
                                    PUSH    DE
                                    LD  DE,BUF
                                
                                    LD  A,B
                                    OR  A
                                    JR  Z,LDIR3
                                    LD  BC,00100H
                                LDIR3:
                                    PUSH    BC
                                    LDIR
                                    LD  (_HL),HL
                                
                                    LD  A,(RAMAD2)
                                    LD  H,080H
                                    CALL    _ENASLT
                                
                                    LD  HL,BUF
                                    POP BC
                                    POP DE
                                    LDIR
                                
                                    LD  HL,(_HL)
                                    POP BC
                                    LD  A,B
                                    OR  A
                                    JR  Z,LDIRE
                                    DEC B
                                    JR  LDIR1
                                LDIR4:
                                #endif
00042C 442C EDB0                    LDIR
                                
                                #if exists USE_NORMAL_32K_ROM
                                LDIRE:
                                    PUSH    DE
                                    PUSH    HL
                                    LD  A,(RAMAD2)
                                    LD  H,080H
                                    CALL    _ENASLT
                                    POP HL
                                    POP DE
                                    LD  SP,(_SP)
                                #endif
00042E 442E C9              10      RET
                                
       442F                     ROM_LDIRVM:
                                #if exists USE_NORMAL_32K_ROM
                                    PUSH    BC
                                    PUSH    DE
                                    PUSH    HL
                                    LD  A,(ROM_SLT)
                                    LD  H,080H
                                    CALL    _ENASLT
                                    POP HL
                                    POP DE
                                    POP BC
                                #endif
00042F 442F C5              11      PUSH    BC
000430 4430 D5              11      PUSH    DE
000431 4431 FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
000435 4435 DD215C00        14      LD  IX,LDIRVM
000439 4439 CD1C00          17      CALL    _CALSLT
                                #if exists USE_NORMAL_32K_ROM
                                    LD  H,080H
                                    LD  A,(RAMAD2)
                                    CALL    _ENASLT
                                #endif
00043C 443C E1              10      POP HL
00043D 443D C1              10      POP BC
00043E 443E 09              11      ADD HL,BC
00043F 443F EB               4      EX  DE,HL
000440 4440 C9              10      RET
                                
       4441                     ROM_LDIRSLT:
000441 4441 EB               4      EX  DE,HL
       4442                     RLDIRSLT1:
000442 4442 1A               7      LD  A,(DE)
000443 4443 13               6      INC DE
000444 4444 C5              11      PUSH    BC
000445 4445 D5              11      PUSH    DE
000446 4446 E5              11      PUSH    HL
000447 4447 5F               4      LD  E,A
000448 4448 3A42F3          13      LD  A,(RAMAD1)
00044B 444B FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
00044F 444F DD211400        14      LD  IX,_WRSLT
000453 4453 CD1C00          17      CALL    _CALSLT
000456 4456 E1              10      POP HL
000457 4457 D1              10      POP DE
000458 4458 C1              10      POP BC
000459 4459 EDA1            16      CPI         ;HL=HL+1 BC=BC-1 BCが0の場合にP/V=0
00045B 445B EA4244          10      JP  PE,RLDIRSLT1
00045E 445E EB               4      EX  DE,HL
00045F 445F C9              10      RET
                                
       4460                     END_OF_LINE:
000460 4460 215EF5          10      LD  HL,BUF
       4463                     EOL1:
000463 4463 7E               7      LD  A,(HL)
000464 4464 C8              11      RET Z
000465 4465 FE0D             7      CP  00DH
000467 4467 2807            12      JR  Z,EOLE
000469 4469 FE0A             7      CP  00AH
00046B 446B 2803            12      JR  Z,EOLE
00046D 446D 23               6      INC HL
00046E 446E 18F3            12      JR  EOL1
       4470                     EOLE:
000470 4470 3600            10      LD  (HL),0
000472 4472 23               6      INC HL
000473 4473 7E               7      LD  A,(HL)
000474 4474 FE0A             7      CP  00AH
000476 4476 C0              11      RET NZ
000477 4477 23               6      INC HL
000478 4478 C9              10      RET
                                
       4479                     ROM_LOAD_ASCII:
000479 4479 210000          10      LD  HL,0
00047C 447C 2231F1          16      LD  (_BUF_ST),HL    ;読み出し位置
00047F 447F 2A76F6          16      LD  HL,(TXTTAB)
000482 4482 2233F1          16      LD  (_BUF_EN),HL    ;書き出し位置
                                
000485 4485 215EF5          10      LD  HL,BUF
000488 4488 2226F1          16      LD  (_DTA),HL
       448B                     RLOAD_A1:
00048B 448B 2A31F1          16      LD  HL,(_BUF_ST)
00048E 448E 221CF1          16      LD  (RR_LOW),HL
000491 4491 210201          10      LD  HL,258
000494 4494 CDC846          17      CALL    ROM_READ
000497 4497 7C               4      LD  A,H
000498 4498 B5               4      OR  L
000499 4499 2877            12      JR  Z,RLOAD_AEND
00049B 449B 015EF5          10      LD  BC,BUF
00049E 449E 09              11      ADD HL,BC
00049F 449F 3600            10      LD  (HL),0
0004A1 44A1 CD6044          17      CALL    END_OF_LINE
0004A4 44A4 015EF5          10      LD  BC,BUF
0004A7 44A7 A7               4      AND A
0004A8 44A8 ED42            15      SBC HL,BC
0004AA 44AA 2810            12      JR  Z,RLOAD_A2
0004AC 44AC 4D               4      LD  C,L
0004AD 44AD 44               4      LD  B,H
0004AE 44AE ED5B31F1        20      LD  DE,(_BUF_ST)
0004B2 44B2 19              11      ADD HL,DE
0004B3 44B3 2231F1          16      LD  (_BUF_ST),HL
0004B6 44B6 3A5EF5          13      LD  A,(BUF)
0004B9 44B9 B7               4      OR  A
0004BA 44BA 28CF            12      JR  Z,RLOAD_A1
       44BC                     RLOAD_A2:
0004BC 44BC 115EF5          10      LD  DE,BUF
0004BF 44BF CD3F48          17      CALL    SPCUTEX
0004C2 44C2 1A               7      LD  A,(DE)
0004C3 44C3 B7               4      OR  A
0004C4 44C4 284C            12      JR  Z,RLOAD_AEND
0004C6 44C6 CD5148          17      CALL    GETNUM
0004C9 44C9 7C               4      LD  A,H
0004CA 44CA B5               4      OR  L
0004CB 44CB CA6945          10      JP  Z,ERROR_DIRECT_IN_FILE
0004CE 44CE DD2A33F1        20      LD  IX,(_BUF_EN)
0004D2 44D2 DD7502          19      LD  (IX+2),L
0004D5 44D5 DD7403          19      LD  (IX+3),H
                                
0004D8 44D8 CD3848          17      CALL    SPCUT
0004DB 44DB EB               4      EX  DE,HL
0004DC 44DC DDE5            15      PUSH    IX
0004DE 44DE DD21B242        14      LD  IX,CRUNCH
0004E2 44E2 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
0004E6 44E6 CD1C00          17      CALL    _CALSLT
0004E9 44E9 DDE1            14      POP IX
0004EB 44EB EB               4      EX  DE,HL
0004EC 44EC 111FF4          10      LD  DE,KBUF
0004EF 44EF 37               4      SCF
0004F0 44F0 ED52            15      SBC HL,DE
0004F2 44F2 2875            12      JR  Z,ERROR_DIRECT_IN_FILE
0004F4 44F4 3873            12      JR  C,ERROR_DIRECT_IN_FILE
0004F6 44F6 4D               4      LD  C,L
0004F7 44F7 44               4      LD  B,H
0004F8 44F8 2A33F1          16      LD  HL,(_BUF_EN)
0004FB 44FB 110400          10      LD  DE,4
0004FE 44FE 19              11      ADD HL,DE
0004FF 44FF 111FF4          10      LD  DE,KBUF
                                
000502 4502 EB               4      EX  DE,HL
000503 4503 EDB0                    LDIR
000505 4505 EB               4      EX  DE,HL
                                
000506 4506 DD7500          19      LD  (IX+0),L
000509 4509 DD7401          19      LD  (IX+1),H
00050C 450C 2233F1          16      LD  (_BUF_EN),HL
00050F 450F C38B44          10      JP  RLOAD_A1
                                
       4512                     RLOAD_AEND:
000512 4512 2A33F1          16      LD  HL,(_BUF_EN)
000515 4515 AF               4      XOR A
000516 4516 77               7      LD  (HL),A
000517 4517 23               6      INC HL
000518 4518 77               7      LD  (HL),A
000519 4519 23               6      INC HL
00051A 451A 2233F1          16      LD  (_BUF_EN),HL
00051D 451D 1833            12      JR  RLOAD_END1
                                
       451F                     ROM_LOAD:
00051F 451F CD9D46          17      CALL    INIT_PARAM
000522 4522 CD6847          17      CALL    FILE_B
000525 4525 CDA848          17      CALL    ROM_OPEN
000528 4528 3845            12      JR  C,ERROR_FILE_NOT_FOUND
                                
00052A 452A 2130F1          10      LD  HL,_BUF
00052D 452D 2226F1          16      LD  (_DTA),HL
000530 4530 210100          10      LD  HL,1            ;ヘッダを1バイト読み込む
000533 4533 CDC846          17      CALL    ROM_READ
000536 4536 3A30F1          13      LD  A,(_BUF)
000539 4539 3C               4      INC A
00053A 453A C27944          10      JP  NZ,ROM_LOAD_ASCII
00053D 453D 2A76F6          16      LD  HL,(TXTTAB)
000540 4540 2226F1          16      LD  (_DTA),HL
000543 4543 EB               4      EX  DE,HL
000544 4544 2100FF          10      LD  HL,-256
000547 4547 39              11      ADD HL,SP
000548 4548 ED52            15      SBC HL,DE
00054A 454A CDC846          17      CALL    ROM_READ
00054D 454D ED5B26F1        20      LD  DE,(_DTA)
000551 4551 19              11      ADD HL,DE
       4552                     RLOAD_END1:
000552 4552 22C2F6          16      LD  (VARTAB),HL
000555 4555 22C4F6          16      LD  (ARYTAB),HL
000558 4558 22C6F6          16      LD  (STREND),HL
                                
00055B 455B AF               4      XOR A
00055C 455C 2133F1          10      LD  HL,_BUF+3
00055F 455F 77               7      LD  (HL),A
000560 4560 2B               6      DEC HL
000561 4561 77               7      LD  (HL),A
000562 4562 2B               6      DEC HL
000563 4563 77               7      LD  (HL),A
000564 4564 2B               6      DEC HL
000565 4565 3E8F             7      LD  A,08FH          ;REM
000567 4567 77               7      LD  (HL),A
000568 4568 C9              10      RET
                                
       4569                     ERROR_DIRECT_IN_FILE:
000569 4569 1E39             7      LD  E,57            ;Direct statement in file
00056B 456B 01                      DB  1           ;LD BC,
       456C                     ERROR_FILE_NOT_OPEN:
00056C 456C 1E3B             7      LD  E,59            ;File not OPEN
00056E 456E 01                      DB  1           ;LD BC,
       456F                     ERROR_FILE_NOT_FOUND:
00056F 456F 1E35             7      LD  E,53            ;File not found
       4571                     ERROR:
000571 4571 FD2AC0FC        20      LD  IY,(EXPTBL-1) ;メインROMスロット
000575 4575 DD216F40        14      LD  IX,ERRHAND
000579 4579 C31C00          10      JP  _CALSLT
                                
       457C                     ROM_BLOAD:
00057C 457C CD9D46          17      CALL    INIT_PARAM
00057F 457F CD6847          17      CALL    FILE_B
000582 4582 CDA848          17      CALL    ROM_OPEN
000585 4585 38E8            12      JR  C,ERROR_FILE_NOT_FOUND
                                
000587 4587 2130F1          10      LD  HL,_BUF
00058A 458A 2226F1          16      LD  (_DTA),HL
00058D 458D 210700          10      LD  HL,7            ;ヘッダを7バイト読み込む
000590 4590 CDC846          17      CALL    ROM_READ
000593 4593 3A30F1          13      LD  A,(_BUF)
000596 4596 FEFE             7      CP  0FEH
000598 4598 20D2            12      JR  NZ,ERROR_FILE_NOT_OPEN
                                
00059A 459A 210AF1          10      LD  HL,BLOAD_RET
00059D 459D 2202F1          16      LD  (SWC_BLOAD),HL
                                
0005A0 45A0 2A41F1          16      LD  HL,(PARAM1)
0005A3 45A3 7E               7      LD  A,(HL)
0005A4 45A4 FE2C             7      CP  ','
0005A6 45A6 2048            12      JR  NZ,RBREAD_MEM
0005A8 45A8 23               6      INC HL
0005A9 45A9 7E               7      LD  A,(HL)
0005AA 45AA CD9248          17      CALL    CAP
0005AD 45AD 32BEFC          13      LD  (RUNBNF),A
       45B0                     RBOS1:
0005B0 45B0 7E               7      LD  A,(HL)
0005B1 45B1 23               6      INC HL
0005B2 45B2 B7               4      OR  A
0005B3 45B3 282F            12      JR  Z,RBREAD_OSE
0005B5 45B5 FE3A             7      CP  ':'
0005B7 45B7 282B            12      JR  Z,RBREAD_OSE
0005B9 45B9 FE2C             7      CP  ','     ;次のパラメータを探す
0005BB 45BB 20F3            12      JR  NZ,RBOS1
                                                ;オフセット
0005BD 45BD 2241F1          16      LD  (PARAM1),HL
0005C0 45C0 7E               7      LD  A,(HL)
0005C1 45C1 B7               4      OR  A
0005C2 45C2 2820            12      JR  Z,RBREAD_OSE
0005C4 45C4 DD21644C        14      LD  IX,FRMEVL
0005C8 45C8 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
0005CC 45CC CD1C00          17      CALL    _CALSLT
0005CF 45CF 2241F1          16      LD  (PARAM1),HL
0005D2 45D2 3A63F6          13      LD  A,(VALTYP)
0005D5 45D5 FE02             7      CP  2
0005D7 45D7 200B            12      JR  NZ,RBREAD_OSE
0005D9 45D9 2A31F1          16      LD  HL,(_BUF_ST)
0005DC 45DC ED5BF8F7        20      LD  DE,(DACDAT)
0005E0 45E0 19              11      ADD HL,DE
0005E1 45E1 2231F1          16      LD  (_BUF_ST),HL
       45E4                     RBREAD_OSE:
0005E4 45E4 3ABEFC          13      LD  A,(RUNBNF)
0005E7 45E7 FE53             7      CP  'S'
                                #if exists USE_RAM_BLOAD_S
                                    JR  Z,ROM_BLOAD_SCREEN
                                #else
0005E9 45E9 2005            12      JR  NZ,RBREAD_MEM
0005EB 45EB 3E01             7      LD  A,1
0005ED 45ED 3228F1          13      LD  (FLG_LDIR),A
                                #endif
       45F0                     RBREAD_MEM:
0005F0 45F0 2A31F1          16      LD  HL,(_BUF_ST)
0005F3 45F3 22BFFC          16      LD  (SAVENT),HL
0005F6 45F6 2226F1          16      LD  (_DTA),HL
0005F9 45F9 21FFFF          10      LD  HL,0FFFFH
0005FC 45FC CDC846          17      CALL    ROM_READ
0005FF 45FF 3ABEFC          13      LD  A,(RUNBNF)
000602 4602 FE52             7      CP  'R'
000604 4604 2006            12      JR  NZ,RBREAD1
000606 4606 2A35F1          16      LD  HL,(_BUF_EX)
000609 4609 2202F1          16      LD  (SWC_BLOAD),HL
       460C                     RBREAD1:
       460C                     ROM_NEXT:
00060C 460C 2A41F1          16      LD  HL,(PARAM1)
00060F 460F 7E               7      LD  A,(HL)
000610 4610 2B               6      DEC HL
000611 4611 B7               4      OR  A
000612 4612 2805            12      JR  Z,RN1
000614 4614 FE3A             7      CP  ':'
000616 4616 2801            12      JR  Z,RN1
000618 4618 23               6      INC HL
       4619                     RN1:
000619 4619 5D               4      LD  E,L
00061A 461A 54               4      LD  D,H
                                
00061B 461B CD6848          17      CALL    SEARCH_END
00061E 461E B7               4      OR  A
00061F 461F 2815            12      JR  Z,REM
                                                    ;マルチステートメントの処理
000621 4621 7E               7      LD  A,(HL)
                                
000622 4622 FEB5             7      CP  0B5H            ;LOAD
000624 4624 CA1F45          10      JP  Z,ROM_LOAD
000627 4627 FE8A             7      CP  08AH            ;RUN
000629 4629 280F            12      JR  Z,ROM_RUN
00062B 462B FEB7             7      CP  0B7H            ;FILES
00062D 462D 2818            12      JR  Z,ROM_FILES
00062F 462F 3E28             7      LD  A,028H          ;JR Z,
000631 4631 3208F1          13      LD  (SWC_BLOAD_M),A
000634 4634 7E               7      LD  A,(HL)
000635 4635 C9              10      RET
                                
       4636                     REM:
000636 4636 EB               4      EX  DE,HL
000637 4637 3E8F             7      LD  A,08FH          ;REM
000639 4639 C9              10      RET
                                
                                #if exists USE_RAM_BLOAD_S
                                ROM_BLOAD_SCREEN:
                                    LD  HL,(STREND)
                                    LD  (_DTA),HL
                                    EX  DE,HL
                                    LD  HL,-512
                                    ADD HL,SP
                                    XOR A
                                    SBC HL,DE
                                    JR  NC,RBS0
                                    LD  HL,BUF
                                    LD  (_DTA),HL
                                    LD  L,A ;0
                                    LD  H,A ;0
                                RBS0:
                                    INC H
                                    LD  (_BUF_EN),HL
                                RBS1:
                                    LD  HL,(_BUF_EN)
                                    CALL    ROM_READ
                                    LD  A,H
                                    OR  L
                                    JR  Z,ROM_NEXT
                                
                                    PUSH    HL
                                    LD  C,L
                                    LD  B,H
                                    LD  HL,(_DTA)   ;転送元
                                    LD  DE,(_BUF_ST)    ;転送先
                                
                                    LD  IY,(EXPTBL-1)   ;メインROMスロット
                                    LD  IX,LDIRVM
                                    CALL    _CALSLT
                                
                                    LD  HL,(_BUF_ST)
                                    POP DE
                                    ADD HL,DE
                                    LD  (_BUF_ST),HL
                                    JR  RBS1
                                #endif
                                
       463A                     ROM_RUN:
00063A 463A 23               6      INC HL
00063B 463B 7E               7      LD  A,(HL)
00063C 463C 2B               6      DEC HL
00063D 463D B7               4      OR  A
00063E 463E 2803            12      JR  Z,ROM_RUN1
000640 4640 CD1F45          17      CALL    ROM_LOAD
       4643                     ROM_RUN1:
000643 4643 3E8A             7      LD  A,08AH          ;RUN
000645 4645 77               7      LD  (HL),A
000646 4646 C9              10      RET
                                
       4647                     ROM_FILES:
000647 4647 CD9D46          17      CALL    INIT_PARAM
00064A 464A CD6847          17      CALL    FILE_B
00064D 464D CDC74C          17      CALL    GET_DISK_BANK_FDRV
000650 4650 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000653 4653 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000656 4656 3A44F1          13      LD  A,(FNAME)
000659 4659 FE21             7      CP  021H
00065B 465B 3005            12      JR  NC,RFILES0
00065D 465D 060B             7      LD  B,11
00065F 465F CDFC47          17      CALL    FILE10
       4662                     RFILES0:
000662 4662 CDF04A          17      CALL    GET_DIR_DAT
       4665                     RFILES1:
000665 4665 CDC448          17      CALL    FILESE
000668 4668 302E            12      JR  NC,RFILES_NOT_MATCH
       466A                     RFILES_DISP:
00066A 466A E5              11      PUSH    HL
00066B 466B 0608             7      LD  B,8
00066D 466D CD8643          17      CALL    MSN
000670 4670 3E2E             7      LD  A,'.'
000672 4672 CD244D          17      CALL    MSG_A
000675 4675 0603             7      LD  B,3
000677 4677 CD8643          17      CALL    MSN
00067A 467A 3ADDF3          13      LD  A,(CSRX)
00067D 467D 47               4      LD  B,A
00067E 467E 3AB0F3          13      LD  A,(LINLEN)
000681 4681 90               4      SUB B
000682 4682 FE0C             7      CP  12
000684 4684 3009            12      JR  NC,RFILES2
000686 4686 3E0D             7      LD  A,00DH      ;改行
000688 4688 CD244D          17      CALL    MSG_A
00068B 468B 3E0A             7      LD  A,00AH
00068D 468D 1802            12      JR  RFILES3
       468F                     RFILES2:
00068F 468F 3E20             7      LD  A,020H
       4691                     RFILES3:
000691 4691 CD244D          17      CALL    MSG_A
000694 4694 E1              10      POP HL
000695 4695 CDE048          17      CALL    FNEXT
       4698                     RFILES_NOT_MATCH:
000698 4698 20CB            12      JR  NZ,RFILES1
00069A 469A C30C46          10      JP  ROM_NEXT
                                
       469D                     INIT_PARAM:
00069D 469D 223FF1          16      LD  (PARAM0),HL
0006A0 46A0 2241F1          16      LD  (PARAM1),HL
0006A3 46A3 EB               4      EX  DE,HL
0006A4 46A4 AF               4      XOR A
                                #if exists USE_RAM_BLOAD_S
                                #else
0006A5 46A5 3228F1          13      LD  (FLG_LDIR),A
                                #endif
0006A8 46A8 32BEFC          13      LD  (RUNBNF),A
0006AB 46AB 3263F6          13      LD  (VALTYP),A
0006AE 46AE 13               6      INC DE
0006AF 46AF CD3848          17      CALL    SPCUT
0006B2 46B2 1A               7      LD  A,(DE)
0006B3 46B3 B7               4      OR  A
0006B4 46B4 C8              11      RET Z
0006B5 46B5 FE3A             7      CP  ':'
0006B7 46B7 C8              11      RET Z
0006B8 46B8 EB               4      EX  DE,HL
0006B9 46B9 DD21644C        14      LD  IX,FRMEVL
0006BD 46BD FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
0006C1 46C1 CD1C00          17      CALL    _CALSLT
0006C4 46C4 2241F1          16      LD  (PARAM1),HL
0006C7 46C7 C9              10      RET
                                
       46C8                     ROM_READ:
0006C8 46C8 E5              11      PUSH    HL
0006C9 46C9 D5              11      PUSH    DE
0006CA 46CA C5              11      PUSH    BC
0006CB 46CB FDE5            15      PUSH    IY
0006CD 46CD 223DF1          16      LD  (LEFTX),HL
0006D0 46D0 2A26F1          16      LD  HL,(_DTA)
0006D3 46D3 2237F1          16      LD  (DTAX),HL
0006D6 46D6 2A3DF1          16      LD  HL,(LEFTX)
                                
0006D9 46D9 CD2349          17      CALL    RBX1
0006DC 46DC 3870            12      JR  C,RBRERR1
0006DE 46DE 79               4      LD  A,C
0006DF 46DF EB               4      EX  DE,HL
0006E0 46E0 ED52            15      SBC HL,DE       ;CP 0HL,CDE
0006E2 46E2 19              11      ADD HL,DE
0006E3 46E3 DE00             7      SBC A,000H
0006E5 46E5 3801            12      JR  C,RBR1
0006E7 46E7 EB               4      EX  DE,HL
       46E8                     RBR1:
0006E8 46E8 9F               4      SBC A,A
0006E9 46E9 E601             7      AND 1
0006EB 46EB 3216F1          13      LD  (_RESULT),A
0006EE 46EE 7C               4      LD  A,H
0006EF 46EF B5               4      OR  L
0006F0 46F0 CA4447          10      JP  Z,RBREND0
                                
0006F3 46F3 2222F1          16      LD  (_LEFT),HL  ;Read record byte
0006F6 46F6 223DF1          16      LD  (LEFTX),HL
                                
0006F9 46F9 CD4949          17      CALL    RBX2
0006FC 46FC 281A            12      JR  Z,RBRB
                                                ;先頭の端数
0006FE 46FE CD5C49          17      CALL    RBXA
000701 4701 DA5A47          10      JP  C,RBRERR
000704 4704 C5              11      PUSH    BC
000705 4705 CD2144          17      CALL    ROM_LDIR
000708 4708 ED5337F1        20      LD  (DTAX),DE
00070C 470C 2A3DF1          16      LD  HL,(LEFTX)
00070F 470F D1              10      POP DE
000710 4710 A7               4      AND A
000711 4711 ED52            15      SBC HL,DE
000713 4713 223DF1          16      LD  (LEFTX),HL
000716 4716 2829            12      JR  Z,RBREND
                                
       4718                     RBRB:
000718 4718 CD9849          17      CALL    RBXB
00071B 471B 2818            12      JR  Z,RBRC
       471D                     RBRB1:
00071D 471D C5              11      PUSH    BC
00071E 471E D5              11      PUSH    DE
00071F 471F CD404A          17      CALL    CLUST
000722 4722 EB               4      EX  DE,HL
000723 4723 ED4B18F1        20      LD  BC,(CLSZ)       ;1クラスタのサイズ
000727 4727 CD2144          17      CALL    ROM_LDIR
00072A 472A EB               4      EX  DE,HL
00072B 472B D1              10      POP DE
00072C 472C C1              10      POP BC
00072D 472D CD1D4A          17      CALL    GNCL
000730 4730 DA5A47          10      JP  C,RBRERR
000733 4733 10E8            13      DJNZ    RBRB1
       4735                     RBRC:
000735 4735 CDB049          17      CALL    RBXC
000738 4738 2807            12      JR  Z,RBREND
                                
00073A 473A CD404A          17      CALL    CLUST
00073D 473D EB               4      EX  DE,HL
00073E 473E CD2144          17      CALL    ROM_LDIR
       4741                     RBREND:
000741 4741 CDBC49          17      CALL    RBXEND
       4744                     RBREND0:
000744 4744 FDE1            14      POP IY
000746 4746 C1              10      POP BC
000747 4747 D1              10      POP DE
000748 4748 F1              10      POP AF  ;(HL)
000749 4749 AF               4      XOR A
00074A 474A 3A16F1          13      LD  A,(_RESULT)
00074D 474D C9              10      RET
                                
       474E                     RBRERR1:
00074E 474E 3E01             7      LD  A,001H
       4750                     RBRERR2:
000750 4750 FDE1            14      POP IY
000752 4752 C1              10      POP BC
000753 4753 D1              10      POP DE
000754 4754 E1              10      POP HL
000755 4755 37               4      SCF
000756 4756 210000          10      LD  HL,0
000759 4759 C9              10      RET
       475A                     RBRERR:
00075A 475A 3EFF             7      LD  A,0FFH
00075C 475C 18F2            12      JR  RBRERR2
                                
       475E                     FILE_DD:
00075E 475E 3E                      DB  03EH
00075F 475F C9              10      RET
000760 4760 3208F1          13      LD  (SWC_BLOAD_M),A
000763 4763 2A3FF1          16      LD  HL,(PARAM0)
000766 4766 7E               7      LD  A,(HL)
000767 4767 C9              10      RET
       4768                     FILE_B:
000768 4768 AF               4      XOR A
000769 4769 3243F1          13      LD  (FDRV),A
00076C 476C 1E00             7      LD  E,0
00076E 476E 3A63F6          13      LD  A,(VALTYP)
000771 4771 FE03             7      CP  3       ;string
000773 4773 2044            12      JR  NZ,FILED
                                
000775 4775 DD21D067        14      LD  IX,FRESTR
000779 4779 FD2AC0FC        20      LD  IY,(EXPTBL-1)   ;メインROMスロット
00077D 477D CD1C00          17      CALL    _CALSLT
000780 4780 E5              11      PUSH    HL
000781 4781 DDE1            14      POP IX
                                
000783 4783 DD5E00          19      LD  E,(IX+0)
000786 4786 DD7E01          19      LD  A,(IX+1)
000789 4789 DD5602          19      LD  D,(IX+2)
00078C 478C DD62             9      LD  IXH,D
00078E 478E DD6F             9      LD  IXL,A
000790 4790 7B               4      LD  A,E
000791 4791 FE04             7      CP  4
000793 4793 3808            12      JR  C,FILEB1
000795 4795 DD7E03          19      LD  A,(IX+3)
000798 4798 FE3A             7      CP  ':'
00079A 479A 28C2            12      JR  Z,FILE_DD
00079C 479C 7B               4      LD  A,E
       479D                     FILEB1:
00079D 479D FE02             7      CP  2
00079F 479F 3818            12      JR  C,FILED
0007A1 47A1 DD7E01          19      LD  A,(IX+1)
0007A4 47A4 FE3A             7      CP  ':'
0007A6 47A6 2011            12      JR  NZ,DEVI1
0007A8 47A8 DD7E00          19      LD  A,(IX+0)        ;DRIVE
0007AB 47AB CD9248          17      CALL    CAP
0007AE 47AE D640             7      SUB '@'
0007B0 47B0 DD23            10      INC IX
0007B2 47B2 DD23            10      INC IX
0007B4 47B4 1D               4      DEC E
0007B5 47B5 1D               4      DEC E
0007B6 47B6 3243F1          13      LD  (FDRV),A
       47B9                     DEVI1:
                                
       47B9                     FILED:
0007B9 47B9 CD0048          17      CALL    FILEI
0007BC 47BC 2144F1          10      LD  HL,FNAME
                                
0007BF 47BF 0608             7      LD  B,8
       47C1                     FILE2:
0007C1 47C1 CD0D48          17      CALL    CCHKF
0007C4 47C4 C8              11      RET Z
0007C5 47C5 FE2A             7      CP  '*'
0007C7 47C7 282E            12      JR  Z,FILE9
0007C9 47C9 FE2E             7      CP  '.'
0007CB 47CB 280C            12      JR  Z,FILE4
0007CD 47CD 77               7      LD  (HL),A
0007CE 47CE 23               6      INC HL
0007CF 47CF 10F0            13      DJNZ    FILE2
                                
       47D1                     FILE3:
0007D1 47D1 CD0D48          17      CALL    CCHKF
0007D4 47D4 C8              11      RET Z
0007D5 47D5 FE2E             7      CP  '.'
0007D7 47D7 20F8            12      JR  NZ,FILE3
                                
       47D9                     FILE4:
0007D9 47D9 214CF1          10      LD  HL,FNAME+8
0007DC 47DC 0603             7      LD  B,3
                                
       47DE                     FILE4L:
0007DE 47DE CD0D48          17      CALL    CCHKF
0007E1 47E1 C8              11      RET Z
0007E2 47E2 FE2E             7      CP  '.'
0007E4 47E4 2008            12      JR  NZ,FILE12
0007E6 47E6 3244F1          13      LD  (FNAME),A   ;Parent directory(..)
0007E9 47E9 3245F1          13      LD  (FNAME+1),A
0007EC 47EC 3E20             7      LD  A,020H
       47EE                     FILE12:
0007EE 47EE FE2A             7      CP  '*'
0007F0 47F0 280A            12      JR  Z,FILE10
0007F2 47F2 77               7      LD  (HL),A
0007F3 47F3 23               6      INC HL
0007F4 47F4 10E8            13      DJNZ    FILE4L
0007F6 47F6 C9              10      RET
                                
       47F7                     FILE9:              ;名前の*処理、名前の残りを?で埋める
0007F7 47F7 CDFC47          17      CALL    FILE10
0007FA 47FA 18D5            12      JR  FILE3
                                
       47FC                     FILE10:
0007FC 47FC 3E3F             7      LD  A,'?'
0007FE 47FE 1808            12      JR  FILL_MEMORY
       4800                     FILEI:              ;名前＋拡張子をスペースで初期化
000800 4800 3E20             7      LD  A,020H
000802 4802 01000B          10      LD  BC,11*256   ;C=0にしておく
000805 4805 2144F1          10      LD  HL,FNAME
       4808                     FILL_MEMORY:            ;HLからBバイトAで埋める
000808 4808 77               7      LD  (HL),A
000809 4809 23               6      INC HL
00080A 480A 10FC            13      DJNZ    FILL_MEMORY
00080C 480C C9              10      RET
                                
       480D                     CCHKF:
00080D 480D 7B               4      LD  A,E
00080E 480E B7               4      OR  A
00080F 480F C8              11      RET Z
000810 4810 DD7E00          19      LD  A,(IX+0)
000813 4813 CD1A48          17      CALL    CCHK2
000816 4816 C8              11      RET Z
000817 4817 C37D48          10      JP  FKAN
                                
       481A                     CCHK2:
00081A 481A 0C               4      INC C
00081B 481B 0D               4      DEC C
00081C 481C C0              11      RET NZ
       481D                     CCHK3:              ;ZF=1 で使えない文字
00081D 481D FE2B             7      CP  '+'
00081F 481F C8              11      RET Z
000820 4820 FE2C             7      CP  ','
000822 4822 C8              11      RET Z
000823 4823 FE2F             7      CP  '/'
000825 4825 C8              11      RET Z
000826 4826 FE3A             7      CP  ':'
000828 4828 C8              11      RET Z
000829 4829 FE3B             7      CP  ';'
00082B 482B C8              11      RET Z
00082C 482C FE3D             7      CP  '='
00082E 482E C8              11      RET Z
00082F 482F FE5C             7      CP  05CH    ;\
000831 4831 C8              11      RET Z
000832 4832 FE1F             7      CP  01FH
000834 4834 D0              11      RET NC
000835 4835 BF               4      CP  A       ;Z=1
000836 4836 C9              10      RET
                                
       4837                     SS1:
000837 4837 13               6      INC DE
       4838                     SPCUT:              ;スペースをカット
000838 4838 1A               7      LD  A,(DE)
000839 4839 FE20             7      CP  020H
00083B 483B 28FA            12      JR  Z,SS1
00083D 483D C9              10      RET
                                
       483E                     SCREOF1:
00083E 483E 13               6      INC DE
       483F                     SPCUTEX:            ;スペース改行などをカット
00083F 483F 1A               7      LD  A,(DE)
000840 4840 FE20             7      CP  020H
000842 4842 28FA            12      JR  Z,SCREOF1
000844 4844 FE0D             7      CP  00DH
000846 4846 28F6            12      JR  Z,SCREOF1
000848 4848 FE0A             7      CP  00AH
00084A 484A 28F2            12      JR  Z,SCREOF1
00084C 484C FE1A             7      CP  01AH
00084E 484E 28EE            12      JR  Z,SCREOF1
000850 4850 C9              10      RET
                                
       4851                     GETNUM:
000851 4851 210000          10      LD  HL,0
       4854                     GETNUM1:
000854 4854 1A               7      LD  A,(DE)
000855 4855 13               6      INC DE
000856 4856 D630             7      SUB '0'
000858 4858 D8              11      RET C
000859 4859 FE0A             7      CP  10
00085B 485B D0              11      RET NC
00085C 485C 4D               4      LD  C,L
00085D 485D 44               4      LD  B,H
00085E 485E 29              11      ADD HL,HL   ;*2
00085F 485F 29              11      ADD HL,HL   ;*4
000860 4860 09              11      ADD HL,BC   ;*5
000861 4861 29              11      ADD HL,HL   ;*10
000862 4862 4F               4      LD  C,A
000863 4863 0600             7      LD  B,0
000865 4865 09              11      ADD HL,BC
000866 4866 18EC            12      JR  GETNUM1
                                
       4868                     SEARCH_END:
000868 4868 7E               7      LD  A,(HL)
       4869                     SEARCH_END1:
000869 4869 23               6      INC HL
00086A 486A B7               4      OR  A
00086B 486B C8              11      RET Z
00086C 486C FE3A             7      CP  ':'
00086E 486E 20F8            12      JR  NZ,SEARCH_END
000870 4870 7E               7      LD  A,(HL)
000871 4871 FE3A             7      CP  ':'
000873 4873 28F4            12      JR  Z,SEARCH_END1
000875 4875 C9              10      RET
                                
       4876                     FKANC:
000876 4876 CB41             8      BIT 0,C
000878 4878 CC9B48          17      CALL    Z,CAP2
00087B 487B 1803            12      JR  FKANX
       487D                     FKAN:           ;漢字チェック
00087D 487D DD23            10      INC IX
00087F 487F 1D               4      DEC E
       4880                     FKANX:
000880 4880 CB41             8      BIT 0,C
000882 4882 CB81             8      RES 0,C
000884 4884 C0              11      RET NZ
000885 4885 FE80             7      CP  080H
000887 4887 D8              11      RET C
000888 4888 FEA0             7      CP  0A0H
00088A 488A 3803            12      JR  C,FKAN1
00088C 488C FEE0             7      CP  0E0H
00088E 488E D8              11      RET C
       488F                     FKAN1:
00088F 488F 0C               4      INC C
000890 4890 A7               4      AND A
000891 4891 C9              10      RET
                                
       4892                     CAP:
000892 4892 FE61             7      CP  'a'
000894 4894 D8              11      RET C
000895 4895 FE7B             7      CP  'z'+1
000897 4897 D0              11      RET NC
000898 4898 D620             7      SUB 020H
00089A 489A C9              10      RET
       489B                     CAP2:
00089B 489B CD9248          17      CALL    CAP
       489E                     CAP3:               ;
00089E 489E FE05             7      CP  5
0008A0 48A0 2803            12      JR  Z,CAP4
0008A2 48A2 FE21             7      CP  021H
0008A4 48A4 C9              10      RET
       48A5                     CAP4:
0008A5 48A5 3EE5             7      LD  A,0E5H
0008A7 48A7 C9              10      RET
                                
       48A8                     ROM_OPEN:
0008A8 48A8 CDC74C          17      CALL    GET_DISK_BANK_FDRV
                                
0008AB 48AB CDF04A          17      CALL    GET_DIR_DAT
0008AE 48AE D5              11      PUSH    DE
0008AF 48AF CDC448          17      CALL    FILESE
0008B2 48B2 D1              10      POP DE
0008B3 48B3 3F               4      CCF
0008B4 48B4 D8              11      RET C
0008B5 48B5 223BF1          16      LD  (FCBX),HL
0008B8 48B8 E5              11      PUSH    HL
0008B9 48B9 210000          10      LD  HL,0
0008BC 48BC 221CF1          16      LD  (RR_LOW),HL
0008BF 48BF 221EF1          16      LD  (RR_HIGH),HL
0008C2 48C2 E1              10      POP HL
0008C3 48C3 C9              10      RET
                                
       48C4                     FILESE:
0008C4 48C4 7E               7      LD  A,(HL)
0008C5 48C5 B7               4      OR  A
0008C6 48C6 C8              11      RET Z       ;END:ZF=1 CF=0
0008C7 48C7 FEE5             7      CP  0E5H
0008C9 48C9 280D            12      JR  Z,FILESE1
0008CB 48CB 1144F1          10      LD  DE,FNAME
0008CE 48CE E5              11      PUSH    HL
0008CF 48CF CDFD48          17      CALL    CPFILE
0008D2 48D2 CC1E49          17      CALL    Z,CPFILE2
0008D5 48D5 E1              10      POP HL
0008D6 48D6 37               4      SCF
0008D7 48D7 C8              11      RET Z       ;!!!:(ZF=1) CF=1
       48D8                     FILESE1:
0008D8 48D8 CDE048          17      CALL    FNEXT
0008DB 48DB 20E7            12      JR  NZ,FILESE
       48DD                     ZF0_CF0_AFF_RET:
0008DD 48DD F6FF             7      OR  0FFH        ;ZF=0 CF=0
0008DF 48DF C9              10      RET
                                
       48E0                     FNEXT:
0008E0 48E0 112000          10      LD  DE,020H
0008E3 48E3 19              11      ADD HL,DE
0008E4 48E4 0D               4      DEC C
                                #if exists USE_NORMAL_32K_ROM
                                #else
       48E5                     CHECK_DIR_PAGE:         ;ディレクトリが2ページ目に跨るかチェックする
0008E5 48E5 F5              11      PUSH    AF
0008E6 48E6 CB7C             8      BIT 7,H
0008E8 48E8 2811            12      JR  Z,CHECK_DIR_PAGE1
0008EA 48EA 7C               4      LD  A,H
0008EB 48EB D620             7      SUB 020H
0008ED 48ED 67               4      LD  H,A
0008EE 48EE 3A17F1          13      LD  A,(_BANK)
0008F1 48F1 3C               4      INC A
0008F2 48F2 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
0008F5 48F5 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
0008F8 48F8 3217F1          13      LD  (_BANK),A
       48FB                     CHECK_DIR_PAGE1:
0008FB 48FB F1              10      POP AF
                                #endif
0008FC 48FC C9              10      RET
                                
       48FD                     CPFILE:
0008FD 48FD C5              11      PUSH    BC
0008FE 48FE 01000B          10      LD  BC,00B00H
       4901                     CPSTR1:
000901 4901 1A               7      LD  A,(DE)
000902 4902 FE3F             7      CP  '?'     ;Wild card
000904 4904 2812            12      JR  Z,CPSTR2
000906 4906 7E               7      LD  A,(HL)
000907 4907 CD7648          17      CALL    FKANC
00090A 490A E5              11      PUSH    HL
00090B 490B 67               4      LD  H,A
00090C 490C 1A               7      LD  A,(DE)
00090D 490D CB01             4      RLC C
00090F 490F CD7648          17      CALL    FKANC
000912 4912 CB09             4      RRC C
000914 4914 BC               4      CP  H       ;CP (HL),(DE)
000915 4915 E1              10      POP HL
000916 4916 2004            12      JR  NZ,CPSTR3
       4918                     CPSTR2:
000918 4918 13               6      INC DE
000919 4919 23               6      INC HL
00091A 491A 10E5            13      DJNZ    CPSTR1
       491C                     CPSTR3:
00091C 491C C1              10      POP BC
00091D 491D C9              10      RET
                                
       491E                     CPFILE2:
                                ;   LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
                                ;   OR  0E1H
00091E 491E 3EE1             7      LD  A,0E1H
000920 4920 2F               4      CPL
000921 4921 A6               7      AND (HL)
000922 4922 C9              10      RET
                                
       4923                     RBX1:
000923 4923 E5              11      PUSH    HL      ;Record byte
                                
000924 4924 ED5B1CF1        20      LD  DE,(RR_LOW) ;CDE=Random record
000928 4928 3A1FF1          13      LD  A,(RR_HIGH+1)
00092B 492B 4F               4      LD  C,A
                                
00092C 492C CDC74C          17      CALL    GET_DISK_BANK_FDRV
                                
00092F 492F FD2A3BF1        20      LD  IY,(FCBX)
000933 4933 FD6E1C          19      LD  L,(IY+01CH) ;AHL=File size
000936 4936 FD661D          19      LD  H,(IY+01DH)
000939 4939 FD7E1E          19      LD  A,(IY+01EH)
                                
00093C 493C A7               4      AND A
00093D 493D ED52            15      SBC HL,DE
00093F 493F 99               4      SBC A,C
000940 4940 D1              10      POP DE
                                
000941 4941 D8              11      RET C
000942 4942 4F               4      LD  C,A
000943 4943 EB               4      EX  DE,HL   ;CDE=File byte  HL=Record byte
000944 4944 B2               4      OR  D
000945 4945 B3               4      OR  E
000946 4946 C0              11      RET NZ
000947 4947 37               4      SCF
000948 4948 C9              10      RET
                                
       4949                     RBX2:
000949 4949 ED4B1DF1        20      LD  BC,(RR_LOW+1)
00094D 494D CDD149          17      CALL    RWXR
000950 4950 3A19F1          13      LD  A,(CLSZ_H)
000953 4953 3D               4      DEC A
000954 4954 E5              11      PUSH    HL
000955 4955 2A1CF1          16      LD  HL,(RR_LOW)
000958 4958 A4               4      AND H
000959 4959 B5               4      OR  L
00095A 495A E1              10      POP HL
00095B 495B C9              10      RET
                                
       495C                     RBXA:
00095C 495C D5              11      PUSH    DE
00095D 495D CD404A          17      CALL    CLUST
000960 4960 ED5324F1        20      LD  (_DTPS),DE
000964 4964 D1              10      POP DE
000965 4965 CD1D4A          17      CALL    GNCL
000968 4968 D8              11      RET C
000969 4969 ED5320F1        20      LD  (_CLPS),DE
                                
00096D 496D ED4B1CF1        20      LD  BC,(RR_LOW)
000971 4971 2A18F1          16      LD  HL,(CLSZ)
000974 4974 7C               4      LD  A,H
000975 4975 3D               4      DEC A
000976 4976 A0               4      AND B
000977 4977 47               4      LD  B,A
000978 4978 ED42            15      SBC HL,BC       ;remaining cluster
                                
00097A 497A ED5B3DF1        20      LD  DE,(LEFTX)
00097E 497E ED52            15      SBC HL,DE       ;CP HL,DE
000980 4980 19              11      ADD HL,DE
000981 4981 3801            12      JR  C,RBXA1
000983 4983 EB               4      EX  DE,HL
       4984                     RBXA1:
000984 4984 3A17F1          13      LD  A,(_BANK)   ;GNCLでバンクを切り替えたのでデータのあるバンク
000987 4987 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
00098A 498A 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
00098D 498D E5              11      PUSH    HL
00098E 498E 2A24F1          16      LD  HL,(_DTPS)
000991 4991 09              11      ADD HL,BC
000992 4992 ED5B37F1        20      LD  DE,(DTAX)
000996 4996 C1              10      POP BC
000997 4997 C9              10      RET
                                
       4998                     RBXB:
000998 4998 2A37F1          16      LD  HL,(DTAX)
00099B 499B ED5B20F1        20      LD  DE,(_CLPS)
00099F 499F 3A3EF1          13      LD  A,(LEFTX+1)
0009A2 49A2 47               4      LD  B,A
0009A3 49A3 3A19F1          13      LD  A,(CLSZ_H)  ;1024=4 / 512=2 / 256=1
       49A6                     RBXB1:
0009A6 49A6 1F               4      RRA     ;->CF
0009A7 49A7 3804            12      JR  C,RBXB2
0009A9 49A9 CB38             8      SRL B   ;B=B/2
0009AB 49AB 18F9            12      JR  RBXB1
       49AD                     RBXB2:
0009AD 49AD 78               4      LD  A,B
0009AE 49AE B7               4      OR  A
0009AF 49AF C9              10      RET
                                
       49B0                     RBXC:
0009B0 49B0 ED4B3DF1        20      LD  BC,(LEFTX)
0009B4 49B4 3A19F1          13      LD  A,(CLSZ_H)
0009B7 49B7 3D               4      DEC A
0009B8 49B8 A0               4      AND B
0009B9 49B9 47               4      LD  B,A
0009BA 49BA B1               4      OR  C
0009BB 49BB C9              10      RET
                                
       49BC                     RBXEND:
0009BC 49BC ED5B22F1        20      LD  DE,(_LEFT)
0009C0 49C0 2A1CF1          16      LD  HL,(RR_LOW)
0009C3 49C3 3A1FF1          13      LD  A,(RR_HIGH+1)
0009C6 49C6 19              11      ADD HL,DE
0009C7 49C7 CE00             7      ADC A,0
0009C9 49C9 221CF1          16      LD  (RR_LOW),HL
0009CC 49CC 321FF1          13      LD  (RR_HIGH+1),A
0009CF 49CF EB               4      EX  DE,HL       ;HL=Read byte
0009D0 49D0 C9              10      RET 
                                
       49D1                     RWXR:
0009D1 49D1 3A19F1          13      LD  A,(CLSZ_H)  ;1024=4 / 512=2 / 256=1
       49D4                     L_RWX:
0009D4 49D4 1F               4      RRA     ;->CF
0009D5 49D5 3806            12      JR  C,E_RWX
0009D7 49D7 CB38             8      SRL B   ;BC=BC/2
0009D9 49D9 CB19             8      RR  C   ;
0009DB 49DB 18F7            12      JR  L_RWX
       49DD                     E_RWX:
0009DD 49DD CDC74C          17      CALL    GET_DISK_BANK_FDRV
                                
0009E0 49E0 FD2A3BF1        20      LD  IY,(FCBX)
0009E4 49E4 FD5E1A          19      LD  E,(IY+01AH) ;ファイルの先頭クラスタ
0009E7 49E7 FD561B          19      LD  D,(IY+01BH)
       49EA                     RWX1:
0009EA 49EA ED5320F1        20      LD  (_CLPS),DE
0009EE 49EE 7A               4      LD  A,D
0009EF 49EF B3               4      OR  E
0009F0 49F0 37               4      SCF
0009F1 49F1 C8              11      RET Z
                                
0009F2 49F2 78               4      LD  A,B
0009F3 49F3 B1               4      OR  C
0009F4 49F4 C8              11      RET Z
                                
0009F5 49F5 CD1D4A          17      CALL    GNCL
0009F8 49F8 D8              11      RET C
0009F9 49F9 0B               6      DEC BC
0009FA 49FA CD894A          17      CALL    ENDCL
0009FD 49FD 38EB            12      JR  C,RWX1
0009FF 49FF 37               4      SCF
000A00 4A00 C9              10      RET
                                
       4A01                     NCL3:
000A01 4A01 CDC74C          17      CALL    GET_DISK_BANK_FDRV
000A04 4A04 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000A07 4A07 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000A0A 4A0A 6B               4      LD  L,E
000A0B 4A0B 62               4      LD  H,D
000A0C 4A0C CB3C             8      SRL H
000A0E 4A0E CB1D             8      RR  L
000A10 4A10 1F               4      RRA
000A11 4A11 19              11      ADD HL,DE
000A12 4A12 010060          10      LD  BC,BANK1_ADR
000A15 4A15 09              11      ADD HL,BC
000A16 4A16 ED4B1AF1        20      LD  BC,(SECSZ)
000A1A 4A1A 09              11      ADD HL,BC
000A1B 4A1B 17               4      RLA
000A1C 4A1C C9              10      RET
                                
       4A1D                     GNCL:
000A1D 4A1D 7A               4      LD  A,D
000A1E 4A1E B3               4      OR  E
000A1F 4A1F 37               4      SCF
000A20 4A20 C8              11      RET Z
000A21 4A21 C5              11      PUSH    BC
000A22 4A22 E5              11      PUSH    HL
000A23 4A23 CD014A          17      CALL    NCL3
000A26 4A26 3809            12      JR  C,GNC1
000A28 4A28 5E               7      LD  E,(HL)
000A29 4A29 23               6      INC HL
000A2A 4A2A 7E               7      LD  A,(HL)
000A2B 4A2B E60F             7      AND 00FH
000A2D 4A2D 57               4      LD  D,A
000A2E 4A2E E1              10      POP HL
000A2F 4A2F C1              10      POP BC
000A30 4A30 C9              10      RET
       4A31                     GNC1:
000A31 4A31 7E               7      LD  A,(HL)
000A32 4A32 23               6      INC HL
000A33 4A33 56               7      LD  D,(HL)
000A34 4A34 0604             7      LD  B,4
       4A36                     GNC1L:
000A36 4A36 CB3A             8      SRL D
000A38 4A38 1F               4      RRA
000A39 4A39 10FB            13      DJNZ    GNC1L
                                
000A3B 4A3B 5F               4      LD  E,A
000A3C 4A3C E1              10      POP HL
000A3D 4A3D C1              10      POP BC
000A3E 4A3E A7               4      AND A
000A3F 4A3F C9              10      RET
                                
       4A40                     CLUST:
000A40 4A40 EB               4      EX  DE,HL
000A41 4A41 C5              11      PUSH    BC
000A42 4A42 3A19F1          13      LD  A,(CLSZ_H)
000A45 4A45 CDF34C          17      CALL    MUL_AHL
                                
000A48 4A48 CD004B          17      CALL    GET_DIR_POS
000A4B 4A4B 4F               4      LD  C,A
000A4C 4A4C 0600             7      LD  B,0
000A4E 4A4E 09              11      ADD HL,BC
                                
000A4F 4A4F 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt
000A52 4A52 0F               4      RRCA
000A53 4A53 0F               4      RRCA
000A54 4A54 0F               4      RRCA
000A55 4A55 0F               4      RRCA
000A56 4A56 4F               4      LD  C,A
                                
000A57 4A57 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus
000A5A 4A5A FE02             7      CP  2
000A5C 4A5C 280C            12      JR  Z,CLUST1
000A5E 4A5E CB01             4      RLC C
000A60 4A60 0D               4      DEC C
000A61 4A61 3A0C60          13      LD  A,(BANK1_ADR+11+1)  ;BPB_BytsPerSec High    
000A64 4A64 FE02             7      CP  2
000A66 4A66 2002            12      JR  NZ,CLUST1
000A68 4A68 0D               4      DEC C
000A69 4A69 0D               4      DEC C
       4A6A                     CLUST1:
000A6A 4A6A 0D               4      DEC C
000A6B 4A6B 09              11      ADD HL,BC
                                
                                #if exists USE_NORMAL_32K_ROM
                                    LD  A,L
                                #else
000A6C 4A6C E5              11      PUSH    HL
000A6D 4A6D 29              11      ADD HL,HL   ;*2
000A6E 4A6E 29              11      ADD HL,HL   ;*4
000A6F 4A6F 29              11      ADD HL,HL   ;*8
000A70 4A70 CDC74C          17      CALL    GET_DISK_BANK_FDRV
000A73 4A73 84               4      ADD A,H
000A74 4A74 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000A77 4A77 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000A7A 4A7A 3217F1          13      LD  (_BANK),A
000A7D 4A7D E1              10      POP HL
000A7E 4A7E 3E1F             7      LD  A,01FH          ;セグメントのサイズでフィルタする(8K:1F)
000A80 4A80 A5               4      AND L
                                #endif
000A81 4A81 C660             7      ADD A,high BANK1_ADR
000A83 4A83 67               4      LD  H,A
000A84 4A84 2E00             7      LD  L,0
000A86 4A86 EB               4      EX  DE,HL
000A87 4A87 C1              10      POP BC
000A88 4A88 C9              10      RET
                                
       4A89                     ENDCL:
000A89 4A89 7A               4      LD  A,D ;END CLUSTER
000A8A 4A8A FE0F             7      CP  00FH    ;FAT12の最大値
000A8C 4A8C C0              11      RET NZ
000A8D 4A8D 7B               4      LD  A,E
000A8E 4A8E FEF7             7      CP  0F7H
000A90 4A90 C9              10      RET
                                
       4A91                     RB_READ:
000A91 4A91 AF               4      XOR A   ;HLA = HL*128
000A92 4A92 CB3C             8      SRL H
000A94 4A94 CB1D             8      RR  L
000A96 4A96 1F               4      RRA
000A97 4A97 321CF1          13      LD  (RR_LOW),A
000A9A 4A9A 221DF1          16      LD  (RR_MID),HL
000A9D 4A9D 218000          10      LD  HL,128
                                
000AA0 4AA0 CDC846          17      CALL    ROM_READ
000AA3 4AA3 C9              10      RET
                                
       4AA4                     GETSEQ:
000AA4 4AA4 FD6E20          19      LD  L,(IY+32)
000AA7 4AA7 FD660C          19      LD  H,(IY+12)
                                
000AAA 4AAA CB25             8      SLA L
                                
000AAC 4AAC CB3C             8      SRL H
000AAE 4AAE CB1D             8      RR  L
000AB0 4AB0 C9              10      RET
                                
       4AB1                     SETSEQ:
000AB1 4AB1 F5              11      PUSH    AF
000AB2 4AB2 3A1CF1          13      LD  A,(RR_LOW)
000AB5 4AB5 2A1DF1          16      LD  HL,(RR_MID)
                                
000AB8 4AB8 CDCF4A          17      CALL    SSQ1
                                
000ABB 4ABB 29              11      ADD HL,HL
000ABC 4ABC CB3D             8      SRL L
000ABE 4ABE FD7520          19      LD  (IY+32),L
000AC1 4AC1 FD740C          19      LD  (IY+12),H
000AC4 4AC4 F1              10      POP AF
000AC5 4AC5 C9              10      RET
                                
       4AC6                     GETSIZE:
000AC6 4AC6 FD7E10          19      LD  A,(IY+16)
000AC9 4AC9 FD6E11          19      LD  L,(IY+17)
000ACC 4ACC FD6612          19      LD  H,(IY+18)
       4ACF                     SSQ1:
000ACF 4ACF 87               4      ADD A,A
000AD0 4AD0 ED6A            15      ADC HL,HL
000AD2 4AD2 B7               4      OR  A
000AD3 4AD3 C8              11      RET Z
000AD4 4AD4 23               6      INC HL
000AD5 4AD5 C9              10      RET
                                
       4AD6                     SET_FCB:
000AD6 4AD6 D5              11      PUSH    DE
000AD7 4AD7 FDE1            14      POP IY
000AD9 4AD9 FD7E1C          19      LD  A,(IY+28)
000ADC 4ADC FEFF             7      CP  0FFH
000ADE 4ADE 200C            12      JR  NZ,POPAF_SCF_FF_RET
000AE0 4AE0 E5              11      PUSH    HL
000AE1 4AE1 FD6E1A          19      LD  L,(IY+26)
000AE4 4AE4 FD661B          19      LD  H,(IY+27)
000AE7 4AE7 2220F1          16      LD  (_CLPS),HL
000AEA 4AEA E1              10      POP HL
000AEB 4AEB C9              10      RET
                                
       4AEC                     POPAF_SCF_FF_RET:
000AEC 4AEC F1              10      POP AF
000AED 4AED 37               4      SCF
000AEE 4AEE 9F               4      SBC A,A
000AEF 4AEF C9              10      RET
                                
       4AF0                     GET_DIR_DAT:
000AF0 4AF0 CD004B          17      CALL    GET_DIR_POS
000AF3 4AF3 C660             7      ADD A,high BANK1_ADR
000AF5 4AF5 2E00             7      LD  L,0
000AF7 4AF7 67               4      LD  H,A         ;HL=BANK1_ADR+(BPB_RsvdSecCnt+BPB_FATSz16*BPB_NumFATs)*BPB_BytsPerSec
                                #if exists USE_NORMAL_32K_ROM
                                #else
000AF8 4AF8 CDE548          17      CALL    CHECK_DIR_PAGE
                                #endif
000AFB 4AFB 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt
000AFE 4AFE 4F               4      LD  C,A
000AFF 4AFF C9              10      RET
                                
       4B00                     GET_DIR_POS:
000B00 4B00 CDC74C          17      CALL    GET_DISK_BANK_FDRV
000B03 4B03 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000B06 4B06 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000B09 4B09 3217F1          13      LD  (_BANK),A
000B0C 4B0C 3A1060          13      LD  A,(BANK1_ADR+16)    ;BPB_NumFATs
000B0F 4B0F 47               4      LD  B,A
000B10 4B10 3A1660          13      LD  A,(BANK1_ADR+22)    ;BPB_FATSz16
000B13 4B13 4F               4      LD  C,A
000B14 4B14 3A0E60          13      LD  A,(BANK1_ADR+14)    ;BPB_RsvdSecCnt
       4B17                     GET_DIR_POS1:
000B17 4B17 81               4      ADD A,C
000B18 4B18 10FD            13      DJNZ    GET_DIR_POS1
                                
000B1A 4B1A ED4B0B60        20      LD  BC,(BANK1_ADR+11)   ;BPB_BytsPerSec 
       4B1E                     L_MDP:
000B1E 4B1E CB18             8      RR  B   ;->CF
000B20 4B20 D8              11      RET C
000B21 4B21 87               4      ADD A,A
000B22 4B22 18FA            12      JR  L_MDP
                                
       4B24                     WILDCARD:
000B24 4B24 3F3F3F3F3F3F3F3F        DB  "???????????"
            3F3F3F              
[EOF:FILE.ASM:UTF_8]
                                    INCLUDE "DISK.ASM"
                                
                                ;   Tablacus DISK ROM - DISK
                                
                                ;   ROM DISK DRIVER
                                ;   1セクタ512
                                
       4B2F                     ERROR_WRITE_PROTECTED:
000B2F 4B2F 3E00             7      LD  A,0     ;Write protected
000B31 4B31 C9              10      RET
       4B32                     DISKIO:
000B32 4B32 38FB            12      JR  C,ERROR_WRITE_PROTECTED
000B34 4B34 48               4      LD  C,B
000B35 4B35 CDD14C          17      CALL    GET_DISK_BANK
       4B38                     SETMAP1:        
000B38 4B38 E5              11      PUSH    HL
       4B39                     DISKIO1:
000B39 4B39 C5              11      PUSH    BC      ;B=残りのセクタ数
000B3A 4B3A D5              11      PUSH    DE      ;DE=セクタ番号
000B3B 4B3B F5              11      PUSH    AF      ;A=8KB単位でカートリッジ内のディスクが存在する位置を指定
                                
000B3C 4B3C EB               4      EX  DE,HL       ;DE=受け取る読み出し先のメモリアドレス HL=セクタ番号
000B3D 4B3D F5              11      PUSH    AF
000B3E 4B3E 3A1BF1          13      LD  A,(SECSZ_H)
000B41 4B41 CDF34C          17      CALL    MUL_AHL
000B44 4B44 F1              10      POP AF
000B45 4B45 4D               4      LD  C,L     ;C=読み出し元
000B46 4B46 29              11      ADD HL,HL       ;64KB→32KB
000B47 4B47 29              11      ADD HL,HL       ;32KB→16KB
000B48 4B48 29              11      ADD HL,HL       ;16KB→8KB  バンク切り替えのサイズに合わせる
000B49 4B49 84               4      ADD A,H
000B4A 4B4A 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000B4D 4B4D 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000B50 4B50 3217F1          13      LD  (_BANK),A
000B53 4B53 79               4      LD  A,C     ;C=読み出し元
000B54 4B54 E61F             7      AND 01FH        ;セグメントのサイズでフィルタする(8K:1F)
000B56 4B56 C660             7      ADD A,high BANK1_ADR
000B58 4B58 67               4      LD  H,A
000B59 4B59 ED4B1AF1        20      LD  BC,(SECSZ)  ;BCは読み出すセクタサイズ
000B5D 4B5D 69               4      LD  L,C     ;C=0
000B5E 4B5E EDB0                    LDIR
000B60 4B60 EB               4      EX  DE,HL
000B61 4B61 F1              10      POP AF
000B62 4B62 D1              10      POP DE
000B63 4B63 13               6      INC DE
000B64 4B64 C1              10      POP BC
000B65 4B65 10D2            13      DJNZ    DISKIO1
000B67 4B67 41               4      LD  B,C
                                
000B68 4B68 E1              10      POP HL
000B69 4B69 AF               4      XOR A
000B6A 4B6A FB               4      EI
000B6B 4B6B C9              10      RET
                                
       4B6C                     DSKCHG:
000B6C 4B6C CDA54B          17      CALL    IS_BPB
000B6F 4B6F 3824            12      JR  C,NOTREADY
000B71 4B71 3A23FB          13      LD  A,(DRVTBL+2)
000B74 4B74 B7               4      OR  A
000B75 4B75 201A            12      JR  NZ,DSKCHG1
000B77 4B77 3A21FB          13      LD  A,(DRVTBL)
000B7A 4B7A FE02             7      CP  2
000B7C 4B7C 2013            12      JR  NZ,DSKCHG1
000B7E 4B7E CDA54B          17      CALL    IS_BPB
000B81 4B81 300E            12      JR  NC,DSKCHG1
000B83 4B83 3E01             7      LD  A,1         ;ドライブテーブルを拡張 A:Tablacus DISK ROM B:MASTER SLOT ROM
000B85 4B85 3221FB          13      LD  (DRVTBL),A
000B88 4B88 3223FB          13      LD  (DRVTBL+2),A
000B8B 4B8B 3A48F3          13      LD  A,(MASTERS)
000B8E 4B8E 3224FB          13      LD  (DRVTBL+3),A
       4B91                     DSKCHG1:
000B91 4B91 AF               4      XOR A
000B92 4B92 0601             7      LD  B,1
000B94 4B94 C9              10      RET
       4B95                     NOTREADY:
000B95 4B95 3E02             7      LD  A,2
000B97 4B97 37               4      SCF
000B98 4B98 C9              10      RET
                                
       4B99                     NO_BPB:
000B99 4B99 E1              10      POP HL
000B9A 4B9A 23               6      INC HL
000B9B 4B9B 11F84C          10      LD  DE,DPB2DD
000B9E 4B9E 011200          10      LD  BC,DPB2DD_E-DPB2DD
000BA1 4BA1 EDB0                    LDIR
000BA3 4BA3 AF               4      XOR A
000BA4 4BA4 C9              10      RET
                                
       4BA5                     IS_BPB:
                                ; in
                                ; A=DRIVE 0:A 1:B
                                ; out
                                ; CF=0ディスクは存在する CF=1 ディスクは存在しない
000BA5 4BA5 CDD14C          17      CALL    GET_DISK_BANK
                                
000BA8 4BA8 3A1560          13      LD  A,(BANK1_ADR+21)    ;BPB_Media
000BAB 4BAB FE01             7      CP  1
000BAD 4BAD D8              11      RET C
                                
000BAE 4BAE 3A0B60          13      LD  A,(BANK1_ADR+11)    ;BPB_BytsPerSec
000BB1 4BB1 C6FF             7      ADD A,0FFH
000BB3 4BB3 D8              11      RET C
                                
000BB4 4BB4 3A0C60          13      LD  A,(BANK1_ADR+12)    ;BPB_BytsPerSec
000BB7 4BB7 FE01             7      CP  1
000BB9 4BB9 C8              11      RET Z
000BBA 4BBA FE02             7      CP  2
000BBC 4BBC C8              11      RET Z
000BBD 4BBD FE04             7      CP  4
000BBF 4BBF C8              11      RET Z
000BC0 4BC0 37               4      SCF
000BC1 4BC1 C9              10      RET
                                
       4BC2                     GETDPB:
000BC2 4BC2 E5              11      PUSH    HL
000BC3 4BC3 CDD14C          17      CALL    GET_DISK_BANK
                                
000BC6 4BC6 3A1560          13      LD  A,(BANK1_ADR+21)    ;BPB_Media  
000BC9 4BC9 B7               4      OR  A
000BCA 4BCA 28CD            12      JR  Z,NO_BPB
000BCC 4BCC DDE1            14      POP IX
000BCE 4BCE DD7701          19      LD  (IX+1),A        ;MEDIA
                                
000BD1 4BD1 3A0B60          13      LD  A,(BANK1_ADR+11)    ;BPB_BytsPerSec 
000BD4 4BD4 DD7702          19      LD  (IX+2),A        ;SECSIZ LOW
                                
000BD7 4BD7 3A0C60          13      LD  A,(BANK1_ADR+12)    ;BPB_BytsPerSec 
000BDA 4BDA DD7703          19      LD  (IX+3),A        ;SECSIZ HIGH
                                
000BDD 4BDD 87               4      ADD A,A
000BDE 4BDE 87               4      ADD A,A
000BDF 4BDF 87               4      ADD A,A
000BE0 4BE0 3D               4      DEC A
000BE1 4BE1 DD7704          19      LD  (IX+4),A        ;DIRMSK
                                
000BE4 4BE4 06FF             7      LD  B,-1
000BE6 4BE6 A7               4      AND A           ;無限ループ阻止
       4BE7                     GETDPB1:
000BE7 4BE7 04               4      INC B
000BE8 4BE8 1F               4      RRA
000BE9 4BE9 38FC            12      JR  C,GETDPB1
000BEB 4BEB DD7005          19      LD  (IX+5),B        ;DIRSHFT
                                
000BEE 4BEE 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus
000BF1 4BF1 3D               4      DEC A
000BF2 4BF2 DD7706          19      LD  (IX+6),A        ;CLUSMSK
                                
000BF5 4BF5 A7               4      AND A           ;無限ループ阻止
000BF6 4BF6 06FF             7      LD  B,-1
       4BF8                     GETDPB2:
000BF8 4BF8 04               4      INC B
000BF9 4BF9 1F               4      RRA
000BFA 4BFA 38FC            12      JR  C,GETDPB2
000BFC 4BFC 04               4      INC B
000BFD 4BFD DD7007          19      LD  (IX+7),B        ;CLUSSHFT
                                
000C00 4C00 2A0E60          16      LD  HL,(BANK1_ADR+14)   ;BPB_RsvdSecCnt 
000C03 4C03 DD7508          19      LD  (IX+8),L        ;FIRFAT LOW
000C06 4C06 DD7409          19      LD  (IX+9),H        ;FIRFAT HIGH
                                
000C09 4C09 3A1060          13      LD  A,(BANK1_ADR+16)    ;BPB_NumFATs    
000C0C 4C0C DD770A          19      LD  (IX+10),A       ;FATCNT
                                
000C0F 4C0F 3A1160          13      LD  A,(BANK1_ADR+17)    ;BPB_RootEntCnt 
000C12 4C12 DD770B          19      LD  (IX+11),A       ;FATCNT
                                
000C15 4C15 ED5B1660        20      LD  DE,(BANK1_ADR+22)   ;BPB_FATSz16    
000C19 4C19 DD7310          19      LD  (IX+16),E       ;FATSIZ
                                
000C1C 4C1C DD460A          19      LD  B,(IX+10)       ;FATCNT
000C1F 4C1F 210000          10      LD  HL,0
       4C22                     GETDPB3:
000C22 4C22 19              11      ADD HL,DE
000C23 4C23 10FD            13      DJNZ    GETDPB3
       4C25                     GETDPB4:
000C25 4C25 DD5E08          19      LD  E,(IX+8)        ;FIRFAT
000C28 4C28 DD5609          19      LD  D,(IX+9)        ;FIRFAT
000C2B 4C2B 19              11      ADD HL,DE
000C2C 4C2C DD7511          19      LD  (IX+17),L       ;FIRDIR
000C2F 4C2F DD7412          19      LD  (IX+18),H       ;FIRDIR
                                
000C32 4C32 DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
000C35 4C35 87               4      ADD A,A
000C36 4C36 87               4      ADD A,A
000C37 4C37 DD5E0B          19      LD  E,(IX+11)       ;MAXENT
       4C3A                     GETDPB5:
000C3A 4C3A CB3B             8      SRL E
000C3C 4C3C 1F               4      RRA
000C3D 4C3D 30FB            12      JR  NC,GETDPB5
000C3F 4C3F 1600             7      LD  D,0
000C41 4C41 19              11      ADD HL,DE
000C42 4C42 DD750C          19      LD  (IX+12),L       ;FIRREC
000C45 4C45 DD740D          19      LD  (IX+13),H       ;FIRREC
                                
000C48 4C48 2A1360          16      LD  HL,(BANK1_ADR+19)   ;BPB_TotSec16   
                                
000C4B 4C4B DD5E0C          19      LD  E,(IX+12)       ;FIRREC
000C4E 4C4E DD560D          19      LD  D,(IX+13)       ;FIRREC
000C51 4C51 A7               4      AND A
000C52 4C52 ED52            15      SBC HL,DE
                                
000C54 4C54 DD7E06          19      LD  A,(IX+6)        ;CLUSMSK
000C57 4C57 3C               4      INC A
000C58 4C58 37               4      SCF             ;無限ループ阻止
       4C59                     GETDPB6:
000C59 4C59 1F               4      RRA
000C5A 4C5A 3806            12      JR  C,GETDPB7
000C5C 4C5C CB3C             8      SRL H
000C5E 4C5E CB1D             8      RR  L
000C60 4C60 18F7            12      JR  GETDPB6
       4C62                     GETDPB7:
000C62 4C62 23               6      INC HL
000C63 4C63 DD750E          19      LD  (IX+14),L       ;MAXCLUS
000C66 4C66 DD740F          19      LD  (IX+15),H       ;MAXCLUS
                                
                                    ;1セクタが512バイト以上の場合を考慮(2HD/1セクタ1024バイト/1.23MB等)
       4C69                     GETDPBD1:
000C69 4C69 DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
000C6C 4C6C E6FC             7      AND 0FCH
000C6E 4C6E C8              11      RET Z
                                
000C6F 4C6F DDCB033E        23      SRL (IX+3)          ;SECSIZ HIGH
                                
000C73 4C73 37               4      SCF
000C74 4C74 DDCB0616        23      RL  (IX+6)          ;CLUSMSK
                                
000C78 4C78 DD3407          23      INC (IX+7)          ;CLUSSHFT
                                
000C7B 4C7B DDCB0826        23      SLA (IX+8)          ;FIRFAT LOW
000C7F 4C7F DDCB0916        23      RL  (IX+9)          ;FIRFAT HIGH
                                
000C83 4C83 DDCB0E25        23      SLA (IX+14),L       ;MAXCLUS
000C87 4C87 DDCB0F14        23      RL  (IX+15),H       ;MAXCLUS
                                
000C8B 4C8B DDCB1026        23      SLA (IX+16)         ;FATSIZ
                                
000C8F 4C8F DDCB1126        23      SLA (IX+17)         ;FIRDIR
000C93 4C93 DDCB1216        23      RL  (IX+18)         ;FIRDIR
                                
000C97 4C97 DD6E11          19      LD  L,(IX+17)       ;FIRDIR
000C9A 4C9A DD6612          19      LD  H,(IX+18)       ;FIRDIR
                                
000C9D 4C9D DD7E03          19      LD  A,(IX+3)        ;SECSIZ HIGH
000CA0 4CA0 87               4      ADD A,A
000CA1 4CA1 87               4      ADD A,A
000CA2 4CA2 DD5E0B          19      LD  E,(IX+11)       ;MAXENT
       4CA5                     GETDPBD5:
000CA5 4CA5 CB3B             8      SRL E
000CA7 4CA7 1F               4      RRA
000CA8 4CA8 30FB            12      JR  NC,GETDPBD5
000CAA 4CAA 1600             7      LD  D,0
000CAC 4CAC 19              11      ADD HL,DE
000CAD 4CAD DD750C          19      LD  (IX+12),L       ;FIRREC
000CB0 4CB0 DD740D          19      LD  (IX+13),H       ;FIRREC
                                
000CB3 4CB3 18B4            12      JR  GETDPBD1
                                
       4CB5                     CHOICE:
000CB5 4CB5 210000          10      LD  HL,0
000CB8 4CB8 C9              10      RET
                                
       4CB9                     DSKFMT:
000CB9 4CB9 AF               4      XOR A
000CBA 4CBA 37               4      SCF
       4CBB                     DSKSTP:
000CBB 4CBB C9              10      RET
                                
       4CBC                     BASENT:
000CBC 4CBC ED7B4FF1        20      LD  SP,(BASSTK)
000CC0 4CC0 C3B543          10      JP  BASAUTO
                                
       4CC3                     GETSLT:
000CC3 4CC3 3A22FB          13      LD  A,(DRVTBL+1)
000CC6 4CC6 C9              10      RET
                                
       4CC7                     GET_DISK_BANK_FDRV:
000CC7 4CC7 3A43F1          13      LD  A,(FDRV)
000CCA 4CCA D601             7      SUB 1
000CCC 4CCC 3003            12      JR  NC,GET_DISK_BANK
000CCE 4CCE 3A3AF1          13      LD  A,(_DVSW)
       4CD1                     GET_DISK_BANK:
000CD1 4CD1 B7               4      OR  A       ;A=DRIVE
000CD2 4CD2 3E01             7      LD  A,DISK_BANK
000CD4 4CD4 2803            12      JR  Z,SET_DISK_BANK
                                #if exists FIX_DRIVE
                                    LD  A,FIX_DRIVE
                                #else
000CD6 4CD6 3A39F1          13      LD  A,(B_DRIVE)
                                #endif
       4CD9                     SET_DISK_BANK:
000CD9 4CD9 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
000CDC 4CDC 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
000CDF 4CDF F5              11      PUSH    AF
000CE0 4CE0 E5              11      PUSH    HL
000CE1 4CE1 2A0B60          16      LD  HL,(BANK1_ADR+11)   ;BPB_BytsPerSec 
000CE4 4CE4 221AF1          16      LD  (SECSZ),HL
000CE7 4CE7 3A0D60          13      LD  A,(BANK1_ADR+13)    ;BPB_SecPerClus
000CEA 4CEA CDF34C          17      CALL    MUL_AHL
000CED 4CED 2218F1          16      LD  (CLSZ),HL
000CF0 4CF0 E1              10      POP HL
000CF1 4CF1 F1              10      POP AF
000CF2 4CF2 C9              10      RET
                                
                                ;   HL = HL * A ただし、A=1,2,4,8,16,32,64,128(2のべき乗に限る)
       4CF3                     MUL_AHL:
000CF3 4CF3 1F               4      RRA     ;->CF
000CF4 4CF4 D8              11      RET C
000CF5 4CF5 29              11      ADD HL,HL
000CF6 4CF6 18FB            12      JR  MUL_AHL
                                
       4CF8                     DPB2DD:
000CF8 4CF8 F9                      DB  0F9H    ;MEDIA
000CF9 4CF9 0002                    DW  00200H  ;SECSIZ
000CFB 4CFB 0F                      DB  00FH    ;DIRMSK
000CFC 4CFC 04                      DB  004H    ;DIRSHFT
000CFD 4CFD 01                      DB  001H    ;CLUSMSK
000CFE 4CFE 02                      DB  002H    ;CLUSSHFT
000CFF 4CFF 0100                    DW  00001H  ;FIRFAT
000D01 4D01 02                      DB  002H    ;FATCNT
000D02 4D02 70                      DB  070H    ;MAXENT
000D03 4D03 0E00                    DW  0000EH  ;FIRREC
000D05 4D05 CA02                    DW  002CAH  ;MAXCLUS
000D07 4D07 03                      DB  003H    ;FATSIZ
000D08 4D08 0700                    DW  0007H   ;FIRDIR
       4D0A                     DPB2DD_E:
                                
[EOF:DISK.ASM:UTF_8]
                                    INCLUDE "BDOS.ASM"
       4D0A                     POP_HL_ERROR:
000D0A 4D0A E1              10      POP     HL
       4D0B                     _ERROR:
000D0B 4D0B 0600             7      LD  B,0
000D0D 4D0D A7               4      AND A
000D0E 4D0E C9              10      RET
                                
       4D0F                     ROM_BDOS:
000D0F 4D0F E5              11      PUSH    HL
000D10 4D10 79               4      LD  A,C
000D11 4D11 87               4      ADD A,A
000D12 4D12 38F7            12      JR  C,_ERROR
000D14 4D14 6F               4      LD  L,A
000D15 4D15 265F             7      LD  H,high STABLE
000D17 4D17 7E               7      LD  A,(HL)
000D18 4D18 2C               4      INC L
000D19 4D19 66               7      LD  H,(HL)
000D1A 4D1A 6F               4      LD  L,A
000D1B 4D1B E3              19      EX  (SP),HL
000D1C 4D1C 79               4      LD  A,C
000D1D 4D1D C9              10      RET
                                
       4D1E                     _PRINT:
       4D1E                     PRINT:
000D1E 4D1E 7B               4      LD  A,E
000D1F 4D1F 1803            12      JR  MSG_A
                                
       4D21                     _SYS01:     ;(BDOS)コンソール入力
000D21 4D21 CD984D          17      CALL    _SYS07
       4D24                     MSG_A:
000D24 4D24 FE03             7      CP  3
000D26 4D26 2814            12      JR  Z,MSG_BR
       4D28                     MSGA1:
000D28 4D28 F5              11      PUSH    AF
000D29 4D29 C5              11      PUSH    BC
000D2A 4D2A D5              11      PUSH    DE
000D2B 4D2B E5              11      PUSH    HL
000D2C 4D2C DDE5            15      PUSH    IX
000D2E 4D2E DD21A200        14      LD  IX,CHPUT
000D32 4D32 CDEC42          17      CALL    CALSLT_R
000D35 4D35 DDE1            14      POP IX
000D37 4D37 E1              10      POP HL
000D38 4D38 D1              10      POP DE
000D39 4D39 C1              10      POP BC
       4D3A                     MSGA2:
000D3A 4D3A F1              10      POP AF
000D3B 4D3B C9              10      RET
       4D3C                     MSG_BR:
000D3C 4D3C F5              11      PUSH    AF
000D3D 4D3D 3ADDF3          13      LD  A,(CSRX)
000D40 4D40 FE02             7      CP  2
000D42 4D42 38F6            12      JR  C,MSGA2
000D44 4D44 F1              10      POP AF
       4D45                     MSG_CR:
000D45 4D45 F5              11      PUSH    AF
000D46 4D46 3E0D             7      LD  A,00DH
000D48 4D48 CD284D          17      CALL    MSGA1
000D4B 4D4B 3E0A             7      LD  A,00AH
000D4D 4D4D CD284D          17      CALL    MSGA1
000D50 4D50 F1              10      POP AF
000D51 4D51 C9              10      RET
                                
       4D52                     _SYS02:     ;(BDOS)コンソール出力
000D52 4D52 CD6D4D          17      CALL    BREAK
000D55 4D55 1805            12      JR  PRINTX
                                
       4D57                     _SYS06:     ;(BDOS)コンソール直接入出力
000D57 4D57 7B               4      LD  A,E
000D58 4D58 3C               4      INC A
000D59 4D59 CAAC4D          10      JP  Z,_INKEY
       4D5C                     PRINTX:
000D5C 4D5C C31E4D          10      JP  _PRINT
                                
       4D5F                     _SYS08:     ;(BDOS)エコーなしコンソール入力
000D5F 4D5F CD984D          17      CALL    _SYS07
000D62 4D62 FE03             7      CP  3
000D64 4D64 CC6D4D          17      CALL    Z,_BREAK
000D67 4D67 FE13             7      CP  013H        ;CTRL+S
000D69 4D69 C0              11      RET NZ
       4D6A                     PAUSE:
000D6A 4D6A CD844D          17      CALL    KEYBC
                                
       4D6D                     _BREAK:
       4D6D                     BREAK:
000D6D 4D6D F5              11      PUSH    AF
000D6E 4D6E C5              11      PUSH    BC
000D6F 4D6F D5              11      PUSH    DE
000D70 4D70 E5              11      PUSH    HL
000D71 4D71 DDE5            15      PUSH    IX
000D73 4D73 DD21B700        14      LD  IX,BREAKX
000D77 4D77 CDEC42          17      CALL    CALSLT_R
000D7A 4D7A DDE1            14      POP IX
000D7C 4D7C E1              10      POP HL
000D7D 4D7D D1              10      POP DE
000D7E 4D7E C1              10      POP BC
000D7F 4D7F DC6D4D          17      CALL    C,_BREAK
000D82 4D82 F1              10      POP AF
000D83 4D83 C9              10      RET
       4D84                     KEYBC:
000D84 4D84 F5              11      PUSH    AF
000D85 4D85 C5              11      PUSH    BC
000D86 4D86 D5              11      PUSH    DE
000D87 4D87 E5              11      PUSH    HL
000D88 4D88 DDE5            15      PUSH    IX
000D8A 4D8A DD215601        14      LD  IX,KILBUF
000D8E 4D8E CDEC42          17      CALL    CALSLT_R
000D91 4D91 DDE1            14      POP IX
000D93 4D93 E1              10      POP HL
000D94 4D94 D1              10      POP DE
000D95 4D95 C1              10      POP BC
000D96 4D96 F1              10      POP AF
000D97 4D97 C9              10      RET
                                
       4D98                     _SYS07:
       4D98                     FLGET:
000D98 4D98 C5              11      PUSH    BC
000D99 4D99 D5              11      PUSH    DE
000D9A 4D9A E5              11      PUSH    HL
000D9B 4D9B DDE5            15      PUSH    IX
000D9D 4D9D DD219F00        14      LD  IX,CHGET
000DA1 4DA1 CDEC42          17      CALL    CALSLT_R
000DA4 4DA4 DDE1            14      POP IX
000DA6 4DA6 E1              10      POP HL
000DA7 4DA7 D1              10      POP DE
000DA8 4DA8 C1              10      POP BC
000DA9 4DA9 FE03             7      CP  3
000DAB 4DAB C9              10      RET
                                ;   RET NZ
                                ;   JP  CPM_BOOT
                                
       4DAC                     _INKEY:
       4DAC                     INKEY:
000DAC 4DAC CD464E          17      CALL    CPM_CONST
000DAF 4DAF C8              11      RET Z
000DB0 4DB0 18E6            12      JR  FLGET
                                
       4DB2                     _SYS0A:     ;(BDOS)文字列入力
000DB2 4DB2 C5              11      PUSH    BC
000DB3 4DB3 E5              11      PUSH    HL
000DB4 4DB4 D5              11      PUSH    DE
000DB5 4DB5 CDDE4D          17      CALL    GETL
000DB8 4DB8 111FF4          10      LD  DE,KBUF
000DBB 4DBB E1              10      POP HL
000DBC 4DBC E5              11      PUSH    HL
000DBD 4DBD 0E00             7      LD  C,0
000DBF 4DBF 3004            12      JR  NC,SAX0
000DC1 4DC1 23               6      INC HL
000DC2 4DC2 23               6      INC HL
000DC3 4DC3 1808            12      JR  SAX4
       4DC5                     SAX0:
000DC5 4DC5 46               7      LD  B,(HL)
000DC6 4DC6 23               6      INC HL
       4DC7                     SAX1:
000DC7 4DC7 23               6      INC HL
000DC8 4DC8 1A               7      LD  A,(DE)
000DC9 4DC9 13               6      INC DE
000DCA 4DCA B7               4      OR  A
000DCB 4DCB 2004            12      JR  NZ,SAX2
       4DCD                     SAX4:
000DCD 4DCD 360D            10      LD  (HL),00DH
000DCF 4DCF 1804            12      JR  SAX3
       4DD1                     SAX2:
000DD1 4DD1 77               7      LD  (HL),A
000DD2 4DD2 0C               4      INC C
000DD3 4DD3 10F2            13      DJNZ    SAX1
       4DD5                     SAX3:
000DD5 4DD5 D1              10      POP DE
000DD6 4DD6 79               4      LD  A,C
000DD7 4DD7 13               6      INC DE
000DD8 4DD8 12               7      LD  (DE),A
000DD9 4DD9 1B               6      DEC DE
000DDA 4DDA E1              10      POP HL
000DDB 4DDB C1              10      POP BC
000DDC 4DDC A7               4      AND A
000DDD 4DDD C9              10      RET
       4DDE                     GETL:
000DDE 4DDE DDE5            15      PUSH    IX
000DE0 4DE0 FDE5            15      PUSH    IY
                                
000DE2 4DE2 2ADCF3          16      LD  HL,(CSRY)
000DE5 4DE5 22CAFB          16      LD  (FSTPOS),HL
       4DE8                     GETL1:
000DE8 4DE8 CD5F4D          17      CALL    _SYS08
000DEB 4DEB FE09             7      CP  9
000DED 4DED 2008            12      JR  NZ,GETL1V
000DEF 4DEF 211FF4          10      LD  HL,KBUF
000DF2 4DF2 CD6743          17      CALL    MSX
000DF5 4DF5 18F1            12      JR  GETL1
       4DF7                     GETL1V:
000DF7 4DF7 5F               4      LD  E,A
000DF8 4DF8 FE08             7      CP  8
000DFA 4DFA CC944E          17      CALL    Z,CTRL02
000DFD 4DFD FE20             7      CP  020H
000DFF 4DFF D4C04E          17      CALL    NC,INSERT
000E02 4E02 CD284D          17      CALL    MSGA1
                                
000E05 4E05 7B               4      LD  A,E
000E06 4E06 FE0D             7      CP  00DH
000E08 4E08 20DE            12      JR  NZ,GETL1
                                
000E0A 4E0A 111FF4          10      LD  DE,KBUF
000E0D 4E0D 3AB0F3          13      LD  A,(LINLEN)
000E10 4E10 47               4      LD  B,A
000E11 4E11 CD7350          17      CALL    ZERO_MEMORY_DE
                                
000E14 4E14 2ACAFB          16      LD  HL,(FSTPOS)
000E17 4E17 3ADCF3          13      LD  A,(CSRY)
000E1A 4E1A 6F               4      LD  L,A
000E1B 4E1B E5              11      PUSH    HL
000E1C 4E1C CDF14E          17      CALL    LOC0
000E1F 4E1F 4D               4      LD  C,L
000E20 4E20 44               4      LD  B,H
000E21 4E21 E1              10      POP HL
000E22 4E22 3AB0F3          13      LD  A,(LINLEN)
000E25 4E25 94               4      SUB H
000E26 4E26 3D               4      DEC A
000E27 4E27 5F               4      LD  E,A
000E28 4E28 211FF4          10      LD  HL,KBUF
       4E2B                     GETL2:
000E2B 4E2B CD844E          17      CALL    _SCRN
000E2E 4E2E 03               6      INC BC
000E2F 4E2F 77               7      LD  (HL),A
000E30 4E30 23               6      INC HL
000E31 4E31 1D               4      DEC E
000E32 4E32 20F7            12      JR  NZ,GETL2
000E34 4E34 CD454D          17      CALL    MSG_CR
                                
000E37 4E37 FDE1            14      POP IY
000E39 4E39 DDE1            14      POP IX
       4E3B                     GETL3:
000E3B 4E3B 2B               6      DEC HL
000E3C 4E3C 7E               7      LD  A,(HL)
000E3D 4E3D FE21             7      CP  021H
000E3F 4E3F D0              11      RET NC
000E40 4E40 3600            10      LD  (HL),0
000E42 4E42 15               4      DEC D
000E43 4E43 20F6            12      JR  NZ,GETL3
000E45 4E45 C9              10      RET
                                
       4E46                     _SYS0B:     ;(BDOS)コンソール状態のチェック
       4E46                     CONSTX:
       4E46                     CPM_CONST:
000E46 4E46 C5              11      PUSH    BC
000E47 4E47 D5              11      PUSH    DE
000E48 4E48 E5              11      PUSH    HL
000E49 4E49 DDE5            15      PUSH    IX
000E4B 4E4B DD219C00        14      LD  IX,CHSNS
000E4F 4E4F CDEC42          17      CALL    CALSLT_R
000E52 4E52 DDE1            14      POP IX
000E54 4E54 E1              10      POP HL
000E55 4E55 D1              10      POP DE
000E56 4E56 C1              10      POP BC
000E57 4E57 C9              10      RET
                                
       4E58                     _SYS2A:     ;(BDOS)日付の獲得
000E58 4E58 AF               4      XOR A
000E59 4E59 57               4      LD  D,A
000E5A 4E5A 5F               4      LD  E,A
000E5B 4E5B 67               4      LD  H,A
000E5C 4E5C 6F               4      LD  L,A
000E5D 4E5D C9              10      RET
                                
       4E5E                     _SYS2C:     ;(BDOS)時刻の獲得
000E5E 4E5E AF               4      XOR A
000E5F 4E5F 57               4      LD  D,A
000E60 4E60 5F               4      LD  E,A
000E61 4E61 67               4      LD  H,A
000E62 4E62 6F               4      LD  L,A
000E63 4E63 C9              10      RET
                                
       4E64                     POS:
000E64 4E64 F5              11      PUSH    AF
000E65 4E65 2ADCF3          16      LD  HL,(CSRY)
000E68 4E68 7D               4      LD  A,L
000E69 4E69 6C               4      LD  L,H
000E6A 4E6A 67               4      LD  H,A
000E6B 4E6B 2C               4      INC L
000E6C 4E6C 24               4      INC H
000E6D 4E6D F1              10      POP AF
000E6E 4E6E C9              10      RET
                                
       4E6F                     LOC:
000E6F 4E6F F5              11      PUSH    AF
000E70 4E70 E5              11      PUSH    HL
000E71 4E71 7D               4      LD  A,L
000E72 4E72 6C               4      LD  L,H
000E73 4E73 67               4      LD  H,A
000E74 4E74 2D               4      DEC L
000E75 4E75 25               4      DEC H
000E76 4E76 DDE5            15      PUSH    IX
000E78 4E78 DD21C600        14      LD  IX,POSIT
000E7C 4E7C CDEC42          17      CALL    CALSLT_R
000E7F 4E7F DDE1            14      POP IX
000E81 4E81 E1              10      POP HL
000E82 4E82 F1              10      POP AF
000E83 4E83 C9              10      RET
                                
       4E84                     _SCRN:
       4E84                     SCRN:
000E84 4E84 E5              11      PUSH    HL
000E85 4E85 DDE5            15      PUSH    IX
                                
000E87 4E87 69               4      LD  L,C
000E88 4E88 60               4      LD  H,B
000E89 4E89 DD214A00        14      LD  IX,RDVRM
000E8D 4E8D CDEC42          17      CALL    CALSLT_R
                                
000E90 4E90 DDE1            14      POP IX
000E92 4E92 E1              10      POP HL
000E93 4E93 C9              10      RET
                                
       4E94                     CTRL02:
000E94 4E94 F5              11      PUSH    AF
000E95 4E95 D5              11      PUSH    DE
000E96 4E96 2ADCF3          16      LD  HL,(CSRY)
000E99 4E99 3AB0F3          13      LD  A,(LINLEN)
000E9C 4E9C 4F               4      LD  C,A
000E9D 4E9D 94               4      SUB H   ;CSRX
000E9E 4E9E C602             7      ADD A,2
000EA0 4EA0 47               4      LD  B,A ;カーソルより右の文字数
000EA1 4EA1 61               4      LD  H,C ;LINLEN
000EA2 4EA2 C5              11      PUSH    BC
000EA3 4EA3 CDF14E          17      CALL    LOC0
000EA6 4EA6 C1              10      POP BC
                                
000EA7 4EA7 1620             7      LD  D,020H
       4EA9                     C8X1:
000EA9 4EA9 DD214A00        14      LD  IX,RDVRM
000EAD 4EAD CDEC42          17      CALL    CALSLT_R
000EB0 4EB0 4F               4      LD  C,A
000EB1 4EB1 7A               4      LD  A,D
000EB2 4EB2 DD214D00        14      LD  IX,WRTVRM
000EB6 4EB6 CDEC42          17      CALL    CALSLT_R
000EB9 4EB9 2B               6      DEC HL
000EBA 4EBA 51               4      LD  D,C
000EBB 4EBB 10EC            13      DJNZ    C8X1
000EBD 4EBD D1              10      POP DE
000EBE 4EBE F1              10      POP AF
000EBF 4EBF C9              10      RET
                                
       4EC0                     INSERT:
000EC0 4EC0 F5              11      PUSH    AF
000EC1 4EC1 D5              11      PUSH    DE
000EC2 4EC2 2ADCF3          16      LD  HL,(CSRY)
000EC5 4EC5 3AB0F3          13      LD  A,(LINLEN)
000EC8 4EC8 4F               4      LD  C,A
000EC9 4EC9 94               4      SUB H   ;CSRX
000ECA 4ECA 3C               4      INC A
000ECB 4ECB 47               4      LD  B,A ;カーソルより右の文字数
000ECC 4ECC C5              11      PUSH    BC
000ECD 4ECD CDF14E          17      CALL    LOC0
000ED0 4ED0 C1              10      POP BC
                                
000ED1 4ED1 1620             7      LD  D,020H
       4ED3                     INS1:
000ED3 4ED3 DD214A00        14      LD  IX,RDVRM
000ED7 4ED7 CDEC42          17      CALL    CALSLT_R
000EDA 4EDA 4F               4      LD  C,A
000EDB 4EDB 7A               4      LD  A,D
000EDC 4EDC DD214D00        14      LD  IX,WRTVRM
000EE0 4EE0 CDEC42          17      CALL    CALSLT_R
000EE3 4EE3 23               6      INC HL
000EE4 4EE4 51               4      LD  D,C
000EE5 4EE5 10EC            13      DJNZ    INS1
000EE7 4EE7 D1              10      POP DE
000EE8 4EE8 F1              10      POP AF
000EE9 4EE9 C9              10      RET
                                
       4EEA                     CONOUT1:
000EEA 4EEA 59               4      LD  E,C
000EEB 4EEB C31E4D          10      JP  _PRINT
                                
       4EEE                     GETVRAM:
000EEE 4EEE 2ADCF3          16      LD  HL,(CSRY)
       4EF1                     LOC0:
000EF1 4EF1 2D               4      DEC L
000EF2 4EF2 25               4      DEC H
000EF3 4EF3 4C               4      LD  C,H ;CSRX-1
000EF4 4EF4 5D               4      LD  E,L ;CSRY-1
       4EF5                     LOC1:
000EF5 4EF5 3AB0F3          13      LD  A,(LINLEN)
000EF8 4EF8 67               4      LD  H,A
000EF9 4EF9 1600             7      LD  D,0
000EFB 4EFB 6A               4      LD  L,D ;0
000EFC 4EFC 0608             7      LD  B,8
       4EFE                     LOC2:
000EFE 4EFE 29              11      ADD HL,HL
000EFF 4EFF 3001            12      JR  NC,LOC3
000F01 4F01 19              11      ADD HL,DE
       4F02                     LOC3:
000F02 4F02 10FA            13      DJNZ    LOC2
000F04 4F04 09              11      ADD HL,BC
000F05 4F05 C9              10      RET
                                
       4F06                     _SYS0C:     ;(BDOS)バージョン番号の獲得
000F06 4F06 212200          10      LD  HL,00022H
000F09 4F09 AF               4      XOR A
000F0A 4F0A 7D               4      LD  A,L
000F0B 4F0B C9              10      RET
                                
       4F0C                     _SYS0D:     ;(BDOS)ディスク・リセット
000F0C 4F0C 218000          10      LD  HL,00080H
000F0F 4F0F 2226F1          16      LD  (_DTA),HL
000F12 4F12 C9              10      RET
                                
       4F13                     _SYS0E:     ;(BDOS)カレントドライブの設定
000F13 4F13 323AF1          13      LD  (_DVSW),A
000F16 4F16 C9              10      RET
                                
       4F17                     _SYS0F:     ;(BDOS)ファイルのオープン
000F17 4F17 D5              11      PUSH    DE
000F18 4F18 FDE1            14      POP IY
000F1A 4F1A CD6050          17      CALL    INIT_FILE
000F1D 4F1D CDA848          17      CALL    ROM_OPEN
000F20 4F20 3856            12      JR  C,SCF_FF_RET
                                ;               Open(Read)
000F22 4F22 FD361CFF        19      LD  (IY+28),0FFH
                                ;               FILENAME
000F26 4F26 FDE5            15      PUSH    IY
000F28 4F28 D1              10      POP DE
000F29 4F29 13               6      INC DE
000F2A 4F2A 010B00          10      LD  BC,11
000F2D 4F2D EDB0                    LDIR
                                ;               Attribute
000F2F 4F2F 7E               7      LD  A,(HL)
000F30 4F30 FD770D          19      LD  (IY+13),A
                                ;               TIME
000F33 4F33 110B00          10      LD  DE,11
000F36 4F36 19              11      ADD HL,DE
000F37 4F37 7E               7      LD  A,(HL)
000F38 4F38 23               6      INC HL
000F39 4F39 FD7716          19      LD  (IY+22),A
000F3C 4F3C 7E               7      LD  A,(HL)
000F3D 4F3D 23               6      INC HL
000F3E 4F3E FD7717          19      LD  (IY+23),A
                                ;               DATE
000F41 4F41 7E               7      LD  A,(HL)
000F42 4F42 23               6      INC HL
000F43 4F43 FD7714          19      LD  (IY+20),A
000F46 4F46 7E               7      LD  A,(HL)
000F47 4F47 23               6      INC HL
000F48 4F48 FD7715          19      LD  (IY+21),A
                                ;               First cluster
000F4B 4F4B 7E               7      LD  A,(HL)
000F4C 4F4C 23               6      INC HL
000F4D 4F4D FD771A          19      LD  (IY+26),A
000F50 4F50 7E               7      LD  A,(HL)
000F51 4F51 23               6      INC HL
000F52 4F52 FD771B          19      LD  (IY+27),A
                                ;               SIZE
000F55 4F55 7E               7      LD  A,(HL)
000F56 4F56 23               6      INC HL
000F57 4F57 FD7710          19      LD  (IY+16),A
000F5A 4F5A 7E               7      LD  A,(HL)
000F5B 4F5B 23               6      INC HL
000F5C 4F5C FD7711          19      LD  (IY+17),A
000F5F 4F5F 7E               7      LD  A,(HL)
000F60 4F60 23               6      INC HL
000F61 4F61 FD7712          19      LD  (IY+18),A
000F64 4F64 7E               7      LD  A,(HL)
000F65 4F65 FD7713          19      LD  (IY+19),A
000F68 4F68 AF               4      XOR A
000F69 4F69 FD770C          19      LD  (IY+12),A
000F6C 4F6C C9              10      RET
                                
       4F6D                     _SYS10:     ;(BDOS)ファイルのクローズ
000F6D 4F6D AF               4      XOR A
000F6E 4F6E C9              10      RET
                                
       4F6F                     S11X1:
000F6F 4F6F FD7119          19      LD  (IY+25),C       ;RootEntCnt
000F72 4F72 FD750E          19      LD  (IY+14),L
000F75 4F75 FD740F          19      LD  (IY+15),H
       4F78                     SCF_FF_RET:
000F78 4F78 37               4      SCF
000F79 4F79 9F               4      SBC A,A
000F7A 4F7A C9              10      RET
                                
       4F7B                     _SYS11:     ;(BDOS)最初のファイルの検索
000F7B 4F7B ED532EF1        20      LD  (_FCB),DE
000F7F 4F7F D5              11      PUSH    DE
000F80 4F80 FDE1            14      POP IY
000F82 4F82 CD6050          17      CALL    INIT_FILE
000F85 4F85 CDF04A          17      CALL    GET_DIR_DAT
       4F88                     S12X1:
000F88 4F88 CDC448          17      CALL    FILESE
000F8B 4F8B 30E2            12      JR  NC,S11X1
000F8D 4F8D 0D               4      DEC C
000F8E 4F8E FD7119          19      LD  (IY+25),C       ;RootEntCnt
000F91 4F91 012000          10      LD  BC,32
000F94 4F94 ED5B26F1        20      LD  DE,(_DTA)
000F98 4F98 AF               4      XOR A
000F99 4F99 12               7      LD  (DE),A      ;ドライブ番号
000F9A 4F9A 13               6      INC DE
000F9B 4F9B EDB0                    LDIR            ;ディレクトリエントリ
000F9D 4F9D FD750E          19      LD  (IY+14),L
000FA0 4FA0 FD740F          19      LD  (IY+15),H
000FA3 4FA3 C9              10      RET
                                
       4FA4                     _SYS12:
000FA4 4FA4 FD2A2EF1        20      LD  IY,(_FCB)
000FA8 4FA8 FDE5            15      PUSH    IY
000FAA 4FAA D1              10      POP DE
000FAB 4FAB CD6050          17      CALL    INIT_FILE
                                
000FAE 4FAE FD6E0E          19      LD  L,(IY+14)
000FB1 4FB1 FD660F          19      LD  H,(IY+15)
000FB4 4FB4 FD4E19          19      LD  C,(IY+25)
000FB7 4FB7 18CF            12      JR  S12X1
                                
       4FB9                     _SYS14:     ;(BDOS)シーケンシャルな読み出し
000FB9 4FB9 CDD64A          17      CALL    SET_FCB
000FBC 4FBC CDA44A          17      CALL    GETSEQ
000FBF 4FBF CD914A          17      CALL    RB_READ
000FC2 4FC2 E5              11      PUSH    HL
000FC3 4FC3 CDB14A          17      CALL    SETSEQ
000FC6 4FC6 E1              10      POP HL
       4FC7                     SREAD:
000FC7 4FC7 C601             7      ADD A,001H
000FC9 4FC9 D8              11      RET C
                                
000FCA 4FCA 7D               4      LD  A,L
000FCB 4FCB D601             7      SUB 001H
000FCD 4FCD 9F               4      SBC A,A
000FCE 4FCE E603             7      AND 3
000FD0 4FD0 1F               4      RRA
000FD1 4FD1 C9              10      RET
                                
       4FD2                     _SYS18:     ;(BDOS)ログインベクトルの獲得
000FD2 4FD2 210100          10      LD  HL,00001H
000FD5 4FD5 AF               4      XOR A
000FD6 4FD6 C9              10      RET
                                
       4FD7                     _SYS19:     ;(BDOS)カレントドライブ番号の獲得
000FD7 4FD7 3A3AF1          13      LD  A,(_DVSW)
000FDA 4FDA C9              10      RET
                                
       4FDB                     _SYS1A:     ;(BDOS)DTAの設定
000FDB 4FDB ED5326F1        20      LD  (_DTA),DE
000FDF 4FDF AF               4      XOR A
000FE0 4FE0 C9              10      RET
                                
       4FE1                     _SYS1B:     ;(BDOS)ディスク情報の獲得
000FE1 4FE1 010002          10      LD  BC,512
000FE4 4FE4 11C302          10      LD  DE,707
000FE7 4FE7 210000          10      LD  HL,0
000FEA 4FEA DD2130F1        14      LD  IX,_BUF
000FEE 4FEE FD2130F1        14      LD  IY,_BUF
000FF2 4FF2 FD3600F9        19      LD  (IY+0),0F9H
000FF6 4FF6 3E02             7      LD  A,2
000FF8 4FF8 C9              10      RET
                                
       4FF9                     _SYS21:     ;(BDOS)ランダムな読み出し
000FF9 4FF9 CDD64A          17      CALL    SET_FCB
                                
000FFC 4FFC FD6E21          19      LD  L,(IY+33)   ;(FCB)Random record
000FFF 4FFF FD6622          19      LD  H,(IY+34)
                                
001002 5002 CD914A          17      CALL    RB_READ
001005 5005 18C0            12      JR  SREAD
                                
       5007                     _SYS23:     ;(BDOS)ファイル・サイズの獲得
001007 5007 CD174F          17      CALL    _SYS0F
00100A 500A D8              11      RET C
                                
00100B 500B D5              11      PUSH    DE      ;EX DE,IY
00100C 500C FDE3            23      EX  (SP),IY     ;
                                ;   POP DE      ;
                                ;   PUSH    DE      ;DEを破壊しないように注意vv
00100E 500E CDC64A          17      CALL    GETSIZE
       5011                     _S24X1:
001011 5011 FD7521          19      LD  (IY+33),L   ;(FCB)Random record
001014 5014 FD7422          19      LD  (IY+34),H
001017 5017 FD362300        19      LD  (IY+35),0
                                ;   POP DE      ;^^^^^^^^^^^^^^^^^^^^^^^^
                                ;   PUSH    DE      ;EX DE,IY
00101B 501B FDE3            23      EX  (SP),IY     ;
00101D 501D D1              10      POP DE      ;
                                
00101E 501E AF               4      XOR A
00101F 501F C9              10      RET
                                
       5020                     _SYS24:     ;(BDOS)ランダム・レコード・フィールドの設定
001020 5020 E5              11      PUSH    HL
001021 5021 D5              11      PUSH    DE      ;EX DE,IY
001022 5022 FDE3            23      EX  (SP),IY     ;
                                ;   POP DE      ;
                                ;   PUSH    DE      ;DEを破壊しないように注意vv
001024 5024 CDA44A          17      CALL    GETSEQ
001027 5027 18E8            12      JR  _S24X1      ;^^^^^^^^^^^^^^^^^^^^^^^^
                                
       5029                     _SYS27:     ;(BDOS)ランダムブロック読み込み
001029 5029 CDD64A          17      CALL    SET_FCB
00102C 502C E5              11      PUSH    HL
00102D 502D FD6E21          19      LD  L,(IY+33)
001030 5030 FD6622          19      LD  H,(IY+34)
001033 5033 221CF1          16      LD  (RR_LOW),HL
001036 5036 FD6E23          19      LD  L,(IY+35)
001039 5039 FD6624          19      LD  H,(IY+36)
00103C 503C 221EF1          16      LD  (RR_HIGH),HL
00103F 503F E1              10      POP HL
001040 5040 CDC846          17      CALL    ROM_READ
001043 5043 ED5B1CF1        20      LD  DE,(RR_LOW)
001047 5047 FD7321          19      LD  (IY+33),E
00104A 504A FD7222          19      LD  (IY+34),D
00104D 504D ED5B1EF1        20      LD  DE,(RR_HIGH)
001051 5051 FD7323          19      LD  (IY+35),E
001054 5054 FD7224          19      LD  (IY+36),D
001057 5057 9F               4      SBC A,A
001058 5058 C9              10      RET
                                
       5059                     _SYS2F:
001059 5059 44               4      LD  B,H
00105A 505A 2A26F1          16      LD  HL,(_DTA)
00105D 505D C3324B          10      JP  DISKIO
                                
       5060                     INIT_FILE:
001060 5060 EB               4      EX  DE,HL
001061 5061 1143F1          10      LD  DE,FDRV
001064 5064 010C00          10      LD  BC,1+8+3
001067 5067 EDB0                    LDIR
001069 5069 CDC74C          17      CALL    GET_DISK_BANK_FDRV
00106C 506C 320068          13      LD  (BANK1_SEL),A           ;ASCII-8K/Konami-8K
00106F 506F 320070          13      LD  (KONAMI_SCC_BANK1_SEL),A    ;Konami-8K/Konami-SCC
001072 5072 C9              10      RET
                                
       5073                     ZERO_MEMORY_DE:
001073 5073 AF               4      XOR A
       5074                     FILL_MEMORY_DE:
001074 5074 12               7      LD  (DE),A
001075 5075 13               6      INC DE
001076 5076 10FC            13      DJNZ    FILL_MEMORY_DE
001078 5078 C9              10      RET
                                
001079 5079                         DS  05F00H-$
       5F00                     STABLE:
                                ;0
001F00 5F00 0B4D214D524D0B4D        DW  _ERROR,_SYS01,_SYS02,_ERROR
001F08 5F08 0B4D0B4D574D984D        DW  _ERROR,_ERROR,_SYS06,_SYS07
001F10 5F10 5F4D0B4DB24D464E        DW  _SYS08,_ERROR,_SYS0A,_SYS0B
001F18 5F18 064F0C4F134F174F        DW  _SYS0C,_SYS0D,_SYS0E,_SYS0F
                                ;1
001F20 5F20 6D4F7B4FA44F0B4D        DW  _SYS10,_SYS11,_SYS12,_ERROR
001F28 5F28 B94F0B4D0B4D0B4D        DW  _SYS14,_ERROR,_ERROR,_ERROR
001F30 5F30 D24FD74FDB4FE14F        DW  _SYS18,_SYS19,_SYS1A,_SYS1B
001F38 5F38 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;2
001F40 5F40 0B4D0B4D0B4D0750        DW  _ERROR,_ERROR,_ERROR,_SYS23
001F48 5F48 20500B4D0B4D2950        DW  _SYS24,_ERROR,_ERROR,_SYS27
001F50 5F50 0B4D0B4D584E0B4D        DW  _ERROR,_ERROR,_SYS2A,_ERROR
001F58 5F58 5E4E0B4D0B4D5950        DW  _SYS2C,_ERROR,_ERROR,_SYS2F
                                ;3
001F60 5F60 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F68 5F68 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F70 5F70 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F78 5F78 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;4
001F80 5F80 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F88 5F88 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F90 5F90 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001F98 5F98 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;5
001FA0 5FA0 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FA8 5FA8 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FB0 5FB0 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FB8 5FB8 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;6
001FC0 5FC0 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FC8 5FC8 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FD0 5FD0 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FD8 5FD8 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                ;7
001FE0 5FE0 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FE8 5FE8 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FF0 5FF0 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
001FF8 5FF8 0B4D0B4D0B4D0B4D        DW  _ERROR,_ERROR,_ERROR,_ERROR
                                
[EOF:BDOS.ASM:UTF_8]
       6000                     LAST_ADR:
                                
                                    END
[EOF:DISKROM.ASM:UTF_8]
